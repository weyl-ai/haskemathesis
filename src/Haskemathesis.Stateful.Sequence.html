<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | Operation sequence generation for stateful API testing.

This module generates valid sequences of API operations that can be
executed together, with proper data flow between operations. It uses
operation links to determine which operations can follow others.

=== Key Concepts

* __Sequence Generation__: Create ordered lists of operations where
  each operation can use data from previous operations' responses
* __CRUD Sequences__: Common patterns like Create&#8594;Read&#8594;Update&#8594;Delete
* __Cleanup Steps__: Operations to run after the main test, even on failure

=== Example

@
import Haskemathesis.Stateful.Sequence
import Haskemathesis.Stateful.Heuristics (inferLinks)

-- Generate a random valid sequence
let ops = resolveOperations spec
    links = inferLinks ops
sequence &lt;- Gen.sample $ genOperationSequence 5 ops links
-- sequence might be: POST /users -&gt; GET /users/{id} -&gt; DELETE /users/{id}
@
-}</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html"><span class="hs-identifier">Haskemathesis.Stateful.Sequence</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Sequence Generation</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#genOperationSequence"><span class="hs-identifier">genOperationSequence</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#genCrudSequence"><span class="hs-identifier">genCrudSequence</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Sequence Building</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#buildSequenceFromLinks"><span class="hs-identifier">buildSequenceFromLinks</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#findLinksFrom"><span class="hs-identifier">findLinksFrom</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#findOperationByLabel"><span class="hs-identifier">findOperationByLabel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Step Creation</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#createStepFromLink"><span class="hs-identifier">createStepFromLink</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#createInitialStep"><span class="hs-identifier">createInitialStep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Cleanup</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#findCleanupOperations"><span class="hs-identifier">findCleanupOperations</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#createCleanupSteps"><span class="hs-identifier">createCleanupSteps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#canStartSequence"><span class="hs-identifier">canStartSequence</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#getCreatorOperations"><span class="hs-identifier">getCreatorOperations</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#getResourceOperations"><span class="hs-identifier">getResourceOperations</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier">Gen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Gen.html"><span class="hs-identifier">Hedgehog.Gen</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gen</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Range.html"><span class="hs-identifier">Hedgehog.Range</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Range</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html"><span class="hs-identifier">Haskemathesis.OpenApi.Types</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ParamLocation"><span class="hs-identifier">ParamLocation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier">ResolvedOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedParam"><span class="hs-identifier">ResolvedParam</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html"><span class="hs-identifier">Haskemathesis.Stateful.Types</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier">OperationLink</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationSequence"><span class="hs-identifier">OperationSequence</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#ParameterBinding"><span class="hs-identifier">ParameterBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier">SequenceStep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#ValueSource"><span class="hs-identifier">ValueSource</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><span class="hs-comment">{- | Generate a random valid operation sequence.

This generator creates sequences where:

1. The first operation is a &quot;creator&quot; (typically POST) or has no required bindings
2. Subsequent operations are linked from previous ones
3. Each step includes proper parameter bindings

=== Parameters

* @maxLength@ - Maximum number of steps in the sequence
* @ops@ - Available operations
* @links@ - Known links between operations

=== Return Value

Returns a 'Gen OperationSequence' that generates valid sequences.

=== Example

@
sequence &lt;- Gen.sample $ genOperationSequence 5 ops links
-- Might generate: POST /users -&gt; GET /users/{id} -&gt; PUT /users/{id}
@
-}</span></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#genOperationSequence"><span class="hs-identifier hs-type">genOperationSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationSequence"><span class="hs-identifier hs-type">OperationSequence</span></a></span><span>
</span><span id="line-104"></span><span id="genOperationSequence"><span class="annot"><span class="annottext">genOperationSequence :: Int
-&gt; [ResolvedOperation] -&gt; [OperationLink] -&gt; Gen OperationSequence
</span><a href="Haskemathesis.Stateful.Sequence.html#genOperationSequence"><span class="hs-identifier hs-var hs-var">genOperationSequence</span></a></span></span><span> </span><span id="local-6989586621679241089"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679241089"><span class="hs-identifier hs-var">maxLength</span></a></span></span><span> </span><span id="local-6989586621679241090"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241090"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679241091"><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241091"><span class="hs-identifier hs-var">links</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- Start with a creator operation or one with no required params</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241092"><span class="annot"><span class="annottext">starters :: [ResolvedOperation]
</span><a href="#local-6989586621679241092"><span class="hs-identifier hs-var hs-var">starters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; [OperationLink] -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#canStartSequence"><span class="hs-identifier hs-var">canStartSequence</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241090"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241091"><span class="hs-identifier hs-var">links</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241090"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241092"><span class="hs-identifier hs-var">starters</span></a></span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">OperationSequence -&gt; Gen OperationSequence
forall a. a -&gt; GenT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OperationSequence
</span><a href="Haskemathesis.Stateful.Sequence.html#emptySequence"><span class="hs-identifier hs-var">emptySequence</span></a></span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>            </span><span id="local-6989586621679241095"><span class="annot"><a href="#local-6989586621679241095"><span class="hs-identifier hs-var">startOp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; GenT Identity ResolvedOperation
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, MonadGen m) =&gt;
f a -&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#element"><span class="hs-identifier hs-var">Gen.element</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241092"><span class="hs-identifier hs-var">starters</span></a></span><span>
</span><span id="line-111"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241097"><span class="annot"><a href="#local-6989586621679241097"><span class="hs-identifier hs-var hs-var">startStep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; SequenceStep
</span><a href="Haskemathesis.Stateful.Sequence.html#createInitialStep"><span class="hs-identifier hs-var">createInitialStep</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241095"><span class="hs-identifier hs-var">startOp</span></a></span><span>
</span><span id="line-112"></span><span>                </span><span id="local-6989586621679241098"><span class="annot"><a href="#local-6989586621679241098"><span class="hs-identifier hs-var hs-var">startLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Stateful.Sequence.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241095"><span class="hs-identifier hs-var">startOp</span></a></span><span>
</span><span id="line-113"></span><span>            </span><span class="hs-comment">-- Build out the sequence by following links</span><span>
</span><span id="line-114"></span><span>            </span><span id="local-6989586621679241100"><span class="annot"><a href="#local-6989586621679241100"><span class="hs-identifier hs-var">numAdditional</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#int"><span class="hs-identifier hs-type">Gen.int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Range.html#linear"><span class="hs-identifier hs-type">Range.linear</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679241089"><span class="hs-identifier hs-type">maxLength</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>            </span><span id="local-6989586621679241103"><span class="annot"><a href="#local-6989586621679241103"><span class="hs-identifier hs-var">additionalSteps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#buildSequenceFromLinks"><span class="hs-identifier hs-type">buildSequenceFromLinks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679241100"><span class="hs-identifier hs-type">numAdditional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679241098"><span class="hs-identifier hs-type">startLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679241090"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679241091"><span class="hs-identifier hs-type">links</span></a></span><span>
</span><span id="line-116"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241104"><span class="annot"><a href="#local-6989586621679241104"><span class="hs-identifier hs-var hs-var">allSteps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241097"><span class="hs-identifier hs-var">startStep</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep -&gt; [SequenceStep] -&gt; [SequenceStep]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241103"><span class="hs-identifier hs-var">additionalSteps</span></a></span><span>
</span><span id="line-117"></span><span>                </span><span id="local-6989586621679241105"><span class="annot"><a href="#local-6989586621679241105"><span class="hs-identifier hs-var hs-var">cleanup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
-&gt; [OperationLink] -&gt; [SequenceStep] -&gt; [SequenceStep]
</span><a href="Haskemathesis.Stateful.Sequence.html#createCleanupSteps"><span class="hs-identifier hs-var">createCleanupSteps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241090"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241091"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241104"><span class="hs-identifier hs-var">allSteps</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-119"></span><span>                </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationSequence"><span class="hs-identifier hs-type">OperationSequence</span></a></span><span>
</span><span id="line-120"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#osSteps"><span class="hs-identifier hs-var">osSteps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679241104"><span class="hs-identifier hs-type">allSteps</span></a></span><span>
</span><span id="line-121"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#osCleanup"><span class="hs-identifier hs-var">osCleanup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679241105"><span class="hs-identifier hs-type">cleanup</span></a></span><span>
</span><span id="line-122"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><span class="hs-comment">{- | Generate a CRUD sequence for a resource.

Creates a sequence that exercises the full lifecycle:
Create &#8594; Read &#8594; Update &#8594; Delete

=== Parameters

* @createOp@ - The POST operation that creates the resource
* @ops@ - All available operations (to find related GET/PUT/DELETE)

=== Return Value

Returns a 'Gen OperationSequence' with CRUD operations.

=== Example

@
let createOp = findOperation &quot;POST&quot; &quot;/users&quot; ops
sequence &lt;- Gen.sample $ genCrudSequence createOp ops
-- Generates: POST /users -&gt; GET /users/{id} -&gt; PUT /users/{id} -&gt; DELETE /users/{id}
@
-}</span></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#genCrudSequence"><span class="hs-identifier hs-type">genCrudSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationSequence"><span class="hs-identifier hs-type">OperationSequence</span></a></span><span>
</span><span id="line-150"></span><span id="genCrudSequence"><span class="annot"><span class="annottext">genCrudSequence :: ResolvedOperation -&gt; [ResolvedOperation] -&gt; Gen OperationSequence
</span><a href="Haskemathesis.Stateful.Sequence.html#genCrudSequence"><span class="hs-identifier hs-var hs-var">genCrudSequence</span></a></span></span><span> </span><span id="local-6989586621679241109"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241109"><span class="hs-identifier hs-var">createOp</span></a></span></span><span> </span><span id="local-6989586621679241110"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241110"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241111"><span class="annot"><span class="annottext">createLabel :: Text
</span><a href="#local-6989586621679241111"><span class="hs-identifier hs-var hs-var hs-var">createLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Stateful.Sequence.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241109"><span class="hs-identifier hs-var">createOp</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span id="local-6989586621679241112"><span class="annot"><span class="annottext">createPath :: Text
</span><a href="#local-6989586621679241112"><span class="hs-identifier hs-var hs-var hs-var">createPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roPath"><span class="hs-identifier hs-var">roPath</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241109"><span class="hs-identifier hs-var">createOp</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-comment">-- Find related operations on the resource path</span><span>
</span><span id="line-154"></span><span>        </span><span id="local-6989586621679241114"><span class="annot"><span class="annottext">relatedOps :: [ResolvedOperation]
</span><a href="#local-6989586621679241114"><span class="hs-identifier hs-var hs-var hs-var">relatedOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.Stateful.Sequence.html#getResourceOperations"><span class="hs-identifier hs-var">getResourceOperations</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241112"><span class="hs-identifier hs-var">createPath</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241110"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span id="local-6989586621679241117"><span class="annot"><span class="annottext">getOps :: [ResolvedOperation]
</span><a href="#local-6989586621679241117"><span class="hs-identifier hs-var hs-var hs-var">getOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;GET&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool)
-&gt; (ResolvedOperation -&gt; Text) -&gt; ResolvedOperation -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241114"><span class="hs-identifier hs-var">relatedOps</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span id="local-6989586621679241122"><span class="annot"><span class="annottext">putOps :: [ResolvedOperation]
</span><a href="#local-6989586621679241122"><span class="hs-identifier hs-var hs-var hs-var">putOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;PUT&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool)
-&gt; (ResolvedOperation -&gt; Text) -&gt; ResolvedOperation -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241114"><span class="hs-identifier hs-var">relatedOps</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621679241125"><span class="annot"><span class="annottext">patchOps :: [ResolvedOperation]
</span><a href="#local-6989586621679241125"><span class="hs-identifier hs-var hs-var hs-var">patchOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;PATCH&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool)
-&gt; (ResolvedOperation -&gt; Text) -&gt; ResolvedOperation -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241114"><span class="hs-identifier hs-var">relatedOps</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span id="local-6989586621679241128"><span class="annot"><span class="annottext">deleteOps :: [ResolvedOperation]
</span><a href="#local-6989586621679241128"><span class="hs-identifier hs-var hs-var hs-var">deleteOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;DELETE&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool)
-&gt; (ResolvedOperation -&gt; Text) -&gt; ResolvedOperation -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241114"><span class="hs-identifier hs-var">relatedOps</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- Build the sequence</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241129"><span class="annot"><span class="annottext">createStep :: SequenceStep
</span><a href="#local-6989586621679241129"><span class="hs-identifier hs-var hs-var hs-var">createStep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; SequenceStep
</span><a href="Haskemathesis.Stateful.Sequence.html#createInitialStep"><span class="hs-identifier hs-var">createInitialStep</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241109"><span class="hs-identifier hs-var">createOp</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- Add a GET step if available</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679241130"><span class="annot"><a href="#local-6989586621679241130"><span class="hs-identifier hs-var">getSteps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241117"><span class="hs-identifier hs-var">getOps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679241131"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241131"><span class="hs-identifier hs-var">getOp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SequenceStep] -&gt; Gen [SequenceStep]
forall a. a -&gt; GenT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; ResolvedOperation -&gt; SequenceStep
</span><a href="Haskemathesis.Stateful.Sequence.html#createResourceStep"><span class="hs-identifier hs-var">createResourceStep</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241111"><span class="hs-identifier hs-var">createLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241131"><span class="hs-identifier hs-var">getOp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SequenceStep] -&gt; Gen [SequenceStep]
forall a. a -&gt; GenT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-comment">-- Optionally add PUT or PATCH</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679241133"><span class="annot"><a href="#local-6989586621679241133"><span class="hs-identifier hs-var">updateSteps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621679241122"><span class="hs-identifier hs-type">putOps</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621679241125"><span class="hs-identifier hs-type">patchOps</span></a></span><span>
</span><span id="line-171"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>                </span><span class="hs-comment">-- Choose PUT or PATCH randomly if both available</span><span>
</span><span id="line-174"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241135"><span class="annot"><a href="#local-6989586621679241135"><span class="hs-identifier hs-var hs-var">updateOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241122"><span class="hs-identifier hs-var">putOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241125"><span class="hs-identifier hs-var">patchOps</span></a></span><span>
</span><span id="line-175"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621679241135"><span class="hs-identifier hs-type">updateOps</span></a></span><span>
</span><span id="line-176"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>                        </span><span id="local-6989586621679241136"><span class="annot"><a href="#local-6989586621679241136"><span class="hs-identifier hs-var">updateOp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#element"><span class="hs-identifier hs-type">Gen.element</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679241135"><span class="hs-identifier hs-type">updateOps</span></a></span><span>
</span><span id="line-179"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#createResourceStep"><span class="hs-identifier hs-type">createResourceStep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679241111"><span class="hs-identifier hs-type">createLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679241136"><span class="hs-identifier hs-type">updateOp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-comment">-- Add DELETE for cleanup (in main steps, not cleanup)</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679241137"><span class="annot"><a href="#local-6989586621679241137"><span class="hs-identifier hs-var">deleteSteps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679241128"><span class="hs-identifier hs-type">deleteOps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679241138"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241138"><span class="hs-identifier hs-var">deleteOp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SequenceStep] -&gt; Gen [SequenceStep]
forall a. a -&gt; GenT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; ResolvedOperation -&gt; SequenceStep
</span><a href="Haskemathesis.Stateful.Sequence.html#createResourceStep"><span class="hs-identifier hs-var">createResourceStep</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241111"><span class="hs-identifier hs-var">createLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241138"><span class="hs-identifier hs-var">deleteOp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SequenceStep] -&gt; Gen [SequenceStep]
forall a. a -&gt; GenT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241139"><span class="annot"><a href="#local-6989586621679241139"><span class="hs-identifier hs-var hs-var">allSteps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241129"><span class="hs-identifier hs-var">createStep</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep -&gt; [SequenceStep] -&gt; [SequenceStep]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241130"><span class="hs-identifier hs-var">getSteps</span></a></span><span> </span><span class="annot"><span class="annottext">[SequenceStep] -&gt; [SequenceStep] -&gt; [SequenceStep]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241133"><span class="hs-identifier hs-var">updateSteps</span></a></span><span> </span><span class="annot"><span class="annottext">[SequenceStep] -&gt; [SequenceStep] -&gt; [SequenceStep]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241137"><span class="hs-identifier hs-var">deleteSteps</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationSequence"><span class="hs-identifier hs-type">OperationSequence</span></a></span><span>
</span><span id="line-190"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#osSteps"><span class="hs-identifier hs-var">osSteps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679241139"><span class="hs-identifier hs-type">allSteps</span></a></span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#osCleanup"><span class="hs-identifier hs-var">osCleanup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- DELETE is already in steps</span><span>
</span><span id="line-192"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><span class="hs-comment">{- | Build additional steps by following links from a starting operation.

Recursively follows links to build a sequence of operations.
-}</span></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#buildSequenceFromLinks"><span class="hs-identifier hs-type">buildSequenceFromLinks</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span id="buildSequenceFromLinks"><span class="annot"><span class="annottext">buildSequenceFromLinks :: Int
-&gt; Text
-&gt; [ResolvedOperation]
-&gt; [OperationLink]
-&gt; Gen [SequenceStep]
</span><a href="Haskemathesis.Stateful.Sequence.html#buildSequenceFromLinks"><span class="hs-identifier hs-var hs-var">buildSequenceFromLinks</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SequenceStep] -&gt; Gen [SequenceStep]
forall a. a -&gt; GenT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#buildSequenceFromLinks"><span class="hs-identifier hs-var">buildSequenceFromLinks</span></a></span><span> </span><span id="local-6989586621679241140"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679241140"><span class="hs-identifier hs-var">remaining</span></a></span></span><span> </span><span id="local-6989586621679241141"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241141"><span class="hs-identifier hs-var">currentLabel</span></a></span></span><span> </span><span id="local-6989586621679241142"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241142"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679241143"><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241143"><span class="hs-identifier hs-var">links</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241144"><span class="annot"><span class="annottext">availableLinks :: [OperationLink]
</span><a href="#local-6989586621679241144"><span class="hs-identifier hs-var hs-var">availableLinks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [OperationLink] -&gt; [OperationLink]
</span><a href="Haskemathesis.Stateful.Sequence.html#findLinksFrom"><span class="hs-identifier hs-var">findLinksFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241141"><span class="hs-identifier hs-var">currentLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241143"><span class="hs-identifier hs-var">links</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[OperationLink] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241144"><span class="hs-identifier hs-var">availableLinks</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[SequenceStep] -&gt; Gen [SequenceStep]
forall a. a -&gt; GenT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>            </span><span class="hs-comment">-- Pick a random link to follow</span><span>
</span><span id="line-211"></span><span>            </span><span id="local-6989586621679241145"><span class="annot"><a href="#local-6989586621679241145"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[OperationLink] -&gt; GenT Identity OperationLink
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, MonadGen m) =&gt;
f a -&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#element"><span class="hs-identifier hs-var">Gen.element</span></a></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241144"><span class="hs-identifier hs-var">availableLinks</span></a></span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241146"><span class="annot"><a href="#local-6989586621679241146"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OperationLink -&gt; SequenceStep
</span><a href="Haskemathesis.Stateful.Sequence.html#createStepFromLink"><span class="hs-identifier hs-var">createStepFromLink</span></a></span><span> </span><span class="annot"><span class="annottext">OperationLink
</span><a href="#local-6989586621679241145"><span class="hs-identifier hs-var">link</span></a></span><span>
</span><span id="line-213"></span><span>                </span><span id="local-6989586621679241147"><span class="annot"><a href="#local-6989586621679241147"><span class="hs-identifier hs-var hs-var">nextLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OperationLink -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#olTargetOperation"><span class="hs-identifier hs-var">olTargetOperation</span></a></span><span> </span><span class="annot"><span class="annottext">OperationLink
</span><a href="#local-6989586621679241145"><span class="hs-identifier hs-var">link</span></a></span><span>
</span><span id="line-214"></span><span>            </span><span class="hs-comment">-- Continue building</span><span>
</span><span id="line-215"></span><span>            </span><span id="local-6989586621679241149"><span class="annot"><a href="#local-6989586621679241149"><span class="hs-identifier hs-var">moreSteps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#buildSequenceFromLinks"><span class="hs-identifier hs-type">buildSequenceFromLinks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679241140"><span class="hs-identifier hs-type">remaining</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679241147"><span class="hs-identifier hs-type">nextLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679241142"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679241143"><span class="hs-identifier hs-type">links</span></a></span><span>
</span><span id="line-216"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679241146"><span class="hs-identifier hs-type">step</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679241149"><span class="hs-identifier hs-type">moreSteps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><span class="hs-comment">-- | Find all links that start from a given operation.</span></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#findLinksFrom"><span class="hs-identifier hs-type">findLinksFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span id="findLinksFrom"><span class="annot"><span class="annottext">findLinksFrom :: Text -&gt; [OperationLink] -&gt; [OperationLink]
</span><a href="Haskemathesis.Stateful.Sequence.html#findLinksFrom"><span class="hs-identifier hs-var hs-var">findLinksFrom</span></a></span></span><span> </span><span id="local-6989586621679241150"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241150"><span class="hs-identifier hs-var">opLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(OperationLink -&gt; Bool) -&gt; [OperationLink] -&gt; [OperationLink]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241150"><span class="hs-identifier hs-var">opLabel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; (OperationLink -&gt; Text) -&gt; OperationLink -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OperationLink -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#olSourceOperation"><span class="hs-identifier hs-var">olSourceOperation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><span class="hs-comment">-- | Find an operation by its label (operationId or &quot;METHOD path&quot;).</span></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#findOperationByLabel"><span class="hs-identifier hs-type">findOperationByLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span>
</span><span id="line-224"></span><span id="findOperationByLabel"><span class="annot"><span class="annottext">findOperationByLabel :: Text -&gt; [ResolvedOperation] -&gt; Maybe ResolvedOperation
</span><a href="Haskemathesis.Stateful.Sequence.html#findOperationByLabel"><span class="hs-identifier hs-var hs-var">findOperationByLabel</span></a></span></span><span> </span><span id="local-6989586621679241152"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241152"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; Maybe ResolvedOperation
</span><a href="#local-6989586621679241153"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679241153"><span class="annot"><span class="annottext">go :: [ResolvedOperation] -&gt; Maybe ResolvedOperation
</span><a href="#local-6989586621679241153"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ResolvedOperation
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="#local-6989586621679241153"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679241155"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241155"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679241156"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241156"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Stateful.Sequence.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241155"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241152"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Maybe ResolvedOperation
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241155"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; Maybe ResolvedOperation
</span><a href="#local-6989586621679241153"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241156"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><span class="hs-comment">{- | Create a sequence step from an operation link.

Converts the link's parameter bindings to the step format.
-}</span></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#createStepFromLink"><span class="hs-identifier hs-type">createStepFromLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span>
</span><span id="line-236"></span><span id="createStepFromLink"><span class="annot"><span class="annottext">createStepFromLink :: OperationLink -&gt; SequenceStep
</span><a href="Haskemathesis.Stateful.Sequence.html#createStepFromLink"><span class="hs-identifier hs-var hs-var">createStepFromLink</span></a></span></span><span> </span><span id="local-6989586621679241157"><span class="annot"><span class="annottext">OperationLink
</span><a href="#local-6989586621679241157"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ssOperationId :: Text
</span><a href="Haskemathesis.Stateful.Types.html#ssOperationId"><span class="hs-identifier hs-var">ssOperationId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OperationLink -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#olTargetOperation"><span class="hs-identifier hs-var">olTargetOperation</span></a></span><span> </span><span class="annot"><span class="annottext">OperationLink
</span><a href="#local-6989586621679241157"><span class="hs-identifier hs-var">link</span></a></span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ssParamBindings :: Map Text ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#ssParamBindings"><span class="hs-identifier hs-var">ssParamBindings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Text ValueSource
</span><a href="#local-6989586621679241161"><span class="hs-identifier hs-var">bindingsMap</span></a></span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679241161"><span class="annot"><span class="annottext">bindingsMap :: Map Text ValueSource
</span><a href="#local-6989586621679241161"><span class="hs-identifier hs-var hs-var">bindingsMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="annottext">[(Text, ValueSource)] -&gt; Map Text ValueSource
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-244"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParameterBinding -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#pbTargetParam"><span class="hs-identifier hs-var">pbTargetParam</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterBinding
</span><a href="#local-6989586621679241166"><span class="hs-identifier hs-var">pb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ParameterBinding -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#pbSource"><span class="hs-identifier hs-var">pbSource</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterBinding
</span><a href="#local-6989586621679241166"><span class="hs-identifier hs-var">pb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679241166"><span class="annot"><span class="annottext">ParameterBinding
</span><a href="#local-6989586621679241166"><span class="hs-identifier hs-var">pb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OperationLink -&gt; [ParameterBinding]
</span><a href="Haskemathesis.Stateful.Types.html#olParameterBindings"><span class="hs-identifier hs-var">olParameterBindings</span></a></span><span> </span><span class="annot"><span class="annottext">OperationLink
</span><a href="#local-6989586621679241157"><span class="hs-identifier hs-var">link</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><span class="hs-comment">-- | Create an initial step (no bindings, all params generated randomly).</span></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#createInitialStep"><span class="hs-identifier hs-type">createInitialStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span>
</span><span id="line-248"></span><span id="createInitialStep"><span class="annot"><span class="annottext">createInitialStep :: ResolvedOperation -&gt; SequenceStep
</span><a href="Haskemathesis.Stateful.Sequence.html#createInitialStep"><span class="hs-identifier hs-var hs-var">createInitialStep</span></a></span></span><span> </span><span id="local-6989586621679241169"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241169"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span>
</span><span id="line-250"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ssOperationId :: Text
</span><a href="Haskemathesis.Stateful.Types.html#ssOperationId"><span class="hs-identifier hs-var">ssOperationId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Stateful.Sequence.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241169"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-251"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ssParamBindings :: Map Text ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#ssParamBindings"><span class="hs-identifier hs-var">ssParamBindings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Text ValueSource
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-252"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><span class="hs-comment">-- | Create a step that uses extracted values from a previous create operation.</span></span><span>
</span><span id="line-255"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#createResourceStep"><span class="hs-identifier hs-type">createResourceStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span>
</span><span id="line-256"></span><span id="createResourceStep"><span class="annot"><span class="annottext">createResourceStep :: Text -&gt; ResolvedOperation -&gt; SequenceStep
</span><a href="Haskemathesis.Stateful.Sequence.html#createResourceStep"><span class="hs-identifier hs-var hs-var">createResourceStep</span></a></span></span><span> </span><span id="local-6989586621679241171"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241171"><span class="hs-identifier hs-var">_sourceLabel</span></a></span></span><span> </span><span id="local-6989586621679241172"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241172"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span>
</span><span id="line-258"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ssOperationId :: Text
</span><a href="Haskemathesis.Stateful.Types.html#ssOperationId"><span class="hs-identifier hs-var">ssOperationId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Stateful.Sequence.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241172"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-259"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ssParamBindings :: Map Text ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#ssParamBindings"><span class="hs-identifier hs-var">ssParamBindings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Text ValueSource
</span><a href="#local-6989586621679241173"><span class="hs-identifier hs-var">pathParamBindings</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-comment">-- Bind all path params from state (assuming they were extracted)</span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621679241173"><span class="annot"><span class="annottext">pathParamBindings :: Map Text ValueSource
</span><a href="#local-6989586621679241173"><span class="hs-identifier hs-var hs-var">pathParamBindings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="annottext">[(Text, ValueSource)] -&gt; Map Text ValueSource
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-265"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedParam -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#rpName"><span class="hs-identifier hs-var">rpName</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedParam
</span><a href="#local-6989586621679241177"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#FromState"><span class="hs-identifier hs-var">FromState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedParam -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#rpName"><span class="hs-identifier hs-var">rpName</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedParam
</span><a href="#local-6989586621679241177"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679241177"><span class="annot"><span class="annottext">ResolvedParam
</span><a href="#local-6989586621679241177"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; [ResolvedParam]
</span><a href="Haskemathesis.OpenApi.Types.html#roParameters"><span class="hs-identifier hs-var">roParameters</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241172"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-267"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ResolvedParam -&gt; ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#rpLocation"><span class="hs-identifier hs-var">rpLocation</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedParam
</span><a href="#local-6989586621679241177"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ParamLocation -&gt; ParamLocation -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#ParamPath"><span class="hs-identifier hs-var">ParamPath</span></a></span><span>
</span><span id="line-268"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><span class="hs-comment">-- | Find DELETE operations that can clean up resources created in the sequence.</span></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#findCleanupOperations"><span class="hs-identifier hs-type">findCleanupOperations</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-276"></span><span id="findCleanupOperations"><span class="annot"><span class="annottext">findCleanupOperations :: [ResolvedOperation]
-&gt; [OperationLink] -&gt; [SequenceStep] -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.Stateful.Sequence.html#findCleanupOperations"><span class="hs-identifier hs-var hs-var">findCleanupOperations</span></a></span></span><span> </span><span id="local-6989586621679241182"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241182"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679241183"><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241183"><span class="hs-identifier hs-var">links</span></a></span></span><span> </span><span id="local-6989586621679241184"><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241184"><span class="hs-identifier hs-var">steps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-comment">-- Find all creator operations in the sequence</span><span>
</span><span id="line-279"></span><span>        </span><span id="local-6989586621679241185"><span class="annot"><span class="annottext">creatorLabels :: [Text]
</span><a href="#local-6989586621679241185"><span class="hs-identifier hs-var hs-var">creatorLabels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SequenceStep -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#ssOperationId"><span class="hs-identifier hs-var">ssOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241186"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679241186"><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241186"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241184"><span class="hs-identifier hs-var">steps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SequenceStep -&gt; [ResolvedOperation] -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isCreatorStep"><span class="hs-identifier hs-var">isCreatorStep</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241186"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241182"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-comment">-- Find DELETE links from those creators</span><span>
</span><span id="line-281"></span><span>        </span><span id="local-6989586621679241190"><span class="annot"><span class="annottext">deleteLinks :: [OperationLink]
</span><a href="#local-6989586621679241190"><span class="hs-identifier hs-var hs-var">deleteLinks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">OperationLink
</span><a href="#local-6989586621679241191"><span class="hs-identifier hs-var">link</span></a></span><span>
</span><span id="line-283"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679241191"><span class="annot"><span class="annottext">OperationLink
</span><a href="#local-6989586621679241191"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241183"><span class="hs-identifier hs-var">links</span></a></span><span>
</span><span id="line-284"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OperationLink -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#olSourceOperation"><span class="hs-identifier hs-var">olSourceOperation</span></a></span><span> </span><span class="annot"><span class="annottext">OperationLink
</span><a href="#local-6989586621679241191"><span class="hs-identifier hs-var">link</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679241185"><span class="hs-identifier hs-var">creatorLabels</span></a></span><span>
</span><span id="line-285"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [ResolvedOperation] -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isDeleteOperation"><span class="hs-identifier hs-var">isDeleteOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OperationLink -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#olTargetOperation"><span class="hs-identifier hs-var">olTargetOperation</span></a></span><span> </span><span class="annot"><span class="annottext">OperationLink
</span><a href="#local-6989586621679241191"><span class="hs-identifier hs-var">link</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241182"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-286"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-comment">-- Get the target operations</span><span>
</span><span id="line-288"></span><span>        </span><span id="local-6989586621679241194"><span class="annot"><span class="annottext">deleteOpLabels :: [Text]
</span><a href="#local-6989586621679241194"><span class="hs-identifier hs-var hs-var">deleteOpLabels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(OperationLink -&gt; Text) -&gt; [OperationLink] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">OperationLink -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#olTargetOperation"><span class="hs-identifier hs-var">olTargetOperation</span></a></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241190"><span class="hs-identifier hs-var">deleteLinks</span></a></span><span>
</span><span id="line-289"></span><span>     </span><span class="hs-keyword">in</span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; Maybe ResolvedOperation) -&gt; [Text] -&gt; [ResolvedOperation]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [ResolvedOperation] -&gt; Maybe ResolvedOperation
</span><a href="Haskemathesis.Stateful.Sequence.html#findOperationByLabel"><span class="hs-operator hs-var">`findOperationByLabel`</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241182"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679241194"><span class="hs-identifier hs-var">deleteOpLabels</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><span class="hs-comment">-- | Create cleanup steps for operations.</span></span><span>
</span><span id="line-293"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#createCleanupSteps"><span class="hs-identifier hs-type">createCleanupSteps</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span id="createCleanupSteps"><span class="annot"><span class="annottext">createCleanupSteps :: [ResolvedOperation]
-&gt; [OperationLink] -&gt; [SequenceStep] -&gt; [SequenceStep]
</span><a href="Haskemathesis.Stateful.Sequence.html#createCleanupSteps"><span class="hs-identifier hs-var hs-var">createCleanupSteps</span></a></span></span><span> </span><span id="local-6989586621679241195"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241195"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679241196"><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241196"><span class="hs-identifier hs-var">links</span></a></span></span><span> </span><span id="local-6989586621679241197"><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241197"><span class="hs-identifier hs-var">steps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241198"><span class="annot"><span class="annottext">deleteOps :: [ResolvedOperation]
</span><a href="#local-6989586621679241198"><span class="hs-identifier hs-var hs-var">deleteOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
-&gt; [OperationLink] -&gt; [SequenceStep] -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.Stateful.Sequence.html#findCleanupOperations"><span class="hs-identifier hs-var">findCleanupOperations</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241195"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241196"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241197"><span class="hs-identifier hs-var">steps</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-comment">-- Check if DELETE is already in the main steps</span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621679241199"><span class="annot"><span class="annottext">mainDeleteLabels :: [Text]
</span><a href="#local-6989586621679241199"><span class="hs-identifier hs-var hs-var">mainDeleteLabels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SequenceStep -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#ssOperationId"><span class="hs-identifier hs-var">ssOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241200"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679241200"><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241200"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SequenceStep]
</span><a href="#local-6989586621679241197"><span class="hs-identifier hs-var">steps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SequenceStep -&gt; [ResolvedOperation] -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isDeleteStep"><span class="hs-identifier hs-var">isDeleteStep</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241200"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241195"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ResolvedOperation -&gt; SequenceStep
</span><a href="Haskemathesis.Stateful.Sequence.html#createResourceStep"><span class="hs-identifier hs-var">createResourceStep</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241202"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679241202"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241202"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241198"><span class="hs-identifier hs-var">deleteOps</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Stateful.Sequence.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241202"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679241199"><span class="hs-identifier hs-var">mainDeleteLabels</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><span class="hs-comment">{- | Check if an operation can start a sequence.

An operation can start a sequence if:
1. It has no required path parameters, OR
2. It's a POST (creator) operation
-}</span></span><span>
</span><span id="line-313"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#canStartSequence"><span class="hs-identifier hs-type">canStartSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-318"></span><span id="canStartSequence"><span class="annot"><span class="annottext">canStartSequence :: [ResolvedOperation] -&gt; [OperationLink] -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#canStartSequence"><span class="hs-identifier hs-var hs-var">canStartSequence</span></a></span></span><span> </span><span id="local-6989586621679241204"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241204"><span class="hs-identifier hs-var">_ops</span></a></span></span><span> </span><span id="local-6989586621679241205"><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679241205"><span class="hs-identifier hs-var">_links</span></a></span></span><span> </span><span id="local-6989586621679241206"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241206"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-comment">-- Can start if it's a creator or has no required path params</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isCreatorOperation"><span class="hs-identifier hs-var">isCreatorOperation</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241206"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#hasRequiredPathParams"><span class="hs-identifier hs-var">hasRequiredPathParams</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241206"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><span class="hs-comment">-- | Get all creator operations (typically POSTs to collection endpoints).</span></span><span>
</span><span id="line-323"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#getCreatorOperations"><span class="hs-identifier hs-type">getCreatorOperations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-324"></span><span id="getCreatorOperations"><span class="annot"><span class="annottext">getCreatorOperations :: [ResolvedOperation] -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.Stateful.Sequence.html#getCreatorOperations"><span class="hs-identifier hs-var hs-var">getCreatorOperations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isCreatorOperation"><span class="hs-identifier hs-var">isCreatorOperation</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><span class="hs-comment">{- | Get operations related to a resource path.

Given a collection path like &quot;/users&quot;, finds operations on &quot;/users/{id}&quot;.
-}</span></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#getResourceOperations"><span class="hs-identifier hs-type">getResourceOperations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span id="getResourceOperations"><span class="annot"><span class="annottext">getResourceOperations :: Text -&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.Stateful.Sequence.html#getResourceOperations"><span class="hs-identifier hs-var hs-var">getResourceOperations</span></a></span></span><span> </span><span id="local-6989586621679241211"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241211"><span class="hs-identifier hs-var">basePath</span></a></span></span><span> </span><span id="local-6989586621679241212"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241212"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241213"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679241213"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241213"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241212"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679241214"><span class="annot"><span class="annottext">path :: Text
</span><a href="#local-6989586621679241214"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roPath"><span class="hs-identifier hs-var">roPath</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241213"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241214"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241211"><span class="hs-identifier hs-var">basePath</span></a></span><span> </span><span class="hs-comment">-- Different from base</span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241211"><span class="hs-identifier hs-var">basePath</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241214"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-comment">-- Starts with base</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#hasPathParams"><span class="hs-identifier hs-var">hasPathParams</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241213"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-comment">-- Has path parameters</span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- Internal helpers</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#emptySequence"><span class="hs-identifier hs-type">emptySequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationSequence"><span class="hs-identifier hs-type">OperationSequence</span></a></span><span>
</span><span id="line-343"></span><span id="emptySequence"><span class="annot"><span class="annottext">emptySequence :: OperationSequence
</span><a href="Haskemathesis.Stateful.Sequence.html#emptySequence"><span class="hs-identifier hs-var hs-var">emptySequence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SequenceStep] -&gt; [SequenceStep] -&gt; OperationSequence
</span><a href="Haskemathesis.Stateful.Types.html#OperationSequence"><span class="hs-identifier hs-var">OperationSequence</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#operationLabel"><span class="hs-identifier hs-type">operationLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-346"></span><span id="operationLabel"><span class="annot"><span class="annottext">operationLabel :: ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Stateful.Sequence.html#operationLabel"><span class="hs-identifier hs-var hs-var">operationLabel</span></a></span></span><span> </span><span id="local-6989586621679241218"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241218"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Maybe Text
</span><a href="Haskemathesis.OpenApi.Types.html#roOperationId"><span class="hs-identifier hs-var">roOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241218"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679241220"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241220"><span class="hs-identifier hs-var">opId</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241220"><span class="hs-identifier hs-var">opId</span></a></span><span>
</span><span id="line-349"></span><span>        </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241218"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roPath"><span class="hs-identifier hs-var">roPath</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241218"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#isCreatorOperation"><span class="hs-identifier hs-type">isCreatorOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-352"></span><span id="isCreatorOperation"><span class="annot"><span class="annottext">isCreatorOperation :: ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isCreatorOperation"><span class="hs-identifier hs-var hs-var">isCreatorOperation</span></a></span></span><span> </span><span id="local-6989586621679241221"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241221"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241221"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;POST&quot;</span></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#hasRequiredPathParams"><span class="hs-identifier hs-type">hasRequiredPathParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-355"></span><span id="hasRequiredPathParams"><span class="annot"><span class="annottext">hasRequiredPathParams :: ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#hasRequiredPathParams"><span class="hs-identifier hs-var hs-var">hasRequiredPathParams</span></a></span></span><span> </span><span id="local-6989586621679241222"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241222"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><span class="annottext">(ResolvedParam -&gt; Bool) -&gt; [ResolvedParam] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">ResolvedParam -&gt; Bool
</span><a href="#local-6989586621679241224"><span class="hs-identifier hs-var">isRequiredPathParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; [ResolvedParam]
</span><a href="Haskemathesis.OpenApi.Types.html#roParameters"><span class="hs-identifier hs-var">roParameters</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241222"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621679241224"><span class="annot"><span class="annottext">isRequiredPathParam :: ResolvedParam -&gt; Bool
</span><a href="#local-6989586621679241224"><span class="hs-identifier hs-var hs-var">isRequiredPathParam</span></a></span></span><span> </span><span id="local-6989586621679241226"><span class="annot"><span class="annottext">ResolvedParam
</span><a href="#local-6989586621679241226"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResolvedParam -&gt; ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#rpLocation"><span class="hs-identifier hs-var">rpLocation</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedParam
</span><a href="#local-6989586621679241226"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ParamLocation -&gt; ParamLocation -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#ParamPath"><span class="hs-identifier hs-var">ParamPath</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedParam -&gt; Bool
</span><a href="Haskemathesis.OpenApi.Types.html#rpRequired"><span class="hs-identifier hs-var">rpRequired</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedParam
</span><a href="#local-6989586621679241226"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#hasPathParams"><span class="hs-identifier hs-type">hasPathParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-361"></span><span id="hasPathParams"><span class="annot"><span class="annottext">hasPathParams :: ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#hasPathParams"><span class="hs-identifier hs-var hs-var">hasPathParams</span></a></span></span><span> </span><span id="local-6989586621679241228"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241228"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedParam -&gt; Bool) -&gt; [ResolvedParam] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParamLocation -&gt; ParamLocation -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#ParamPath"><span class="hs-identifier hs-var">ParamPath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParamLocation -&gt; Bool)
-&gt; (ResolvedParam -&gt; ParamLocation) -&gt; ResolvedParam -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ResolvedParam -&gt; ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#rpLocation"><span class="hs-identifier hs-var">rpLocation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; [ResolvedParam]
</span><a href="Haskemathesis.OpenApi.Types.html#roParameters"><span class="hs-identifier hs-var">roParameters</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241228"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#isCreatorStep"><span class="hs-identifier hs-type">isCreatorStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-364"></span><span id="isCreatorStep"><span class="annot"><span class="annottext">isCreatorStep :: SequenceStep -&gt; [ResolvedOperation] -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isCreatorStep"><span class="hs-identifier hs-var hs-var">isCreatorStep</span></a></span></span><span> </span><span id="local-6989586621679241229"><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241229"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679241230"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241230"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; (ResolvedOperation -&gt; Bool) -&gt; Maybe ResolvedOperation -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isCreatorOperation"><span class="hs-identifier hs-var">isCreatorOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [ResolvedOperation] -&gt; Maybe ResolvedOperation
</span><a href="Haskemathesis.Stateful.Sequence.html#findOperationByLabel"><span class="hs-identifier hs-var">findOperationByLabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SequenceStep -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#ssOperationId"><span class="hs-identifier hs-var">ssOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241229"><span class="hs-identifier hs-var">step</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241230"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#isDeleteOperation"><span class="hs-identifier hs-type">isDeleteOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-368"></span><span id="isDeleteOperation"><span class="annot"><span class="annottext">isDeleteOperation :: Text -&gt; [ResolvedOperation] -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isDeleteOperation"><span class="hs-identifier hs-var hs-var">isDeleteOperation</span></a></span></span><span> </span><span id="local-6989586621679241232"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241232"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679241233"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241233"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [ResolvedOperation] -&gt; Maybe ResolvedOperation
</span><a href="Haskemathesis.Stateful.Sequence.html#findOperationByLabel"><span class="hs-identifier hs-var">findOperationByLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679241232"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241233"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-370"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679241234"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241234"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241234"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;DELETE&quot;</span></span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="annottext">Maybe ResolvedOperation
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#isDeleteStep"><span class="hs-identifier hs-type">isDeleteStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-374"></span><span id="isDeleteStep"><span class="annot"><span class="annottext">isDeleteStep :: SequenceStep -&gt; [ResolvedOperation] -&gt; Bool
</span><a href="Haskemathesis.Stateful.Sequence.html#isDeleteStep"><span class="hs-identifier hs-var hs-var">isDeleteStep</span></a></span></span><span> </span><span id="local-6989586621679241235"><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241235"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679241236"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241236"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [ResolvedOperation] -&gt; Maybe ResolvedOperation
</span><a href="Haskemathesis.Stateful.Sequence.html#findOperationByLabel"><span class="hs-identifier hs-var">findOperationByLabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SequenceStep -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#ssOperationId"><span class="hs-identifier hs-var">ssOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679241235"><span class="hs-identifier hs-var">step</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679241236"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679241237"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241237"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679241237"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;DELETE&quot;</span></span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><span class="annottext">Maybe ResolvedOperation
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-378"></span></pre></body></html>