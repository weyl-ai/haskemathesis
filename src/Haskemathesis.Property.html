<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | High-level property generation for resolved operations and specs.

This module provides the main entry points for generating Hedgehog properties
from OpenAPI specifications. Properties can be generated for individual
operations or entire specs, with various configuration options.

=== Basic Usage

Generate properties for all operations in a spec:

@
import Haskemathesis.OpenApi.Loader (loadOpenApiFile)
import Haskemathesis.OpenApi.Resolve (resolveOperations)
import Haskemathesis.Property (propertiesForSpec)
import Haskemathesis.Check.Standard (defaultChecks)

main :: IO ()
main = do
    Right spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let ops = resolveOperations spec
        props = propertiesForSpec Nothing defaultChecks myExecutor ops
    -- Run properties with your favorite test framework
@

=== Configuration

For more control, use 'propertiesForSpecWithConfig':

@
import Haskemathesis.Config

myConfig :: TestConfig
myConfig = defaultTestConfig
    { tcPropertyCount = 200
    , tcNegativeTesting = True
    , tcOperationFilter = filterByTag &quot;public&quot;
    }
@

=== Stateful Testing

For stateful API testing that chains operations together:

@
import Haskemathesis.Property (propertyStateful)

-- Run stateful CRUD sequences
prop = propertyStateful spec config httpExecutor ops
@
-}</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html"><span class="hs-identifier">Haskemathesis.Property</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Single Operation Properties</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier">propertyForOperation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier">propertyForOperationWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationNegative"><span class="hs-identifier">propertyForOperationNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Spec-Level Properties</span></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpec"><span class="hs-identifier">propertiesForSpec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier">propertiesForSpecWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecNegative"><span class="hs-identifier">propertiesForSpecNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Stateful Testing</span></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertyStateful"><span class="hs-identifier">propertyStateful</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecStateful"><span class="hs-identifier">propertiesForSpecStateful</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#executeStatefulSequence"><span class="hs-identifier">executeStatefulSequence</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#executeStatefulStep"><span class="hs-identifier">executeStatefulStep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Stateful Testing Helpers (for testing)</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#runStatefulChecksProperty"><span class="hs-identifier">runStatefulChecksProperty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#isStatefulFailure"><span class="hs-identifier">isStatefulFailure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#renderStatefulFailure"><span class="hs-identifier">renderStatefulFailure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Timeout Utilities</span></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#effectiveTimeout"><span class="hs-identifier">effectiveTimeout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldM</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.html"><span class="hs-identifier">Data.OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier">OpenApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">withFrozenCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html"><span class="hs-identifier">Haskemathesis.Auth.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Auth.Config.html#applyAuthForOperation"><span class="hs-identifier">applyAuthForOperation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Negative.html"><span class="hs-identifier">Haskemathesis.Check.Negative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Negative.html#negativeTestRejection"><span class="hs-identifier">negativeTestRejection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html"><span class="hs-identifier">Haskemathesis.Check.Standard.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier">operationLabel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html"><span class="hs-identifier">Haskemathesis.Check.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier">Check</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#CheckResult"><span class="hs-identifier">CheckResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#FailureDetail"><span class="hs-identifier">FailureDetail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html"><span class="hs-identifier">Haskemathesis.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier">TestConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html"><span class="hs-identifier">Haskemathesis.Execute.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier">ApiRequest</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier">ApiResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier">BaseUrl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier">ExecutorWithTimeout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Negative.html"><span class="hs-identifier">Haskemathesis.Gen.Negative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Gen.Negative.html#genNegativeRequest"><span class="hs-identifier">genNegativeRequest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Negative.Types.html#renderNegativeMutation"><span class="hs-identifier">renderNegativeMutation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Request.html"><span class="hs-identifier">Haskemathesis.Gen.Request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Gen.Request.html#genApiRequest"><span class="hs-identifier">genApiRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html"><span class="hs-identifier">Haskemathesis.OpenApi.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier">ResolvedOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Report.Render.html"><span class="hs-identifier">Haskemathesis.Report.Render</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Report.Render.html#renderFailureDetailAnsi"><span class="hs-identifier">renderFailureDetailAnsi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html"><span class="hs-identifier">Haskemathesis.Stateful.Checks</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#StatefulCheckResult"><span class="hs-identifier">StatefulCheckResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#StatefulFailure"><span class="hs-identifier">StatefulFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#runStatefulChecks"><span class="hs-identifier">runStatefulChecks</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Generator.html"><span class="hs-identifier">Haskemathesis.Stateful.Generator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Stateful.Generator.html#genStatefulRequest"><span class="hs-identifier">genStatefulRequest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Generator.html#updateState"><span class="hs-identifier">updateState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Heuristics.html"><span class="hs-identifier">Haskemathesis.Stateful.Heuristics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Stateful.Heuristics.html#inferLinks"><span class="hs-identifier">inferLinks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html"><span class="hs-identifier">Haskemathesis.Stateful.Links</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#extractLinks"><span class="hs-identifier">extractLinks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html"><span class="hs-identifier">Haskemathesis.Stateful.Sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#findOperationByLabel"><span class="hs-identifier">findOperationByLabel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Sequence.html#genOperationSequence"><span class="hs-identifier">genOperationSequence</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html"><span class="hs-identifier">Haskemathesis.Stateful.Types</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationSequence"><span class="hs-identifier">OperationSequence</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier">SequenceStep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#TestState"><span class="hs-identifier">TestState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#emptyState"><span class="hs-identifier">emptyState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier">Gen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier">Property</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier">evalIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier">failure</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier">forAll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier">property</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier">success</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier">withTests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html"><span class="hs-identifier">Hedgehog.Internal.Property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier">PropertyT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#footnote"><span class="hs-identifier">footnote</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookupEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><span class="hs-comment">{- | Generate a Hedgehog property for a single operation using basic configuration.

This is the simplest way to create a property for an operation. The property
will generate random requests based on the OpenAPI schema and execute them
against your API, then run the provided checks on the response.

=== Parameters

* @mBase@ - Optional base URL for rendering failure reports (can be 'Nothing')
* @checks@ - List of 'Check' functions to validate responses
* @execute@ - Function to execute an 'ApiRequest' and return an 'ApiResponse'
* @op@ - The 'ResolvedOperation' to generate tests for

=== Example

@
let prop = propertyForOperation (Just &quot;http://localhost:8080&quot;) checks httpExecutor myOperation
@
-}</span></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier hs-type">propertyForOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-139"></span><span id="propertyForOperation"><span class="annot"><span class="annottext">propertyForOperation :: Maybe Text
-&gt; [Check] -&gt; ExecutorWithTimeout -&gt; ResolvedOperation -&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier hs-var hs-var">propertyForOperation</span></a></span></span><span> </span><span id="local-6989586621679244421"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679244421"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679244422"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244422"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679244423"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244423"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244424"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244424"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>        </span><span id="local-6989586621679244425"><span class="annot"><a href="#local-6989586621679244425"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen ApiRequest -&gt; PropertyT IO ApiRequest
forall (m :: * -&gt; *) a. (Monad m, Show a) =&gt; Gen a -&gt; PropertyT m a
</span><a href="Haskemathesis.Property.html#forAllNoLoc"><span class="hs-identifier hs-var">forAllNoLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Gen ApiRequest
</span><a href="Haskemathesis.Gen.Request.html#genApiRequest"><span class="hs-identifier hs-var">genApiRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244424"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-comment">-- No config available, so no timeout for basic version</span><span>
</span><span id="line-143"></span><span>        </span><span id="local-6989586621679244427"><span class="annot"><a href="#local-6989586621679244427"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-type">evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244423"><span class="hs-identifier hs-type">execute</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621679244425"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><a href="Haskemathesis.Property.html#runChecks"><span class="hs-identifier hs-type">runChecks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244421"><span class="hs-identifier hs-type">mBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244422"><span class="hs-identifier hs-type">checks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244425"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244427"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244424"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><span class="hs-comment">{- | Generate a property with full configuration support including authentication.

This function provides more control than 'propertyForOperation' by accepting
a 'TestConfig' record. It supports:

* Authentication via 'tcAuthConfig'
* Custom property counts via 'tcPropertyCount'
* Operation filtering via 'tcOperationFilter'
* Automatic timeout handling for streaming endpoints

=== Parameters

* @openApi@ - The full OpenAPI specification (needed for auth resolution)
* @config@ - The 'TestConfig' controlling test generation
* @execute@ - Timeout-aware executor (see 'ExecutorWithTimeout')
* @op@ - The operation to test

=== Example

@
config = defaultTestConfig { tcPropertyCount = 200 }
prop = propertyForOperationWithConfig spec config httpExecutor myOperation
@
-}</span></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier hs-type">propertyForOperationWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-176"></span><span id="propertyForOperationWithConfig"><span class="annot"><span class="annottext">propertyForOperationWithConfig :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier hs-var hs-var">propertyForOperationWithConfig</span></a></span></span><span> </span><span id="local-6989586621679244433"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244433"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244434"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244434"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244435"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244435"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244436"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244436"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestLimit
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig -&gt; Int
</span><a href="Haskemathesis.Config.html#tcPropertyCount"><span class="hs-identifier hs-var">tcPropertyCount</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244434"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>            </span><span id="local-6989586621679244437"><span class="annot"><a href="#local-6989586621679244437"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen ApiRequest -&gt; PropertyT IO ApiRequest
forall (m :: * -&gt; *) a. (Monad m, Show a) =&gt; Gen a -&gt; PropertyT m a
</span><a href="Haskemathesis.Property.html#forAllNoLoc"><span class="hs-identifier hs-var">forAllNoLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Gen ApiRequest
</span><a href="Haskemathesis.Gen.Request.html#genApiRequest"><span class="hs-identifier hs-var">genApiRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244436"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244438"><span class="annot"><a href="#local-6989586621679244438"><span class="hs-identifier hs-var hs-var">req'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Property.html#applyConfigToRequest"><span class="hs-identifier hs-var">applyConfigToRequest</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244433"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244434"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244436"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244437"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-181"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244440"><span class="annot"><a href="#local-6989586621679244440"><span class="hs-identifier hs-var hs-var">timeout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Maybe Int
</span><a href="Haskemathesis.Property.html#effectiveTimeout"><span class="hs-identifier hs-var">effectiveTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244434"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244436"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-182"></span><span>            </span><span id="local-6989586621679244441"><span class="annot"><a href="#local-6989586621679244441"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-type">evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244435"><span class="hs-identifier hs-type">execute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244440"><span class="hs-identifier hs-type">timeout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244438"><span class="hs-identifier hs-type">req'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>            </span><span class="annot"><a href="Haskemathesis.Property.html#runChecks"><span class="hs-identifier hs-type">runChecks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244434"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#tcChecks"><span class="hs-identifier hs-var">tcChecks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244434"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679244438"><span class="hs-identifier hs-type">req'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244441"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244436"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><span class="hs-comment">{- | Generate a negative testing property for an operation.

Negative testing generates /invalid/ requests to verify that the API
properly rejects malformed input. This property generates mutations
that violate the OpenAPI schema (e.g., missing required fields,
wrong content types, invalid values) and verifies the API rejects them.

=== When to Use

Use this when you want to verify your API's error handling and
input validation. The API should return 4xx status codes for
these invalid requests.

=== Parameters

* @openApi@ - The full OpenAPI specification
* @config@ - The 'TestConfig' (negative testing is enabled separately)
* @execute@ - Timeout-aware executor
* @op@ - The operation to test

=== Example

@
config = defaultTestConfig { tcPropertyCount = 50 }
negProp = propertyForOperationNegative spec config httpExecutor myOperation
@
-}</span></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationNegative"><span class="hs-identifier hs-type">propertyForOperationNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-218"></span><span id="propertyForOperationNegative"><span class="annot"><span class="annottext">propertyForOperationNegative :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationNegative"><span class="hs-identifier hs-var hs-var">propertyForOperationNegative</span></a></span></span><span> </span><span id="local-6989586621679244444"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244444"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244445"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244445"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244446"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244446"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244447"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244447"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestLimit
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig -&gt; Int
</span><a href="Haskemathesis.Config.html#tcPropertyCount"><span class="hs-identifier hs-var">tcPropertyCount</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244445"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>            </span><span id="local-6989586621679244448"><span class="annot"><a href="#local-6989586621679244448"><span class="hs-identifier hs-var">mReq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Maybe (ApiRequest, NegativeMutation))
-&gt; PropertyT IO (Maybe (ApiRequest, NegativeMutation))
forall (m :: * -&gt; *) a. (Monad m, Show a) =&gt; Gen a -&gt; PropertyT m a
</span><a href="Haskemathesis.Property.html#forAllNoLoc"><span class="hs-identifier hs-var">forAllNoLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Gen (Maybe (ApiRequest, NegativeMutation))
</span><a href="Haskemathesis.Gen.Negative.html#genNegativeRequest"><span class="hs-identifier hs-var">genNegativeRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244447"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679244448"><span class="hs-identifier hs-type">mReq</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-223"></span><span>                </span><span class="annot"><span class="annottext">Maybe (ApiRequest, NegativeMutation)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-224"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679244449"><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244449"><span class="hs-identifier hs-var">req</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244450"><span class="annot"><span class="annottext">NegativeMutation
</span><a href="#local-6989586621679244450"><span class="hs-identifier hs-var">mutation</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244451"><span class="annot"><span class="annottext">req' :: ApiRequest
</span><a href="#local-6989586621679244451"><span class="hs-identifier hs-var hs-var hs-var">req'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Property.html#applyConfigToRequest"><span class="hs-identifier hs-var">applyConfigToRequest</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244444"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244445"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244447"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244449"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-226"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244452"><span class="annot"><span class="annottext">timeout :: Maybe Int
</span><a href="#local-6989586621679244452"><span class="hs-identifier hs-var hs-var hs-var">timeout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Maybe Int
</span><a href="Haskemathesis.Property.html#effectiveTimeout"><span class="hs-identifier hs-var">effectiveTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244445"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244447"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-227"></span><span>                    </span><span id="local-6989586621679244453"><span class="annot"><a href="#local-6989586621679244453"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ApiResponse -&gt; PropertyT IO ApiResponse
forall (m :: * -&gt; *) a.
(MonadTest m, MonadIO m, HasCallStack) =&gt;
IO a -&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-var">evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244446"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679244452"><span class="hs-identifier hs-var">timeout</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244451"><span class="hs-identifier hs-var">req'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Negative.html#negativeTestRejection"><span class="hs-identifier hs-type">negativeTestRejection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Gen.Negative.Types.html#renderNegativeMutation"><span class="hs-identifier hs-type">renderNegativeMutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244450"><span class="hs-identifier hs-type">mutation</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679244451"><span class="hs-identifier hs-type">req'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244453"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244447"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>                        </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Haskemathesis.Check.Types.html#CheckPassed"><span class="hs-identifier hs-var">CheckPassed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-230"></span><span>                        </span><span class="annot"><a href="Haskemathesis.Check.Types.html#CheckFailed"><span class="hs-identifier hs-type">CheckFailed</span></a></span><span> </span><span id="local-6989586621679244456"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679244456"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; FailureDetail -&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#reportFailure"><span class="hs-identifier hs-var">reportFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig -&gt; Maybe Text
</span><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244445"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679244456"><span class="hs-identifier hs-var">detail</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="annot"><span class="hs-comment">{- | Generate properties for all operations in a spec using basic configuration.

This is the simplest way to generate a complete test suite from an
OpenAPI specification. It creates a list of named properties, one
for each resolved operation.

=== Return Value

Returns a list of tuples where:
* First element: A descriptive label (operation ID or method+path)
* Second element: The Hedgehog 'Property' for testing that operation

=== Parameters

* @mBase@ - Optional base URL for rendering failure reports
* @checks@ - List of 'Check' functions to validate responses
* @execute@ - Function to execute requests
* @ops@ - List of resolved operations (from 'resolveOperations')

=== Example

@
main :: IO ()
main = do
    Right spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let ops = resolveOperations spec
        props = propertiesForSpec Nothing defaultChecks httpExecutor ops
    -- Run with your test framework
@
-}</span></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpec"><span class="hs-identifier hs-type">propertiesForSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span id="propertiesForSpec"><span class="annot"><span class="annottext">propertiesForSpec :: Maybe Text
-&gt; [Check]
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpec"><span class="hs-identifier hs-var hs-var">propertiesForSpec</span></a></span></span><span> </span><span id="local-6989586621679244458"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679244458"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679244459"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244459"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679244460"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244460"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244461"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244461"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244462"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
-&gt; [Check] -&gt; ExecutorWithTimeout -&gt; ResolvedOperation -&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier hs-var">propertyForOperation</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679244458"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244459"><span class="hs-identifier hs-var">checks</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244460"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244462"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679244462"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244462"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244461"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><span class="hs-comment">{- | Generate properties with full configuration support.

This function provides the most flexibility for generating properties.
It supports authentication, operation filtering, custom check sets,
automatic timeout handling for streaming endpoints, and can generate
both positive and negative test cases.

=== Negative Testing

When 'tcNegativeTesting' is 'True', this function generates both
normal properties and negative testing properties (prefixed with
&quot;NEGATIVE:&quot;). Negative tests verify that the API properly rejects
invalid requests.

=== Operation Filtering

Only operations that satisfy 'tcOperationFilter' will have properties
generated. This is useful for testing subsets of your API.

=== Timeout Handling

Streaming endpoints (SSE, NDJSON) are automatically detected and
tested with timeouts to prevent tests from hanging. The timeout
is determined by (in order of precedence):

1. Operation's @x-timeout@ extension (if set in OpenAPI spec)
2. 'tcStreamingTimeout' from config (if operation is streaming)
3. No timeout (for non-streaming operations without @x-timeout@)

=== Parameters

* @openApi@ - The full OpenAPI specification (needed for auth resolution)
* @config@ - The 'TestConfig' controlling all aspects of generation
* @execute@ - Timeout-aware executor (see 'ExecutorWithTimeout')
* @ops@ - List of resolved operations

=== Example

@
config = defaultTestConfig
    { tcPropertyCount = 200
    , tcNegativeTesting = True
    , tcOperationFilter = filterByTag &quot;public&quot;
    }
props = propertiesForSpecWithConfig spec config httpExecutor ops
@
-}</span></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier hs-type">propertiesForSpecWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span id="propertiesForSpecWithConfig"><span class="annot"><span class="annottext">propertiesForSpecWithConfig :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier hs-var hs-var">propertiesForSpecWithConfig</span></a></span></span><span> </span><span id="local-6989586621679244465"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244465"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244466"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244466"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244467"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244467"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244468"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244468"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">[(Text, Property)]
</span><a href="#local-6989586621679244469"><span class="hs-identifier hs-var">normalProps</span></a></span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><span class="annottext">[(Text, Property)] -&gt; [(Text, Property)] -&gt; [(Text, Property)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcNegativeTesting"><span class="hs-identifier hs-var">tcNegativeTesting</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244466"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-329"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(Text, Property)]
</span><a href="#local-6989586621679244470"><span class="hs-identifier hs-var">negativeProps</span></a></span><span>
</span><span id="line-330"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679244469"><span class="annot"><span class="annottext">normalProps :: [(Text, Property)]
</span><a href="#local-6989586621679244469"><span class="hs-identifier hs-var hs-var">normalProps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244471"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier hs-var">propertyForOperationWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244465"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244466"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244467"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244471"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679244471"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244471"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244468"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcOperationFilter"><span class="hs-identifier hs-var">tcOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244466"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244471"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679244470"><span class="annot"><span class="annottext">negativeProps :: [(Text, Property)]
</span><a href="#local-6989586621679244470"><span class="hs-identifier hs-var hs-var">negativeProps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;NEGATIVE: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244474"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationNegative"><span class="hs-identifier hs-var">propertyForOperationNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244465"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244466"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244467"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244474"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679244474"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244474"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244468"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcOperationFilter"><span class="hs-identifier hs-var">tcOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244466"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244474"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-341"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><span class="hs-comment">{- | Generate only negative testing properties.

This is a convenience function that generates only negative test properties
for all operations. Negative tests verify that the API properly rejects
invalid requests (mutations that violate the OpenAPI schema).

=== Use Cases

* Testing input validation and error handling
* Verifying security controls reject malformed requests
* Dedicated negative testing suites

=== Parameters

* @openApi@ - The full OpenAPI specification
* @config@ - The 'TestConfig' (negative testing flag is ignored, always enabled)
* @execute@ - Timeout-aware executor
* @ops@ - List of resolved operations

=== Example

@
-- Dedicated negative testing suite
negativeProps = propertiesForSpecNegative spec defaultConfig httpExecutor ops
@
-}</span></span><span>
</span><span id="line-369"></span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecNegative"><span class="hs-identifier hs-type">propertiesForSpecNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-375"></span><span id="propertiesForSpecNegative"><span class="annot"><span class="annottext">propertiesForSpecNegative :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpecNegative"><span class="hs-identifier hs-var hs-var">propertiesForSpecNegative</span></a></span></span><span> </span><span id="local-6989586621679244475"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244475"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244476"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244476"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier hs-var">propertiesForSpecWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244475"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244476"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcNegativeTesting"><span class="hs-identifier hs-var">tcNegativeTesting</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="annot"><span class="hs-comment">-- | Internal helper to apply auth and config headers to a request.</span></span><span>
</span><span id="line-379"></span><span class="annot"><a href="Haskemathesis.Property.html#applyConfigToRequest"><span class="hs-identifier hs-type">applyConfigToRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span>
</span><span id="line-380"></span><span id="applyConfigToRequest"><span class="annot"><span class="annottext">applyConfigToRequest :: OpenApi
-&gt; TestConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Property.html#applyConfigToRequest"><span class="hs-identifier hs-var hs-var">applyConfigToRequest</span></a></span></span><span> </span><span id="local-6989586621679244477"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244477"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244478"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244478"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244479"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244479"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679244480"><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244480"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244481"><span class="annot"><span class="annottext">reqAuth :: ApiRequest
</span><a href="#local-6989586621679244481"><span class="hs-identifier hs-var hs-var">reqAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; Maybe AuthConfig
</span><a href="Haskemathesis.Config.html#tcAuthConfig"><span class="hs-identifier hs-var">tcAuthConfig</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244478"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-382"></span><span>            </span><span class="annot"><span class="annottext">Maybe AuthConfig
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244480"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679244482"><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679244482"><span class="hs-identifier hs-var">auth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; AuthConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Auth.Config.html#applyAuthForOperation"><span class="hs-identifier hs-var">applyAuthForOperation</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244477"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679244482"><span class="hs-identifier hs-var">auth</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244479"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244480"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-384"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244481"><span class="hs-identifier hs-var">reqAuth</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqHeaders"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html#tcHeaders"><span class="hs-identifier hs-var">tcHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244478"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqHeaders"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244481"><span class="hs-identifier hs-type">reqAuth</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="annot"><span class="hs-comment">{- | Internal helper to report a failure with seed and details.
Uses footnote instead of annotate to avoid showing source location in output.
Uses withFrozenCallStack to hide internal library locations from failure call.
-}</span></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Haskemathesis.Property.html#reportFailure"><span class="hs-identifier hs-type">reportFailure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#FailureDetail"><span class="hs-identifier hs-type">FailureDetail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier hs-type">PropertyT</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span id="reportFailure"><span class="annot"><span class="annottext">reportFailure :: Maybe Text -&gt; FailureDetail -&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#reportFailure"><span class="hs-identifier hs-var hs-var">reportFailure</span></a></span></span><span> </span><span id="local-6989586621679244485"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679244485"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679244486"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679244486"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679244487"><span class="annot"><a href="#local-6989586621679244487"><span class="hs-identifier hs-var">mSeed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe String) -&gt; PropertyT IO (Maybe String)
forall (m :: * -&gt; *) a.
(MonadTest m, MonadIO m, HasCallStack) =&gt;
IO a -&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-var">evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO (Maybe String)
</span><span class="hs-identifier hs-var">lookupEnv</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HEDGEHOG_SEED&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244490"><span class="annot"><a href="#local-6989586621679244490"><span class="hs-identifier hs-var hs-var">seedText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; Maybe String -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679244487"><span class="hs-identifier hs-var">mSeed</span></a></span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#footnote"><span class="hs-identifier hs-type">footnote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Report.Render.html#renderFailureDetailAnsi"><span class="hs-identifier hs-type">renderFailureDetailAnsi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244485"><span class="hs-identifier hs-type">mBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244490"><span class="hs-identifier hs-type">seedText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244486"><span class="hs-identifier hs-type">detail</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">withFrozenCallStack</span></span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-type">failure</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><span class="hs-comment">-- | Internal helper to run all checks and report first failure.</span></span><span>
</span><span id="line-398"></span><span class="annot"><a href="Haskemathesis.Property.html#runChecks"><span class="hs-identifier hs-type">runChecks</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier hs-type">PropertyT</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span id="runChecks"><span class="annot"><span class="annottext">runChecks :: Maybe Text
-&gt; [Check]
-&gt; ApiRequest
-&gt; ApiResponse
-&gt; ResolvedOperation
-&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#runChecks"><span class="hs-identifier hs-var hs-var">runChecks</span></a></span></span><span> </span><span id="local-6989586621679244498"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679244498"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679244499"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244499"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679244500"><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244500"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679244501"><span class="annot"><span class="annottext">ApiResponse
</span><a href="#local-6989586621679244501"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621679244502"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244502"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FailureDetail
</span><a href="#local-6989586621679244503"><span class="hs-identifier hs-var">firstFailure</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-407"></span><span>        </span><span class="annot"><span class="annottext">Maybe FailureDetail
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-408"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679244504"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679244504"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; FailureDetail -&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#reportFailure"><span class="hs-identifier hs-var">reportFailure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679244498"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679244504"><span class="hs-identifier hs-var">detail</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621679244503"><span class="annot"><span class="annottext">firstFailure :: Maybe FailureDetail
</span><a href="#local-6989586621679244503"><span class="hs-identifier hs-var hs-var">firstFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679244505"><span class="hs-identifier hs-var">detail</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">checkRun :: Check
-&gt; ApiRequest -&gt; ApiResponse -&gt; ResolvedOperation -&gt; CheckResult
</span><a href="Haskemathesis.Check.Types.html#checkRun"><span class="hs-identifier hs-var">checkRun</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679244507"><span class="annot"><span class="annottext">ApiRequest -&gt; ApiResponse -&gt; ResolvedOperation -&gt; CheckResult
</span><a href="#local-6989586621679244507"><span class="hs-identifier hs-var">run</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244499"><span class="hs-identifier hs-var">checks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#CheckFailed"><span class="hs-identifier hs-type">CheckFailed</span></a></span><span> </span><span id="local-6989586621679244505"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679244505"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ApiRequest -&gt; ApiResponse -&gt; ResolvedOperation -&gt; CheckResult
</span><a href="#local-6989586621679244507"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244500"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">ApiResponse
</span><a href="#local-6989586621679244501"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244502"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-412"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FailureDetail
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-413"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679244508"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679244508"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[FailureDetail]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FailureDetail -&gt; Maybe FailureDetail
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679244508"><span class="hs-identifier hs-var">detail</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="annot"><span class="hs-comment">{- | Compute the effective timeout for an operation.

This function determines the appropriate timeout to use for an operation
based on the following precedence:

1. __Operation's @x-timeout@__: If the OpenAPI spec has @x-timeout@ set
   on the operation, that value is used (in milliseconds).

2. __Config's streaming timeout__: If the operation is detected as
   streaming (has @text/event-stream@ or @application/x-ndjson@ content
   types), the 'tcStreamingTimeout' from config is used.

3. __No timeout__: For non-streaming operations without @x-timeout@,
   'Nothing' is returned (use HTTP client default).

=== Example

@
let timeout = effectiveTimeout config operation
-- timeout is Just 2000 if x-timeout: 2000 in spec
-- timeout is Just 1000 if streaming with default config
-- timeout is Nothing for normal operations
@
-}</span></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Haskemathesis.Property.html#effectiveTimeout"><span class="hs-identifier hs-type">effectiveTimeout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-440"></span><span id="effectiveTimeout"><span class="annot"><span class="annottext">effectiveTimeout :: TestConfig -&gt; ResolvedOperation -&gt; Maybe Int
</span><a href="Haskemathesis.Property.html#effectiveTimeout"><span class="hs-identifier hs-var hs-var">effectiveTimeout</span></a></span></span><span> </span><span id="local-6989586621679244509"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244509"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244510"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244510"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Maybe Int
</span><a href="Haskemathesis.OpenApi.Types.html#roTimeout"><span class="hs-identifier hs-var">roTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244510"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-comment">-- Explicit x-timeout takes precedence</span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679244512"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244512"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244512"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-445"></span><span>            </span><span class="hs-comment">-- Streaming operations use config timeout</span><span>
</span><span id="line-446"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.OpenApi.Types.html#roIsStreaming"><span class="hs-identifier hs-var">roIsStreaming</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244510"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; Maybe Int
</span><a href="Haskemathesis.Config.html#tcStreamingTimeout"><span class="hs-identifier hs-var">tcStreamingTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244509"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-447"></span><span>            </span><span class="hs-comment">-- Non-streaming: no timeout</span><span>
</span><span id="line-448"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="annot"><span class="hs-comment">{- | Internal helper: forAll with frozen call stack.
This hides internal library source locations from Hedgehog output
while still showing the generated value.
-}</span></span><span>
</span><span id="line-454"></span><span id="local-6989586621679244182"><span id="local-6989586621679244183"><span class="annot"><a href="Haskemathesis.Property.html#forAllNoLoc"><span class="hs-identifier hs-type">forAllNoLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679244182"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679244183"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244183"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier hs-type">PropertyT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244182"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244183"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-455"></span><span id="forAllNoLoc"><span class="annot"><span class="annottext">forAllNoLoc :: forall (m :: * -&gt; *) a. (Monad m, Show a) =&gt; Gen a -&gt; PropertyT m a
</span><a href="Haskemathesis.Property.html#forAllNoLoc"><span class="hs-identifier hs-var hs-var">forAllNoLoc</span></a></span></span><span> </span><span id="local-6989586621679244518"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679244518"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; PropertyT m a) -&gt; PropertyT m a
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">withFrozenCallStack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen a -&gt; PropertyT m a
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679244518"><span class="hs-identifier hs-var">gen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- ============================================================================</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- Stateful Testing</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- ============================================================================</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="annot"><span class="hs-comment">{- | Run a stateful test that chains multiple API operations together.

Stateful testing generates sequences of API operations where responses
from earlier operations inform requests of later operations. This enables
testing realistic scenarios like:

@
POST /users         -- Create user, returns {id: 123}
GET /users/123      -- Fetch using id from POST response
PUT /users/123      -- Update using same id
DELETE /users/123   -- Remove the resource
GET /users/123      -- Should return 404 (use-after-free check)
@

=== How It Works

1. Combines explicit OpenAPI links with heuristically-inferred links
2. Generates a random valid operation sequence following these links
3. Executes each operation, extracting values for subsequent requests
4. Runs regular checks after each operation
5. Runs stateful checks after the sequence completes (e.g., use-after-free)

=== Parameters

* @openApi@ - The full OpenAPI specification
* @config@ - Test configuration (should have stateful options set)
* @execute@ - Timeout-aware executor
* @ops@ - List of resolved operations

=== Example

@
config = defaultTestConfig
    { tcStatefulTesting = True
    , tcMaxSequenceLength = 5
    }
prop = propertyStateful spec config httpExecutor ops
@
-}</span></span><span>
</span><span id="line-500"></span><span class="annot"><a href="Haskemathesis.Property.html#propertyStateful"><span class="hs-identifier hs-type">propertyStateful</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-501"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-506"></span><span id="propertyStateful"><span class="annot"><span class="annottext">propertyStateful :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyStateful"><span class="hs-identifier hs-var hs-var">propertyStateful</span></a></span></span><span> </span><span id="local-6989586621679244524"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244524"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244525"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244525"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244526"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244526"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244527"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244527"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-507"></span><span>    </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestLimit
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig -&gt; Int
</span><a href="Haskemathesis.Config.html#tcPropertyCount"><span class="hs-identifier hs-var">tcPropertyCount</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244525"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-508"></span><span>        </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-509"></span><span>            </span><span class="hs-comment">-- Combine explicit and inferred links</span><span>
</span><span id="line-510"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244528"><span class="annot"><span class="annottext">explicitLinks :: [OperationLink]
</span><a href="#local-6989586621679244528"><span class="hs-identifier hs-var hs-var hs-var">explicitLinks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [OperationLink]
</span><a href="Haskemathesis.Stateful.Links.html#extractLinks"><span class="hs-identifier hs-var">extractLinks</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244524"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-511"></span><span>                </span><span id="local-6989586621679244529"><span class="annot"><span class="annottext">inferredLinks :: [OperationLink]
</span><a href="#local-6989586621679244529"><span class="hs-identifier hs-var hs-var hs-var">inferredLinks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; [OperationLink]
</span><a href="Haskemathesis.Stateful.Heuristics.html#inferLinks"><span class="hs-identifier hs-var">inferLinks</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244527"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-512"></span><span>                </span><span id="local-6989586621679244531"><span class="annot"><span class="annottext">allLinks :: [OperationLink]
</span><a href="#local-6989586621679244531"><span class="hs-identifier hs-var hs-var hs-var">allLinks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679244528"><span class="hs-identifier hs-var">explicitLinks</span></a></span><span> </span><span class="annot"><span class="annottext">[OperationLink] -&gt; [OperationLink] -&gt; [OperationLink]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679244529"><span class="hs-identifier hs-var">inferredLinks</span></a></span><span>
</span><span id="line-513"></span><span>                </span><span id="local-6989586621679244532"><span class="annot"><span class="annottext">maxLen :: Int
</span><a href="#local-6989586621679244532"><span class="hs-identifier hs-var hs-var hs-var">maxLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; Int
</span><a href="Haskemathesis.Config.html#tcMaxSequenceLength"><span class="hs-identifier hs-var">tcMaxSequenceLength</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244525"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span>            </span><span class="hs-comment">-- Generate a random valid sequence</span><span>
</span><span id="line-516"></span><span>            </span><span id="local-6989586621679244534"><span class="annot"><a href="#local-6989586621679244534"><span class="hs-identifier hs-var">sequence'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen OperationSequence -&gt; PropertyT IO OperationSequence
forall (m :: * -&gt; *) a. (Monad m, Show a) =&gt; Gen a -&gt; PropertyT m a
</span><a href="Haskemathesis.Property.html#forAllNoLoc"><span class="hs-identifier hs-var">forAllNoLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; [ResolvedOperation] -&gt; [OperationLink] -&gt; Gen OperationSequence
</span><a href="Haskemathesis.Stateful.Sequence.html#genOperationSequence"><span class="hs-identifier hs-var">genOperationSequence</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244532"><span class="hs-identifier hs-var">maxLen</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244527"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">[OperationLink]
</span><a href="#local-6989586621679244531"><span class="hs-identifier hs-var">allLinks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span>            </span><span class="hs-comment">-- Execute the sequence and accumulate state</span><span>
</span><span id="line-519"></span><span>            </span><span id="local-6989586621679244535"><span class="annot"><a href="#local-6989586621679244535"><span class="hs-identifier hs-var">finalState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html#executeStatefulSequence"><span class="hs-identifier hs-type">executeStatefulSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244524"><span class="hs-identifier hs-type">openApi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244525"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244526"><span class="hs-identifier hs-type">execute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244527"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244534"><span class="hs-identifier hs-type">sequence'</span></a></span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span>            </span><span class="hs-comment">-- Run stateful checks on the final state</span><span>
</span><span id="line-522"></span><span>            </span><span class="annot"><a href="Haskemathesis.Property.html#runStatefulChecksProperty"><span class="hs-identifier hs-type">runStatefulChecksProperty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244525"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244526"><span class="hs-identifier hs-type">execute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244527"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244535"><span class="hs-identifier hs-type">finalState</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="annot"><span class="hs-comment">{- | Generate stateful properties for all operations that can start sequences.

Creates properties that test CRUD-like sequences starting from each
&quot;creator&quot; operation (typically POSTs). Unlike 'propertiesForSpecWithConfig',
these properties test multiple operations together in sequences.

=== Parameters

* @openApi@ - The full OpenAPI specification
* @config@ - Test configuration with stateful options
* @execute@ - Timeout-aware executor
* @ops@ - List of resolved operations

=== Return Value

Returns a list of tuples where:
* First element: &quot;STATEFUL: &quot; prefix + operation label
* Second element: The stateful 'Property'

=== Example

@
config = defaultTestConfig { tcMaxSequenceLength = 5 }
props = propertiesForSpecStateful spec config httpExecutor ops
-- Returns: [(&quot;STATEFUL: createUser&quot;, ...), (&quot;STATEFUL: createPost&quot;, ...)]
@
-}</span></span><span>
</span><span id="line-551"></span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecStateful"><span class="hs-identifier hs-type">propertiesForSpecStateful</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-552"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-553"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-555"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-556"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-557"></span><span id="propertiesForSpecStateful"><span class="annot"><span class="annottext">propertiesForSpecStateful :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpecStateful"><span class="hs-identifier hs-var hs-var">propertiesForSpecStateful</span></a></span></span><span> </span><span id="local-6989586621679244536"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244536"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244537"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244537"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244538"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244538"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244539"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244539"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;STATEFUL: API Sequences&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyStateful"><span class="hs-identifier hs-var">propertyStateful</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244536"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244537"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244538"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244540"><span class="hs-identifier hs-var">filteredOps</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621679244540"><span class="annot"><span class="annottext">filteredOps :: [ResolvedOperation]
</span><a href="#local-6989586621679244540"><span class="hs-identifier hs-var hs-var">filteredOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcOperationFilter"><span class="hs-identifier hs-var">tcOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244537"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244539"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="annot"><span class="hs-comment">{- | Execute a complete stateful sequence and return the final state.

This function executes each step in the sequence, updating state after
each successful request. It also executes cleanup steps at the end.

=== Parameters

* @openApi@ - OpenAPI spec for auth resolution
* @config@ - Test configuration
* @execute@ - Timeout-aware executor
* @ops@ - Available operations (for looking up by ID)
* @sequence'@ - The sequence to execute

=== Return Value

Returns the final 'TestState' after executing all steps.

=== Side Effects

* Executes HTTP requests via the executor
* May abort with a Hedgehog failure if checks fail
-}</span></span><span>
</span><span id="line-584"></span><span class="annot"><a href="Haskemathesis.Property.html#executeStatefulSequence"><span class="hs-identifier hs-type">executeStatefulSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-585"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-586"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-588"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-589"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationSequence"><span class="hs-identifier hs-type">OperationSequence</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier hs-type">PropertyT</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#TestState"><span class="hs-identifier hs-type">TestState</span></a></span><span>
</span><span id="line-591"></span><span id="executeStatefulSequence"><span class="annot"><span class="annottext">executeStatefulSequence :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; OperationSequence
-&gt; PropertyT IO TestState
</span><a href="Haskemathesis.Property.html#executeStatefulSequence"><span class="hs-identifier hs-var hs-var">executeStatefulSequence</span></a></span></span><span> </span><span id="local-6989586621679244542"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244542"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244543"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244543"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244544"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244544"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244545"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244545"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679244546"><span class="annot"><span class="annottext">OperationSequence
</span><a href="#local-6989586621679244546"><span class="hs-identifier hs-var">sequence'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-comment">-- Execute main steps</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621679244547"><span class="annot"><a href="#local-6989586621679244547"><span class="hs-identifier hs-var">stateAfterMain</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TestState -&gt; SequenceStep -&gt; PropertyT IO TestState)
-&gt; TestState -&gt; [SequenceStep] -&gt; PropertyT IO TestState
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestState
-&gt; SequenceStep
-&gt; PropertyT IO TestState
</span><a href="Haskemathesis.Property.html#executeStatefulStep"><span class="hs-identifier hs-var">executeStatefulStep</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244542"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244543"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244544"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244545"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestState
</span><a href="Haskemathesis.Stateful.Types.html#emptyState"><span class="hs-identifier hs-var">emptyState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OperationSequence -&gt; [SequenceStep]
</span><a href="Haskemathesis.Stateful.Types.html#osSteps"><span class="hs-identifier hs-var">osSteps</span></a></span><span> </span><span class="annot"><span class="annottext">OperationSequence
</span><a href="#local-6989586621679244546"><span class="hs-identifier hs-var">sequence'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span>    </span><span class="hs-comment">-- Execute cleanup steps (even if main steps failed, but we continue after failure)</span><span>
</span><span id="line-596"></span><span>    </span><span class="hs-comment">-- For now, cleanup runs after main steps complete successfully</span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">foldM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Property.html#executeStatefulStep"><span class="hs-identifier hs-type">executeStatefulStep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244542"><span class="hs-identifier hs-type">openApi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244543"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244544"><span class="hs-identifier hs-type">execute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244545"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679244547"><span class="hs-identifier hs-type">stateAfterMain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#osCleanup"><span class="hs-identifier hs-var">osCleanup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244546"><span class="hs-identifier hs-type">sequence'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="annot"><span class="hs-comment">{- | Execute a single step in a stateful sequence.

This function:

1. Looks up the operation by ID
2. Generates a request using state for bound parameters
3. Applies auth and config headers
4. Executes the request
5. Runs standard checks
6. Updates state with extracted values from response

=== Parameters

* @openApi@ - OpenAPI spec for auth resolution
* @config@ - Test configuration
* @execute@ - Timeout-aware executor
* @ops@ - Available operations
* @state@ - Current test state
* @step@ - The step to execute

=== Return Value

Returns the updated 'TestState' after executing the step.

=== Failures

If the operation ID is not found, or if checks fail, the property fails.
-}</span></span><span>
</span><span id="line-627"></span><span class="annot"><a href="Haskemathesis.Property.html#executeStatefulStep"><span class="hs-identifier hs-type">executeStatefulStep</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-628"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-629"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-632"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#TestState"><span class="hs-identifier hs-type">TestState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-633"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#SequenceStep"><span class="hs-identifier hs-type">SequenceStep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-634"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier hs-type">PropertyT</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#TestState"><span class="hs-identifier hs-type">TestState</span></a></span><span>
</span><span id="line-635"></span><span id="executeStatefulStep"><span class="annot"><span class="annottext">executeStatefulStep :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestState
-&gt; SequenceStep
-&gt; PropertyT IO TestState
</span><a href="Haskemathesis.Property.html#executeStatefulStep"><span class="hs-identifier hs-var hs-var">executeStatefulStep</span></a></span></span><span> </span><span id="local-6989586621679244550"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244550"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244551"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244551"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244552"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244552"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244553"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244553"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679244554"><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679244554"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679244555"><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679244555"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-comment">-- Look up the operation</span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244556"><span class="annot"><span class="annottext">opLabel :: Text
</span><a href="#local-6989586621679244556"><span class="hs-identifier hs-var hs-var">opLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SequenceStep -&gt; Text
</span><a href="Haskemathesis.Stateful.Types.html#ssOperationId"><span class="hs-identifier hs-var">ssOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679244555"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [ResolvedOperation] -&gt; Maybe ResolvedOperation
</span><a href="Haskemathesis.Stateful.Sequence.html#findOperationByLabel"><span class="hs-identifier hs-var">findOperationByLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679244556"><span class="hs-identifier hs-var">opLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244553"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-639"></span><span>        </span><span class="annot"><span class="annottext">Maybe ResolvedOperation
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-640"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; String -&gt; m ()
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#footnote"><span class="hs-identifier hs-var">footnote</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PropertyT IO ()) -&gt; String -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Operation not found: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679244556"><span class="hs-identifier hs-var">opLabel</span></a></span><span>
</span><span id="line-641"></span><span>            </span><span class="annot"><span class="annottext">(HasCallStack =&gt; PropertyT IO TestState) -&gt; PropertyT IO TestState
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">withFrozenCallStack</span></span><span> </span><span class="annot"><span class="annottext">PropertyT IO TestState
HasCallStack =&gt; PropertyT IO TestState
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-642"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679244562"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244562"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-643"></span><span>            </span><span class="hs-comment">-- Generate request using state for bound parameters</span><span>
</span><span id="line-644"></span><span>            </span><span id="local-6989586621679244563"><span class="annot"><a href="#local-6989586621679244563"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen ApiRequest -&gt; PropertyT IO ApiRequest
forall (m :: * -&gt; *) a. (Monad m, Show a) =&gt; Gen a -&gt; PropertyT m a
</span><a href="Haskemathesis.Property.html#forAllNoLoc"><span class="hs-identifier hs-var">forAllNoLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestState -&gt; SequenceStep -&gt; ResolvedOperation -&gt; Gen ApiRequest
</span><a href="Haskemathesis.Stateful.Generator.html#genStatefulRequest"><span class="hs-identifier hs-var">genStatefulRequest</span></a></span><span> </span><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679244554"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">SequenceStep
</span><a href="#local-6989586621679244555"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244562"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span>            </span><span class="hs-comment">-- Apply auth and config headers</span><span>
</span><span id="line-647"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244564"><span class="annot"><a href="#local-6989586621679244564"><span class="hs-identifier hs-var hs-var">req'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Property.html#applyConfigToRequest"><span class="hs-identifier hs-var">applyConfigToRequest</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244550"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244551"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244562"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679244563"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span>            </span><span class="hs-comment">-- Execute the request</span><span>
</span><span id="line-650"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244565"><span class="annot"><a href="#local-6989586621679244565"><span class="hs-identifier hs-var hs-var">timeout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Maybe Int
</span><a href="Haskemathesis.Property.html#effectiveTimeout"><span class="hs-identifier hs-var">effectiveTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244551"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244562"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-651"></span><span>            </span><span id="local-6989586621679244566"><span class="annot"><a href="#local-6989586621679244566"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-type">evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244552"><span class="hs-identifier hs-type">execute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244565"><span class="hs-identifier hs-type">timeout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244564"><span class="hs-identifier hs-type">req'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span>            </span><span class="hs-comment">-- Run standard checks</span><span>
</span><span id="line-654"></span><span>            </span><span class="annot"><a href="Haskemathesis.Property.html#runChecks"><span class="hs-identifier hs-type">runChecks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244551"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#tcChecks"><span class="hs-identifier hs-var">tcChecks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244551"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679244564"><span class="hs-identifier hs-type">req'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244566"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244562"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span>            </span><span class="hs-comment">-- Update state with extracted values</span><span>
</span><span id="line-657"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Generator.html#updateState"><span class="hs-identifier hs-type">updateState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244556"><span class="hs-identifier hs-type">opLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244562"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244564"><span class="hs-identifier hs-type">req'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244566"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244554"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="annot"><span class="hs-comment">-- | Internal helper to run stateful checks and report failures.</span></span><span>
</span><span id="line-660"></span><span class="annot"><a href="Haskemathesis.Property.html#runStatefulChecksProperty"><span class="hs-identifier hs-type">runStatefulChecksProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-661"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-664"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#TestState"><span class="hs-identifier hs-type">TestState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-665"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier hs-type">PropertyT</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span id="runStatefulChecksProperty"><span class="annot"><span class="annottext">runStatefulChecksProperty :: TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestState
-&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#runStatefulChecksProperty"><span class="hs-identifier hs-var hs-var">runStatefulChecksProperty</span></a></span></span><span> </span><span id="local-6989586621679244567"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244567"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244568"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244568"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244569"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244569"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679244570"><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679244570"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244571"><span class="annot"><span class="annottext">checks :: [StatefulCheck]
</span><a href="#local-6989586621679244571"><span class="hs-identifier hs-var hs-var hs-var">checks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; [StatefulCheck]
</span><a href="Haskemathesis.Config.html#tcStatefulChecks"><span class="hs-identifier hs-var">tcStatefulChecks</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244567"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-668"></span><span>    </span><span id="local-6989586621679244573"><span class="annot"><a href="#local-6989586621679244573"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [StatefulCheckResult] -&gt; PropertyT IO [StatefulCheckResult]
forall (m :: * -&gt; *) a.
(MonadTest m, MonadIO m, HasCallStack) =&gt;
IO a -&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-var">evalIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [StatefulCheckResult] -&gt; PropertyT IO [StatefulCheckResult])
-&gt; IO [StatefulCheckResult] -&gt; PropertyT IO [StatefulCheckResult]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestState
-&gt; [StatefulCheck]
-&gt; IO [StatefulCheckResult]
</span><a href="Haskemathesis.Stateful.Checks.html#runStatefulChecks"><span class="hs-identifier hs-var">runStatefulChecks</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244568"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244569"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679244570"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">[StatefulCheck]
</span><a href="#local-6989586621679244571"><span class="hs-identifier hs-var">checks</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">filter</span></span><span> </span><span class="annot"><a href="Haskemathesis.Property.html#isStatefulFailure"><span class="hs-identifier hs-type">isStatefulFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244573"><span class="hs-identifier hs-type">results</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-670"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-671"></span><span>        </span><span id="local-6989586621679244574"><span class="annot"><span class="annottext">[StatefulCheckResult]
</span><a href="#local-6989586621679244574"><span class="hs-identifier hs-var">failures</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-672"></span><span>            </span><span class="hs-comment">-- Report all failures</span><span>
</span><span id="line-673"></span><span>            </span><span class="annot"><span class="annottext">(StatefulCheckResult -&gt; PropertyT IO ())
-&gt; [StatefulCheckResult] -&gt; PropertyT IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">StatefulCheckResult -&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#reportStatefulFailure"><span class="hs-identifier hs-var">reportStatefulFailure</span></a></span><span> </span><span class="annot"><span class="annottext">[StatefulCheckResult]
</span><a href="#local-6989586621679244574"><span class="hs-identifier hs-var">failures</span></a></span><span>
</span><span id="line-674"></span><span>            </span><span class="annot"><span class="annottext">(HasCallStack =&gt; PropertyT IO ()) -&gt; PropertyT IO ()
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">withFrozenCallStack</span></span><span> </span><span class="annot"><span class="annottext">PropertyT IO ()
HasCallStack =&gt; PropertyT IO ()
forall (m :: * -&gt; *) a. (MonadTest m, HasCallStack) =&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="annot"><span class="hs-comment">-- | Check if a stateful check result is a failure.</span></span><span>
</span><span id="line-677"></span><span class="annot"><a href="Haskemathesis.Property.html#isStatefulFailure"><span class="hs-identifier hs-type">isStatefulFailure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#StatefulCheckResult"><span class="hs-identifier hs-type">StatefulCheckResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-678"></span><span id="isStatefulFailure"><span class="annot"><span class="annottext">isStatefulFailure :: StatefulCheckResult -&gt; Bool
</span><a href="Haskemathesis.Property.html#isStatefulFailure"><span class="hs-identifier hs-var hs-var">isStatefulFailure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#StatefulCheckFailed"><span class="hs-identifier hs-type">StatefulCheckFailed</span></a></span><span> </span><span class="annot"><span class="annottext">StatefulFailure
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-679"></span><span class="annot"><a href="Haskemathesis.Property.html#isStatefulFailure"><span class="hs-identifier hs-var">isStatefulFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#StatefulCheckPassed"><span class="hs-identifier hs-type">StatefulCheckPassed</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe ResourceRef
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span class="annot"><span class="hs-comment">-- | Report a stateful check failure.</span></span><span>
</span><span id="line-682"></span><span class="annot"><a href="Haskemathesis.Property.html#reportStatefulFailure"><span class="hs-identifier hs-type">reportStatefulFailure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#StatefulCheckResult"><span class="hs-identifier hs-type">StatefulCheckResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier hs-type">PropertyT</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span id="reportStatefulFailure"><span class="annot"><span class="annottext">reportStatefulFailure :: StatefulCheckResult -&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#reportStatefulFailure"><span class="hs-identifier hs-var hs-var">reportStatefulFailure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#StatefulCheckPassed"><span class="hs-identifier hs-type">StatefulCheckPassed</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe ResourceRef
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; PropertyT IO ()
forall a. a -&gt; PropertyT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span class="annot"><a href="Haskemathesis.Property.html#reportStatefulFailure"><span class="hs-identifier hs-var">reportStatefulFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#StatefulCheckFailed"><span class="hs-identifier hs-type">StatefulCheckFailed</span></a></span><span> </span><span id="local-6989586621679244583"><span class="annot"><span class="annottext">StatefulFailure
</span><a href="#local-6989586621679244583"><span class="hs-identifier hs-var">sf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-685"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; String -&gt; m ()
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#footnote"><span class="hs-identifier hs-var">footnote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StatefulFailure -&gt; Text
</span><a href="Haskemathesis.Property.html#renderStatefulFailure"><span class="hs-identifier hs-var">renderStatefulFailure</span></a></span><span> </span><span class="annot"><span class="annottext">StatefulFailure
</span><a href="#local-6989586621679244583"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span class="annot"><span class="hs-comment">-- | Render a stateful failure as human-readable text.</span></span><span>
</span><span id="line-688"></span><span class="annot"><a href="Haskemathesis.Property.html#renderStatefulFailure"><span class="hs-identifier hs-type">renderStatefulFailure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Checks.html#StatefulFailure"><span class="hs-identifier hs-type">StatefulFailure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-689"></span><span id="renderStatefulFailure"><span class="annot"><span class="annottext">renderStatefulFailure :: StatefulFailure -&gt; Text
</span><a href="Haskemathesis.Property.html#renderStatefulFailure"><span class="hs-identifier hs-var hs-var">renderStatefulFailure</span></a></span></span><span> </span><span id="local-6989586621679244584"><span class="annot"><span class="annottext">StatefulFailure
</span><a href="#local-6989586621679244584"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-690"></span><span>    </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unlines</span></span><span>
</span><span id="line-691"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Stateful Check Failed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StatefulFailure -&gt; Text
</span><a href="Haskemathesis.Stateful.Checks.html#sfCheckName"><span class="hs-identifier hs-var">sfCheckName</span></a></span><span> </span><span class="annot"><span class="annottext">StatefulFailure
</span><a href="#local-6989586621679244584"><span class="hs-identifier hs-var">sf</span></a></span><span>
</span><span id="line-692"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Message: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StatefulFailure -&gt; Text
</span><a href="Haskemathesis.Stateful.Checks.html#sfMessage"><span class="hs-identifier hs-var">sfMessage</span></a></span><span> </span><span class="annot"><span class="annottext">StatefulFailure
</span><a href="#local-6989586621679244584"><span class="hs-identifier hs-var">sf</span></a></span><span>
</span><span id="line-693"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Resource: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;N/A&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (Text -&gt; String) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StatefulFailure -&gt; Maybe ApiRequest
</span><a href="Haskemathesis.Stateful.Checks.html#sfVerificationRequest"><span class="hs-identifier hs-var">sfVerificationRequest</span></a></span><span> </span><span class="annot"><span class="annottext">StatefulFailure
</span><a href="#local-6989586621679244584"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ApiRequest -&gt; (ApiRequest -&gt; Maybe Text) -&gt; Maybe Text
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text)
-&gt; (ApiRequest -&gt; Text) -&gt; ApiRequest -&gt; Maybe Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ApiRequest -&gt; Text
</span><a href="Haskemathesis.Execute.Types.html#reqPath"><span class="hs-identifier hs-var">reqPath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StatefulFailure -&gt; Maybe Int
</span><a href="Haskemathesis.Stateful.Checks.html#sfExpectedStatus"><span class="hs-identifier hs-var">sfExpectedStatus</span></a></span><span> </span><span class="annot"><span class="annottext">StatefulFailure
</span><a href="#local-6989586621679244584"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StatefulFailure -&gt; Maybe Int
</span><a href="Haskemathesis.Stateful.Checks.html#sfActualStatus"><span class="hs-identifier hs-var">sfActualStatus</span></a></span><span> </span><span class="annot"><span class="annottext">StatefulFailure
</span><a href="#local-6989586621679244584"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-695"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679244595"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244595"><span class="hs-identifier hs-var">expected</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679244596"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244596"><span class="hs-identifier hs-var">actual</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-696"></span><span>                </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Expected status: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244595"><span class="hs-identifier hs-var">expected</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;, Actual: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244596"><span class="hs-identifier hs-var">actual</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679244597"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244597"><span class="hs-identifier hs-var">actual</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-698"></span><span>                </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Actual status: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244597"><span class="hs-identifier hs-var">actual</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679244598"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244598"><span class="hs-identifier hs-var">expected</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-700"></span><span>                </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Expected status: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244598"><span class="hs-identifier hs-var">expected</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-702"></span><span>                </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-703"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-704"></span></pre></body></html>