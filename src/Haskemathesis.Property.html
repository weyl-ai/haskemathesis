<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | High-level property generation for resolved operations and specs.

This module provides the main entry points for generating Hedgehog properties
from OpenAPI specifications. Properties can be generated for individual
operations or entire specs, with various configuration options.

=== Basic Usage

Generate properties for all operations in a spec:

@
import Haskemathesis.OpenApi.Loader (loadOpenApiFile)
import Haskemathesis.OpenApi.Resolve (resolveOperations)
import Haskemathesis.Property (propertiesForSpec)
import Haskemathesis.Check.Standard (defaultChecks)

main :: IO ()
main = do
    Right spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let ops = resolveOperations spec
        props = propertiesForSpec Nothing defaultChecks myExecutor ops
    -- Run properties with your favorite test framework
@

=== Configuration

For more control, use 'propertiesForSpecWithConfig':

@
import Haskemathesis.Config

myConfig :: TestConfig
myConfig = defaultTestConfig
    { tcPropertyCount = 200
    , tcNegativeTesting = True
    , tcOperationFilter = filterByTag &quot;public&quot;
    }
@
-}</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html"><span class="hs-identifier">Haskemathesis.Property</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Single Operation Properties</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier">propertyForOperation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier">propertyForOperationWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationNegative"><span class="hs-identifier">propertyForOperationNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Spec-Level Properties</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpec"><span class="hs-identifier">propertiesForSpec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier">propertiesForSpecWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecNegative"><span class="hs-identifier">propertiesForSpecNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.html"><span class="hs-identifier">Data.OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier">OpenApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html"><span class="hs-identifier">Haskemathesis.Auth.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Auth.Config.html#applyAuthForOperation"><span class="hs-identifier">applyAuthForOperation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Negative.html"><span class="hs-identifier">Haskemathesis.Check.Negative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Negative.html#negativeTestRejection"><span class="hs-identifier">negativeTestRejection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html"><span class="hs-identifier">Haskemathesis.Check.Standard.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier">operationLabel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html"><span class="hs-identifier">Haskemathesis.Check.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier">Check</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#CheckResult"><span class="hs-identifier">CheckResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#FailureDetail"><span class="hs-identifier">FailureDetail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html"><span class="hs-identifier">Haskemathesis.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier">TestConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html"><span class="hs-identifier">Haskemathesis.Execute.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier">ApiRequest</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier">ApiResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier">BaseUrl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Negative.html"><span class="hs-identifier">Haskemathesis.Gen.Negative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Gen.Negative.html#genNegativeRequest"><span class="hs-identifier">genNegativeRequest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Negative.Types.html#renderNegativeMutation"><span class="hs-identifier">renderNegativeMutation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Request.html"><span class="hs-identifier">Haskemathesis.Gen.Request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Gen.Request.html#genApiRequest"><span class="hs-identifier">genApiRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html"><span class="hs-identifier">Haskemathesis.OpenApi.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier">ResolvedOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Report.Render.html"><span class="hs-identifier">Haskemathesis.Report.Render</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Report.Render.html#renderFailureDetailAnsi"><span class="hs-identifier">renderFailureDetailAnsi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier">Property</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#annotate"><span class="hs-identifier">annotate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier">evalIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier">failure</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier">forAll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier">property</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier">success</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier">withTests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html"><span class="hs-identifier">Hedgehog.Internal.Property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier">PropertyT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookupEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><span class="hs-comment">{- | Generate a Hedgehog property for a single operation using basic configuration.

This is the simplest way to create a property for an operation. The property
will generate random requests based on the OpenAPI schema and execute them
against your API, then run the provided checks on the response.

=== Parameters

* @mBase@ - Optional base URL for rendering failure reports (can be 'Nothing')
* @checks@ - List of 'Check' functions to validate responses
* @execute@ - Function to execute an 'ApiRequest' and return an 'ApiResponse'
* @op@ - The 'ResolvedOperation' to generate tests for

=== Example

@
let prop = propertyForOperation (Just &quot;http://localhost:8080&quot;) checks httpExecutor myOperation
@
-}</span></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier hs-type">propertyForOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-97"></span><span id="propertyForOperation"><span class="annot"><span class="annottext">propertyForOperation :: Maybe Text
-&gt; [Check]
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier hs-var hs-var">propertyForOperation</span></a></span></span><span> </span><span id="local-6989586621679222392"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679222392"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679222393"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679222393"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679222394"><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679222394"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679222395"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222395"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-99"></span><span>        </span><span id="local-6989586621679222396"><span class="annot"><a href="#local-6989586621679222396"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen ApiRequest -&gt; PropertyT IO ApiRequest
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Gen ApiRequest
</span><a href="Haskemathesis.Gen.Request.html#genApiRequest"><span class="hs-identifier hs-var">genApiRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222395"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>        </span><span id="local-6989586621679222397"><span class="annot"><a href="#local-6989586621679222397"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-type">evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679222394"><span class="hs-identifier hs-type">execute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222396"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><a href="Haskemathesis.Property.html#runChecks"><span class="hs-identifier hs-type">runChecks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222392"><span class="hs-identifier hs-type">mBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222393"><span class="hs-identifier hs-type">checks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222396"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222397"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222395"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><span class="hs-comment">{- | Generate a property with full configuration support including authentication.

This function provides more control than 'propertyForOperation' by accepting
a 'TestConfig' record. It supports:

* Authentication via 'tcAuthConfig'
* Custom property counts via 'tcPropertyCount'
* Operation filtering via 'tcOperationFilter'

=== Parameters

* @openApi@ - The full OpenAPI specification (needed for auth resolution)
* @config@ - The 'TestConfig' controlling test generation
* @execute@ - Function to execute requests
* @op@ - The operation to test

=== Example

@
config = defaultTestConfig { tcPropertyCount = 200 }
prop = propertyForOperationWithConfig spec config httpExecutor myOperation
@
-}</span></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier hs-type">propertyForOperationWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-132"></span><span id="propertyForOperationWithConfig"><span class="annot"><span class="annottext">propertyForOperationWithConfig :: OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier hs-var hs-var">propertyForOperationWithConfig</span></a></span></span><span> </span><span id="local-6989586621679222403"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222403"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679222404"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222404"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679222405"><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679222405"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679222406"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222406"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestLimit
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig -&gt; Int
</span><a href="Haskemathesis.Config.html#tcPropertyCount"><span class="hs-identifier hs-var">tcPropertyCount</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222404"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-135"></span><span>            </span><span id="local-6989586621679222407"><span class="annot"><a href="#local-6989586621679222407"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen ApiRequest -&gt; PropertyT IO ApiRequest
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Gen ApiRequest
</span><a href="Haskemathesis.Gen.Request.html#genApiRequest"><span class="hs-identifier hs-var">genApiRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222406"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679222408"><span class="annot"><a href="#local-6989586621679222408"><span class="hs-identifier hs-var hs-var">req'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Property.html#applyConfigToRequest"><span class="hs-identifier hs-var">applyConfigToRequest</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222403"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222404"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222406"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222407"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-137"></span><span>            </span><span id="local-6989586621679222410"><span class="annot"><a href="#local-6989586621679222410"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-type">evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679222405"><span class="hs-identifier hs-type">execute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222408"><span class="hs-identifier hs-type">req'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>            </span><span class="annot"><a href="Haskemathesis.Property.html#runChecks"><span class="hs-identifier hs-type">runChecks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222404"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#tcChecks"><span class="hs-identifier hs-var">tcChecks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222404"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679222408"><span class="hs-identifier hs-type">req'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222410"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222406"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><span class="hs-comment">{- | Generate a negative testing property for an operation.

Negative testing generates /invalid/ requests to verify that the API
properly rejects malformed input. This property generates mutations
that violate the OpenAPI schema (e.g., missing required fields,
wrong content types, invalid values) and verifies the API rejects them.

=== When to Use

Use this when you want to verify your API's error handling and
input validation. The API should return 4xx status codes for
these invalid requests.

=== Parameters

* @openApi@ - The full OpenAPI specification
* @config@ - The 'TestConfig' (negative testing is enabled separately)
* @execute@ - Function to execute requests
* @op@ - The operation to test

=== Example

@
config = defaultTestConfig { tcPropertyCount = 50 }
negProp = propertyForOperationNegative spec config httpExecutor myOperation
@
-}</span></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationNegative"><span class="hs-identifier hs-type">propertyForOperationNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-173"></span><span id="propertyForOperationNegative"><span class="annot"><span class="annottext">propertyForOperationNegative :: OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationNegative"><span class="hs-identifier hs-var hs-var">propertyForOperationNegative</span></a></span></span><span> </span><span id="local-6989586621679222413"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222413"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679222414"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222414"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679222415"><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679222415"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679222416"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222416"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestLimit
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig -&gt; Int
</span><a href="Haskemathesis.Config.html#tcPropertyCount"><span class="hs-identifier hs-var">tcPropertyCount</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222414"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-176"></span><span>            </span><span id="local-6989586621679222417"><span class="annot"><a href="#local-6989586621679222417"><span class="hs-identifier hs-var">mReq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Maybe (ApiRequest, NegativeMutation))
-&gt; PropertyT IO (Maybe (ApiRequest, NegativeMutation))
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Gen (Maybe (ApiRequest, NegativeMutation))
</span><a href="Haskemathesis.Gen.Negative.html#genNegativeRequest"><span class="hs-identifier hs-var">genNegativeRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222416"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679222417"><span class="hs-identifier hs-type">mReq</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-178"></span><span>                </span><span class="annot"><span class="annottext">Maybe (ApiRequest, NegativeMutation)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-179"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679222418"><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222418"><span class="hs-identifier hs-var">req</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679222419"><span class="annot"><span class="annottext">NegativeMutation
</span><a href="#local-6989586621679222419"><span class="hs-identifier hs-var">mutation</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679222420"><span class="annot"><span class="annottext">req' :: ApiRequest
</span><a href="#local-6989586621679222420"><span class="hs-identifier hs-var hs-var hs-var">req'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Property.html#applyConfigToRequest"><span class="hs-identifier hs-var">applyConfigToRequest</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222413"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222414"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222416"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222418"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-181"></span><span>                    </span><span id="local-6989586621679222421"><span class="annot"><a href="#local-6989586621679222421"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ApiResponse -&gt; PropertyT IO ApiResponse
forall (m :: * -&gt; *) a.
(MonadTest m, MonadIO m, HasCallStack) =&gt;
IO a -&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-var">evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679222415"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222420"><span class="hs-identifier hs-var">req'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Negative.html#negativeTestRejection"><span class="hs-identifier hs-type">negativeTestRejection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Gen.Negative.Types.html#renderNegativeMutation"><span class="hs-identifier hs-type">renderNegativeMutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222419"><span class="hs-identifier hs-type">mutation</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679222420"><span class="hs-identifier hs-type">req'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222421"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222416"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-183"></span><span>                        </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Haskemathesis.Check.Types.html#CheckPassed"><span class="hs-identifier hs-var">CheckPassed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-184"></span><span>                        </span><span class="annot"><a href="Haskemathesis.Check.Types.html#CheckFailed"><span class="hs-identifier hs-type">CheckFailed</span></a></span><span> </span><span id="local-6989586621679222424"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679222424"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; FailureDetail -&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#reportFailure"><span class="hs-identifier hs-var">reportFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig -&gt; Maybe Text
</span><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222414"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679222424"><span class="hs-identifier hs-var">detail</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><span class="hs-comment">{- | Generate properties for all operations in a spec using basic configuration.

This is the simplest way to generate a complete test suite from an
OpenAPI specification. It creates a list of named properties, one
for each resolved operation.

=== Return Value

Returns a list of tuples where:
* First element: A descriptive label (operation ID or method+path)
* Second element: The Hedgehog 'Property' for testing that operation

=== Parameters

* @mBase@ - Optional base URL for rendering failure reports
* @checks@ - List of 'Check' functions to validate responses
* @execute@ - Function to execute requests
* @ops@ - List of resolved operations (from 'resolveOperations')

=== Example

@
main :: IO ()
main = do
    Right spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let ops = resolveOperations spec
        props = propertiesForSpec Nothing defaultChecks httpExecutor ops
    -- Run with your test framework
@
-}</span></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpec"><span class="hs-identifier hs-type">propertiesForSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span id="propertiesForSpec"><span class="annot"><span class="annottext">propertiesForSpec :: Maybe Text
-&gt; [Check]
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpec"><span class="hs-identifier hs-var hs-var">propertiesForSpec</span></a></span></span><span> </span><span id="local-6989586621679222426"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679222426"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679222427"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679222427"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679222428"><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679222428"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679222429"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679222429"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222430"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
-&gt; [Check]
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier hs-var">propertyForOperation</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679222426"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679222427"><span class="hs-identifier hs-var">checks</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679222428"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222430"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679222430"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222430"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679222429"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><span class="hs-comment">{- | Generate properties with full configuration support.

This function provides the most flexibility for generating properties.
It supports authentication, operation filtering, custom check sets,
and can generate both positive and negative test cases.

=== Negative Testing

When 'tcNegativeTesting' is 'True', this function generates both
normal properties and negative testing properties (prefixed with
&quot;NEGATIVE:&quot;). Negative tests verify that the API properly rejects
invalid requests.

=== Operation Filtering

Only operations that satisfy 'tcOperationFilter' will have properties
generated. This is useful for testing subsets of your API.

=== Parameters

* @openApi@ - The full OpenAPI specification (needed for auth resolution)
* @config@ - The 'TestConfig' controlling all aspects of generation
* @execute@ - Function to execute requests
* @ops@ - List of resolved operations

=== Example

@
config = defaultTestConfig
    { tcPropertyCount = 200
    , tcNegativeTesting = True
    , tcOperationFilter = filterByTag &quot;public&quot;
    }
props = propertiesForSpecWithConfig spec config httpExecutor ops
@
-}</span></span><span>
</span><span id="line-263"></span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier hs-type">propertiesForSpecWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span id="propertiesForSpecWithConfig"><span class="annot"><span class="annottext">propertiesForSpecWithConfig :: OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier hs-var hs-var">propertiesForSpecWithConfig</span></a></span></span><span> </span><span id="local-6989586621679222432"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222432"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679222433"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222433"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679222434"><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679222434"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679222435"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679222435"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><span class="annottext">[(Text, Property)]
</span><a href="#local-6989586621679222436"><span class="hs-identifier hs-var">normalProps</span></a></span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="annottext">[(Text, Property)] -&gt; [(Text, Property)] -&gt; [(Text, Property)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcNegativeTesting"><span class="hs-identifier hs-var">tcNegativeTesting</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222433"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-272"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(Text, Property)]
</span><a href="#local-6989586621679222437"><span class="hs-identifier hs-var">negativeProps</span></a></span><span>
</span><span id="line-273"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621679222436"><span class="annot"><span class="annottext">normalProps :: [(Text, Property)]
</span><a href="#local-6989586621679222436"><span class="hs-identifier hs-var hs-var">normalProps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222438"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier hs-var">propertyForOperationWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222432"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222433"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679222434"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222438"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679222438"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222438"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679222435"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcOperationFilter"><span class="hs-identifier hs-var">tcOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222433"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222438"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-279"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679222437"><span class="annot"><span class="annottext">negativeProps :: [(Text, Property)]
</span><a href="#local-6989586621679222437"><span class="hs-identifier hs-var hs-var">negativeProps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;NEGATIVE: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222443"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationNegative"><span class="hs-identifier hs-var">propertyForOperationNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222432"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222433"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679222434"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222443"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679222443"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222443"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679222435"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcOperationFilter"><span class="hs-identifier hs-var">tcOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222433"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222443"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-284"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><span class="hs-comment">{- | Generate only negative testing properties.

This is a convenience function that generates only negative test properties
for all operations. Negative tests verify that the API properly rejects
invalid requests (mutations that violate the OpenAPI schema).

=== Use Cases

* Testing input validation and error handling
* Verifying security controls reject malformed requests
* Dedicated negative testing suites

=== Parameters

* @openApi@ - The full OpenAPI specification
* @config@ - The 'TestConfig' (negative testing flag is ignored, always enabled)
* @execute@ - Function to execute requests
* @ops@ - List of resolved operations

=== Example

@
-- Dedicated negative testing suite
negativeProps = propertiesForSpecNegative spec defaultConfig httpExecutor ops
@
-}</span></span><span>
</span><span id="line-312"></span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecNegative"><span class="hs-identifier hs-type">propertiesForSpecNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-318"></span><span id="propertiesForSpecNegative"><span class="annot"><span class="annottext">propertiesForSpecNegative :: OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpecNegative"><span class="hs-identifier hs-var hs-var">propertiesForSpecNegative</span></a></span></span><span> </span><span id="local-6989586621679222444"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222444"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679222445"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222445"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier hs-var">propertiesForSpecWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222444"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222445"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcNegativeTesting"><span class="hs-identifier hs-var">tcNegativeTesting</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><span class="hs-comment">-- | Internal helper to apply auth and config headers to a request.</span></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Haskemathesis.Property.html#applyConfigToRequest"><span class="hs-identifier hs-type">applyConfigToRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span>
</span><span id="line-323"></span><span id="applyConfigToRequest"><span class="annot"><span class="annottext">applyConfigToRequest :: OpenApi
-&gt; TestConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Property.html#applyConfigToRequest"><span class="hs-identifier hs-var hs-var">applyConfigToRequest</span></a></span></span><span> </span><span id="local-6989586621679222446"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222446"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679222447"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222447"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679222448"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222448"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679222449"><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222449"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679222450"><span class="annot"><span class="annottext">reqAuth :: ApiRequest
</span><a href="#local-6989586621679222450"><span class="hs-identifier hs-var hs-var">reqAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; Maybe AuthConfig
</span><a href="Haskemathesis.Config.html#tcAuthConfig"><span class="hs-identifier hs-var">tcAuthConfig</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679222447"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>            </span><span class="annot"><span class="annottext">Maybe AuthConfig
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222449"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-326"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679222451"><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679222451"><span class="hs-identifier hs-var">auth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; AuthConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Auth.Config.html#applyAuthForOperation"><span class="hs-identifier hs-var">applyAuthForOperation</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679222446"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679222451"><span class="hs-identifier hs-var">auth</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222448"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222449"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-327"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222450"><span class="hs-identifier hs-var">reqAuth</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqHeaders"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html#tcHeaders"><span class="hs-identifier hs-var">tcHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222447"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqHeaders"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222450"><span class="hs-identifier hs-type">reqAuth</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><span class="hs-comment">-- | Internal helper to report a failure with seed and details.</span></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Haskemathesis.Property.html#reportFailure"><span class="hs-identifier hs-type">reportFailure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#FailureDetail"><span class="hs-identifier hs-type">FailureDetail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier hs-type">PropertyT</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span id="reportFailure"><span class="annot"><span class="annottext">reportFailure :: Maybe Text -&gt; FailureDetail -&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#reportFailure"><span class="hs-identifier hs-var hs-var">reportFailure</span></a></span></span><span> </span><span id="local-6989586621679222454"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679222454"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679222455"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679222455"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679222456"><span class="annot"><a href="#local-6989586621679222456"><span class="hs-identifier hs-var">mSeed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe String) -&gt; PropertyT IO (Maybe String)
forall (m :: * -&gt; *) a.
(MonadTest m, MonadIO m, HasCallStack) =&gt;
IO a -&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#evalIO"><span class="hs-identifier hs-var">evalIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO (Maybe String)
</span><span class="hs-identifier hs-var">lookupEnv</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HEDGEHOG_SEED&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679222459"><span class="annot"><a href="#local-6989586621679222459"><span class="hs-identifier hs-var hs-var">seedText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; Maybe String -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679222456"><span class="hs-identifier hs-var">mSeed</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#annotate"><span class="hs-identifier hs-type">annotate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Report.Render.html#renderFailureDetailAnsi"><span class="hs-identifier hs-type">renderFailureDetailAnsi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222454"><span class="hs-identifier hs-type">mBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222459"><span class="hs-identifier hs-type">seedText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679222455"><span class="hs-identifier hs-type">detail</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#failure"><span class="hs-identifier hs-type">failure</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="annot"><span class="hs-comment">-- | Internal helper to run all checks and report first failure.</span></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Haskemathesis.Property.html#runChecks"><span class="hs-identifier hs-type">runChecks</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyT"><span class="hs-identifier hs-type">PropertyT</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span id="runChecks"><span class="annot"><span class="annottext">runChecks :: Maybe Text
-&gt; [Check]
-&gt; ApiRequest
-&gt; ApiResponse
-&gt; ResolvedOperation
-&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#runChecks"><span class="hs-identifier hs-var hs-var">runChecks</span></a></span></span><span> </span><span id="local-6989586621679222463"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679222463"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679222464"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679222464"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679222465"><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222465"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679222466"><span class="annot"><span class="annottext">ApiResponse
</span><a href="#local-6989586621679222466"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621679222467"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222467"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FailureDetail
</span><a href="#local-6989586621679222468"><span class="hs-identifier hs-var">firstFailure</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="annottext">Maybe FailureDetail
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679222469"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679222469"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; FailureDetail -&gt; PropertyT IO ()
</span><a href="Haskemathesis.Property.html#reportFailure"><span class="hs-identifier hs-var">reportFailure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679222463"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679222469"><span class="hs-identifier hs-var">detail</span></a></span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621679222468"><span class="annot"><span class="annottext">firstFailure :: Maybe FailureDetail
</span><a href="#local-6989586621679222468"><span class="hs-identifier hs-var hs-var">firstFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-351"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679222470"><span class="hs-identifier hs-var">detail</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">checkRun :: Check
-&gt; ApiRequest -&gt; ApiResponse -&gt; ResolvedOperation -&gt; CheckResult
</span><a href="Haskemathesis.Check.Types.html#checkRun"><span class="hs-identifier hs-var">checkRun</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679222472"><span class="annot"><span class="annottext">ApiRequest -&gt; ApiResponse -&gt; ResolvedOperation -&gt; CheckResult
</span><a href="#local-6989586621679222472"><span class="hs-identifier hs-var">run</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679222464"><span class="hs-identifier hs-var">checks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#CheckFailed"><span class="hs-identifier hs-type">CheckFailed</span></a></span><span> </span><span id="local-6989586621679222470"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679222470"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ApiRequest -&gt; ApiResponse -&gt; ResolvedOperation -&gt; CheckResult
</span><a href="#local-6989586621679222472"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679222465"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">ApiResponse
</span><a href="#local-6989586621679222466"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679222467"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FailureDetail
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-353"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679222473"><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679222473"><span class="hs-identifier hs-var">detail</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[FailureDetail]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FailureDetail -&gt; Maybe FailureDetail
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FailureDetail
</span><a href="#local-6989586621679222473"><span class="hs-identifier hs-var">detail</span></a></span><span>
</span><span id="line-354"></span></pre></body></html>