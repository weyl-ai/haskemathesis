<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">{- | Pure regex pattern to string generator.

This module generates strings that match a given regular expression pattern,
without requiring external SMT solvers. It uses the LogicT monad for
backtracking enumeration of possible matches.

Adapted from regex-genex (Audrey Tang, Public Domain/CC0).

=== Supported Features

* Character classes: @[abc]@, @[^abc]@, @[a-z]@
* Predefined classes: @\\d@, @\\w@, @\\s@, @\\D@, @\\W@, @\\S@
* Quantifiers: @*@, @+@, @?@, @{n}@, @{n,m}@
* Alternation: @a|b@
* Grouping: @(abc)@
* Escapes: @\\n@, @\\t@, @\\r@, @\\.@ etc.
* Anchors: @^@, @$@ (treated as zero-width, always match)
* Dot: @.@ (matches printable ASCII)

=== Limitations

* No support for backreferences (@\\1@, @\\2@, etc.)
* No support for word boundaries (@\\b@)
* No support for lookahead/lookbehind
* No Unicode character classes
* @*@ and @+@ are bounded to prevent infinite generation

=== Example

@
import Haskemathesis.Gen.Pattern (genFromPattern)
import Hedgehog (Gen)

emailPatternGen :: Gen Text
emailPatternGen = genFromPattern &quot;[a-z]+@[a-z]+\\.[a-z]{2,4}&quot;
@
-}</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html"><span class="hs-identifier">Haskemathesis.Gen.Pattern</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#genFromPattern"><span class="hs-identifier">genFromPattern</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#genFromPatternWithLength"><span class="hs-identifier">genFromPatternWithLength</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#generateMatchesFromText"><span class="hs-identifier">generateMatchesFromText</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#generateMatches"><span class="hs-identifier">generateMatches</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#parsePattern"><span class="hs-identifier">parsePattern</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Alternative</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">replicateM</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/gd46jpdjb4hqk1q0xmqi02gbpv1x1cr7-logict-0.8.2.0-doc/share/doc/logict-0.8.2.0/html/src/Control.Monad.Logic.html"><span class="hs-identifier">Control.Monad.Logic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/gd46jpdjb4hqk1q0xmqi02gbpv1x1cr7-logict-0.8.2.0-doc/share/doc/logict-0.8.2.0/html/src/Control.Monad.Logic.html#Logic"><span class="hs-identifier">Logic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/gd46jpdjb4hqk1q0xmqi02gbpv1x1cr7-logict-0.8.2.0-doc/share/doc/logict-0.8.2.0/html/src/Control.Monad.Logic.html#observeMany"><span class="hs-identifier">observeMany</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html"><span class="hs-identifier">Text.Regex.TDFA.Pattern</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier">Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier">PatternSet</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.ReadRegex.html"><span class="hs-identifier">Text.Regex.TDFA.ReadRegex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.ReadRegex.html#parseRegex"><span class="hs-identifier">parseRegex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier">Gen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Gen.html"><span class="hs-identifier">Hedgehog.Gen</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gen</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><span class="hs-comment">-- | Maximum number of repetitions for unbounded quantifiers (* and +)</span></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#maxRepeat"><span class="hs-identifier hs-type">maxRepeat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-65"></span><span id="maxRepeat"><span class="annot"><span class="annottext">maxRepeat :: Int
</span><a href="Haskemathesis.Gen.Pattern.html#maxRepeat"><span class="hs-identifier hs-var hs-var">maxRepeat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="annot"><span class="hs-comment">{- | Generate a Hedgehog generator for strings matching a regex pattern.

The generator picks uniformly from a set of possible matches.
For unbounded patterns, only a limited set is generated.

Returns 'Nothing' if the pattern cannot be parsed.
-}</span></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#genFromPattern"><span class="hs-identifier hs-type">genFromPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span id="genFromPattern"><span class="annot"><span class="annottext">genFromPattern :: Text -&gt; Maybe (Gen Text)
</span><a href="Haskemathesis.Gen.Pattern.html#genFromPattern"><span class="hs-identifier hs-var hs-var">genFromPattern</span></a></span></span><span> </span><span id="local-6989586621679237395"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237395"><span class="hs-identifier hs-var">patternText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#parsePattern"><span class="hs-identifier hs-var">parsePattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237395"><span class="hs-identifier hs-var">patternText</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679237397"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679237397"><span class="hs-identifier hs-var">_err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Gen Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679237398"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237398"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-79"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237399"><span class="annot"><span class="annottext">matches :: [Text]
</span><a href="#local-6989586621679237399"><span class="hs-identifier hs-var hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Text]
</span><a href="Haskemathesis.Gen.Pattern.html#generateMatches"><span class="hs-identifier hs-var">generateMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237398"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-80"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679237399"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-81"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Gen Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-82"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Gen Text -&gt; Maybe (Gen Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Gen Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, MonadGen m) =&gt;
f a -&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#element"><span class="hs-identifier hs-var">Gen.element</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679237399"><span class="hs-identifier hs-var">matches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><span class="hs-comment">{- | Generate a Hedgehog generator for strings matching a regex pattern,
with optional length constraints.

Returns 'Nothing' if the pattern cannot be parsed or no matches satisfy
the length constraints.
-}</span></span><span>
</span><span id="line-90"></span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#genFromPatternWithLength"><span class="hs-identifier hs-type">genFromPatternWithLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span id="genFromPatternWithLength"><span class="annot"><span class="annottext">genFromPatternWithLength :: Text -&gt; Maybe Int -&gt; Maybe Int -&gt; Maybe (Gen Text)
</span><a href="Haskemathesis.Gen.Pattern.html#genFromPatternWithLength"><span class="hs-identifier hs-var hs-var">genFromPatternWithLength</span></a></span></span><span> </span><span id="local-6989586621679237402"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237402"><span class="hs-identifier hs-var">patternText</span></a></span></span><span> </span><span id="local-6989586621679237403"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237403"><span class="hs-identifier hs-var">minLen</span></a></span></span><span> </span><span id="local-6989586621679237404"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237404"><span class="hs-identifier hs-var">maxLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#parsePattern"><span class="hs-identifier hs-var">parsePattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237402"><span class="hs-identifier hs-var">patternText</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679237405"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679237405"><span class="hs-identifier hs-var">_err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Gen Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679237406"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237406"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237407"><span class="annot"><span class="annottext">matches :: [Text]
</span><a href="#local-6989586621679237407"><span class="hs-identifier hs-var hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Text]
</span><a href="Haskemathesis.Gen.Pattern.html#generateMatches"><span class="hs-identifier hs-var">generateMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237406"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-96"></span><span>                </span><span id="local-6989586621679237408"><span class="annot"><span class="annottext">filtered :: [Text]
</span><a href="#local-6989586621679237408"><span class="hs-identifier hs-var hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; [Text] -&gt; [Text]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><a href="#local-6989586621679237409"><span class="hs-identifier hs-var">validLength</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679237407"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-97"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679237408"><span class="hs-identifier hs-var">filtered</span></a></span><span>
</span><span id="line-98"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Gen Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-99"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Gen Text -&gt; Maybe (Gen Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Gen Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, MonadGen m) =&gt;
f a -&gt; m a
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#element"><span class="hs-identifier hs-var">Gen.element</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679237408"><span class="hs-identifier hs-var">filtered</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679237409"><span class="annot"><span class="annottext">validLength :: Text -&gt; Bool
</span><a href="#local-6989586621679237409"><span class="hs-identifier hs-var hs-var">validLength</span></a></span></span><span> </span><span id="local-6989586621679237410"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237410"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-comment">-- Use compareLength for efficient short-circuiting length checks</span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237413"><span class="annot"><span class="annottext">checkMin :: Bool
</span><a href="#local-6989586621679237413"><span class="hs-identifier hs-var hs-var">checkMin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Int -&gt; Bool) -&gt; Maybe Int -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679237415"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237415"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int -&gt; Ordering
</span><span class="hs-identifier hs-var">T.compareLength</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237410"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237415"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237403"><span class="hs-identifier hs-var">minLen</span></a></span><span>
</span><span id="line-104"></span><span>            </span><span id="local-6989586621679237419"><span class="annot"><span class="annottext">checkMax :: Bool
</span><a href="#local-6989586621679237419"><span class="hs-identifier hs-var hs-var">checkMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Int -&gt; Bool) -&gt; Maybe Int -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679237420"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237420"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int -&gt; Ordering
</span><span class="hs-identifier hs-var">T.compareLength</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237410"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237420"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237404"><span class="hs-identifier hs-var">maxLen</span></a></span><span>
</span><span id="line-105"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679237413"><span class="hs-identifier hs-var">checkMin</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679237419"><span class="hs-identifier hs-var">checkMax</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><span class="hs-comment">-- | Parse a regex string into a Pattern, normalizing it for generation.</span></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#parsePattern"><span class="hs-identifier hs-type">parsePattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-109"></span><span id="parsePattern"><span class="annot"><span class="annottext">parsePattern :: String -&gt; Either String Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#parsePattern"><span class="hs-identifier hs-var hs-var">parsePattern</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Either String Pattern
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#parsePattern"><span class="hs-identifier hs-var">parsePattern</span></a></span><span> </span><span id="local-6989586621679237423"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679237423"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either ParseError (Pattern, (Int, DoPa))
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.ReadRegex.html#parseRegex"><span class="hs-identifier hs-var">parseRegex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679237423"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237424"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237424"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, DoPa)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Either String Pattern
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237424"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679237426"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679237426"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Pattern
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679237426"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><span class="hs-comment">{- | Normalize a pattern for generation.
Removes backreferences (which we don't support in pure mode).
-}</span></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-type">normalize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-118"></span><span id="normalize"><span class="annot"><span class="annottext">normalize :: Pattern -&gt; Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-var hs-var">normalize</span></a></span></span><span> </span><span id="local-6989586621679237428"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237428"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237428"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-type">PGroup</span></a></span><span> </span><span id="local-6989586621679237430"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237430"><span class="hs-identifier hs-var">midx</span></a></span></span><span> </span><span id="local-6989586621679237431"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237431"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Pattern -&gt; Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-var">PGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237430"><span class="hs-identifier hs-var">midx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237431"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PQuest"><span class="hs-identifier hs-type">PQuest</span></a></span><span> </span><span id="local-6989586621679237433"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237433"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PQuest"><span class="hs-identifier hs-var">PQuest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237433"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PPlus"><span class="hs-identifier hs-type">PPlus</span></a></span><span> </span><span id="local-6989586621679237435"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237435"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PPlus"><span class="hs-identifier hs-var">PPlus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237435"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-type">PStar</span></a></span><span> </span><span id="local-6989586621679237437"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679237437"><span class="hs-identifier hs-var">greedy</span></a></span></span><span> </span><span id="local-6989586621679237438"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237438"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pattern -&gt; Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-var">PStar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679237437"><span class="hs-identifier hs-var">greedy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237438"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679237440"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679237440"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; [Pattern] -&gt; [Pattern]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679237440"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span id="local-6989586621679237442"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679237442"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-var">PConcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; [Pattern] -&gt; [Pattern]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679237442"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span id="local-6989586621679237444"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237444"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span id="local-6989586621679237445"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237445"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span id="local-6989586621679237446"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237446"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Pattern -&gt; Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-var">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237444"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237445"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237446"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">-- Backreferences become empty (we don't support them)</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PEscape"><span class="hs-identifier hs-type">PEscape</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679237448"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237448"><span class="hs-identifier hs-var">c</span></a></span></span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237448"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'1'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237428"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679237450"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237450"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237450"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><span class="hs-comment">{- | Generate all matching strings for a pattern (up to a limit).
Uses LogicT for fair enumeration.
-}</span></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#generateMatches"><span class="hs-identifier hs-type">generateMatches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span id="generateMatches"><span class="annot"><span class="annottext">generateMatches :: Pattern -&gt; [Text]
</span><a href="Haskemathesis.Gen.Pattern.html#generateMatches"><span class="hs-identifier hs-var hs-var">generateMatches</span></a></span></span><span> </span><span id="local-6989586621679237451"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237451"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Logic Text -&gt; [Text]
forall a. Int -&gt; Logic a -&gt; [a]
</span><a href="file:///nix/store/gd46jpdjb4hqk1q0xmqi02gbpv1x1cr7-logict-0.8.2.0-doc/share/doc/logict-0.8.2.0/html/src/Control.Monad.Logic.html#observeMany"><span class="hs-identifier hs-var">observeMany</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Logic Text
</span><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237451"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><span class="hs-comment">{- | Generate matching strings from a text pattern.
Convenience function for testing.
-}</span></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#generateMatchesFromText"><span class="hs-identifier hs-type">generateMatchesFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span id="generateMatchesFromText"><span class="annot"><span class="annottext">generateMatchesFromText :: Text -&gt; [Text]
</span><a href="Haskemathesis.Gen.Pattern.html#generateMatchesFromText"><span class="hs-identifier hs-var hs-var">generateMatchesFromText</span></a></span></span><span> </span><span id="local-6989586621679237453"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237453"><span class="hs-identifier hs-var">patternText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Pattern
</span><a href="Haskemathesis.Gen.Pattern.html#parsePattern"><span class="hs-identifier hs-var">parsePattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237453"><span class="hs-identifier hs-var">patternText</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679237454"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237454"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Text]
</span><a href="Haskemathesis.Gen.Pattern.html#generateMatches"><span class="hs-identifier hs-var">generateMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237454"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="annot"><span class="hs-comment">-- | Run the pattern generator in the Logic monad.</span></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/gd46jpdjb4hqk1q0xmqi02gbpv1x1cr7-logict-0.8.2.0-doc/share/doc/logict-0.8.2.0/html/src/Control.Monad.Logic.html#Logic"><span class="hs-identifier hs-type">Logic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-149"></span><span id="run"><span class="annot"><span class="annottext">run :: Pattern -&gt; Logic Text
</span><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span id="local-6989586621679237455"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237455"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237455"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Logic Text
forall a. a -&gt; LogicT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">T.empty</span></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PChar"><span class="hs-identifier hs-type">PChar</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679237458"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237458"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Logic Text
</span><a href="#local-6989586621679237459"><span class="hs-identifier hs-var">isChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237458"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PAny"><span class="hs-identifier hs-type">PAny</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-type">PatternSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679237462"><span class="annot"><span class="annottext">Set Char
</span><a href="#local-6989586621679237462"><span class="hs-identifier hs-var">cset</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetCharacterClass)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetCollatingElement)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetEquivalenceClass)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Logic Text
forall (f :: * -&gt; *) a. Alternative f =&gt; [a] -&gt; f a
</span><a href="Haskemathesis.Gen.Pattern.html#each"><span class="hs-identifier hs-var">each</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Logic Text) -&gt; [Text] -&gt; Logic Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text) -&gt; String -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [Text]) -&gt; String -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Char -&gt; String
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Set Char
</span><a href="#local-6989586621679237462"><span class="hs-identifier hs-var">cset</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PAny"><span class="hs-identifier hs-type">PAny</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Logic Text
forall (f :: * -&gt; *) a. Alternative f =&gt; [a] -&gt; f a
</span><a href="Haskemathesis.Gen.Pattern.html#each"><span class="hs-identifier hs-var">each</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Logic Text) -&gt; [Text] -&gt; Logic Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text) -&gt; String -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PAnyNot"><span class="hs-identifier hs-type">PAnyNot</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-type">PatternSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679237466"><span class="annot"><span class="annottext">Set Char
</span><a href="#local-6989586621679237466"><span class="hs-identifier hs-var">cset</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetCharacterClass)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetCollatingElement)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetEquivalenceClass)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Logic Text
</span><a href="#local-6989586621679237467"><span class="hs-identifier hs-var">chars</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Logic Text) -&gt; String -&gt; Logic Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679237468"><span class="hs-identifier hs-var">notChars</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Char -&gt; String
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Set Char
</span><a href="#local-6989586621679237466"><span class="hs-identifier hs-var">cset</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PAnyNot"><span class="hs-identifier hs-type">PAnyNot</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Logic Text
</span><a href="#local-6989586621679237467"><span class="hs-identifier hs-var">chars</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Logic Text) -&gt; String -&gt; Logic Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679237468"><span class="hs-identifier hs-var">notChars</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PQuest"><span class="hs-identifier hs-type">PQuest</span></a></span><span> </span><span id="local-6989586621679237469"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237469"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Logic Text
forall a. a -&gt; LogicT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">T.empty</span></span><span> </span><span class="annot"><span class="annottext">Logic Text -&gt; Logic Text -&gt; Logic Text
forall a.
LogicT Identity a -&gt; LogicT Identity a -&gt; LogicT Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Logic Text
</span><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237469"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PPlus"><span class="hs-identifier hs-type">PPlus</span></a></span><span> </span><span id="local-6989586621679237470"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237470"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Logic Text
</span><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Logic Text) -&gt; Pattern -&gt; Logic Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Pattern -&gt; Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-var">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237470"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-type">PStar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679237471"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237471"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Logic Text
</span><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Logic Text) -&gt; Pattern -&gt; Logic Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Pattern -&gt; Pattern
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-var">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237471"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span id="local-6989586621679237472"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237472"><span class="hs-identifier hs-var">low</span></a></span></span><span> </span><span id="local-6989586621679237473"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237473"><span class="hs-identifier hs-var">high</span></a></span></span><span> </span><span id="local-6989586621679237474"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237474"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621679237475"><span class="annot"><a href="#local-6989586621679237475"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; LogicT Identity Int
forall (f :: * -&gt; *) a. Alternative f =&gt; [a] -&gt; f a
</span><a href="Haskemathesis.Gen.Pattern.html#each"><span class="hs-identifier hs-var">each</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237472"><span class="hs-identifier hs-var">low</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237472"><span class="hs-identifier hs-var">low</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Haskemathesis.Gen.Pattern.html#maxRepeat"><span class="hs-identifier hs-var">maxRepeat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679237473"><span class="hs-identifier hs-var">high</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.concat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">replicateM</span></span><span> </span><span class="annot"><a href="#local-6989586621679237475"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237474"><span class="hs-identifier hs-type">inner</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span id="local-6989586621679237478"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679237478"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; LogicT Identity [Text] -&gt; Logic Text
forall a b. (a -&gt; b) -&gt; LogicT Identity a -&gt; LogicT Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; Logic Text) -&gt; [Pattern] -&gt; LogicT Identity [Text]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Logic Text
</span><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679237478"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679237480"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679237480"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Logic Text -&gt; Logic Text)
-&gt; Logic Text -&gt; [Pattern] -&gt; Logic Text
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logic Text -&gt; Logic Text -&gt; Logic Text
forall a.
LogicT Identity a -&gt; LogicT Identity a -&gt; LogicT Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">(&lt;|&gt;)</span></span><span> </span><span class="annot"><span class="annottext">(Logic Text -&gt; Logic Text -&gt; Logic Text)
-&gt; (Pattern -&gt; Logic Text) -&gt; Pattern -&gt; Logic Text -&gt; Logic Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Logic Text
</span><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-var">run</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Logic Text
forall a. LogicT Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">empty</span></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679237480"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PDot"><span class="hs-identifier hs-type">PDot</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Logic Text
</span><a href="#local-6989586621679237467"><span class="hs-identifier hs-var">chars</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Logic Text) -&gt; String -&gt; Logic Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679237468"><span class="hs-identifier hs-var">notChars</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PEscape"><span class="hs-identifier hs-type">PEscape</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679237485"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237485"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Logic Text
</span><a href="#local-6989586621679237467"><span class="hs-identifier hs-var">chars</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Logic Text) -&gt; String -&gt; Logic Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String
</span><a href="#local-6989586621679237486"><span class="hs-identifier hs-var">expandEscape</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237485"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PCarat"><span class="hs-identifier hs-type">PCarat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Logic Text
forall a. a -&gt; LogicT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">T.empty</span></span><span> </span><span class="hs-comment">-- Anchor: zero-width match</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PDollar"><span class="hs-identifier hs-type">PDollar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Logic Text
forall a. a -&gt; LogicT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">T.empty</span></span><span> </span><span class="hs-comment">-- Anchor: zero-width match</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-type">PGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679237489"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237489"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Logic Text
</span><a href="Haskemathesis.Gen.Pattern.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237489"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679237490"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679237490"><span class="hs-identifier hs-var">_unsupportedPattern</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Logic Text
forall a. a -&gt; LogicT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">T.empty</span></span><span> </span><span class="hs-comment">-- Unsupported patterns produce empty string</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679237459"><span class="annot"><span class="annottext">isChar :: Char -&gt; Logic Text
</span><a href="#local-6989586621679237459"><span class="hs-identifier hs-var hs-var">isChar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Logic Text
forall a. a -&gt; LogicT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Logic Text) -&gt; (Char -&gt; Text) -&gt; Char -&gt; Logic Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679237467"><span class="annot"><span class="annottext">chars :: String -&gt; Logic Text
</span><a href="#local-6989586621679237467"><span class="hs-identifier hs-var hs-var">chars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Logic Text
forall (f :: * -&gt; *) a. Alternative f =&gt; [a] -&gt; f a
</span><a href="Haskemathesis.Gen.Pattern.html#each"><span class="hs-identifier hs-var">each</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Logic Text)
-&gt; (String -&gt; [Text]) -&gt; String -&gt; Logic Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text) -&gt; String -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679237468"><span class="annot"><span class="annottext">notChars :: String -&gt; String
</span><a href="#local-6989586621679237468"><span class="hs-identifier hs-var hs-var">notChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621679237486"><span class="annot"><span class="annottext">expandEscape :: Char -&gt; String
</span><a href="#local-6989586621679237486"><span class="hs-identifier hs-var hs-var">expandEscape</span></a></span></span><span> </span><span id="local-6989586621679237506"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237506"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237506"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'n'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'t'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\t&quot;</span></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'r'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\r&quot;</span></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'f'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\f&quot;</span></span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\a&quot;</span></span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'e'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\ESC&quot;</span></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'d'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'w'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'s'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\t\n\r\f &quot;</span></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'D'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679237468"><span class="hs-identifier hs-var">notChars</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'W'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679237468"><span class="hs-identifier hs-var">notChars</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'S'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679237468"><span class="hs-identifier hs-var">notChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\t\n\r\f &quot;</span></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679237507"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237507"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679237507"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><span class="hs-comment">-- | Choose one element from a list.</span></span><span>
</span><span id="line-190"></span><span id="local-6989586621679237307"><span id="local-6989586621679237308"><span class="annot"><a href="Haskemathesis.Gen.Pattern.html#each"><span class="hs-identifier hs-type">each</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Alternative</span></span><span> </span><span class="annot"><a href="#local-6989586621679237307"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679237308"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237307"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237308"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-191"></span><span id="each"><span class="annot"><span class="annottext">each :: forall (f :: * -&gt; *) a. Alternative f =&gt; [a] -&gt; f a
</span><a href="Haskemathesis.Gen.Pattern.html#each"><span class="hs-identifier hs-var hs-var">each</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; f a -&gt; f a) -&gt; f a -&gt; [a] -&gt; f a
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; f a -&gt; f a
forall a. f a -&gt; f a -&gt; f a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">(&lt;|&gt;)</span></span><span> </span><span class="annot"><span class="annottext">(f a -&gt; f a -&gt; f a) -&gt; (a -&gt; f a) -&gt; a -&gt; f a -&gt; f a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f a
forall a. f a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">empty</span></span><span>
</span><span id="line-192"></span></pre></body></html>