<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE StrictData #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">{- | Authentication configuration and request mutation helpers.

This module provides types and functions for configuring authentication
in Haskemathesis tests. It supports various authentication schemes
including HTTP Basic, Bearer tokens, and API keys.

=== Supported Authentication Types

* 'AuthBasic' - HTTP Basic authentication (username/password)
* 'AuthBearer' - Bearer token authentication (OAuth2, JWT, etc.)
* 'AuthApiKey' - API key authentication (header, query, or cookie)

=== Basic Usage

@
import Haskemathesis.Auth.Config (AuthConfig(..), AuthValue(..), applyAuthForOperation)
import Haskemathesis.Config (defaultTestConfig)

-- Create auth configuration
authConfig :: AuthConfig
authConfig = AuthConfig $ Map.fromList
    [ (&quot;bearerAuth&quot;, AuthBearer &quot;my-token-123&quot;)
    , (&quot;basicAuth&quot;, AuthBasic &quot;username&quot; &quot;password&quot;)
    ]

-- Use in test configuration
config = defaultTestConfig { tcAuthConfig = Just authConfig }
@
-}</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html"><span class="hs-identifier">Haskemathesis.Auth.Config</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthConfig"><span class="hs-identifier">AuthConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthValue"><span class="hs-identifier">AuthValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#applyAuthForOperation"><span class="hs-identifier">applyAuthForOperation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/d6bww1rn97ymdg7b343g7rpxx79hzq9g-base64-bytestring-1.2.1.0-doc/share/doc/base64-bytestring-1.2.1.0/html/src/Data.ByteString.Base64.html"><span class="hs-identifier">Data.ByteString.Base64</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Base64</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS8</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/j3bcnc7r5q4sz7xij5naq8pf2zh1xr44-case-insensitive-1.2.1.0-doc/share/doc/case-insensitive-1.2.1.0/html/src/Data.CaseInsensitive.html"><span class="hs-identifier">Data.CaseInsensitive</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">asum</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InsOrdHashMap</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.html"><span class="hs-identifier">Data.OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ApiKeyLocation"><span class="hs-identifier">ApiKeyLocation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ApiKeyParams"><span class="hs-identifier">ApiKeyParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Components"><span class="hs-identifier">Components</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#HttpSchemeType"><span class="hs-identifier">HttpSchemeType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier">OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityDefinitions"><span class="hs-identifier">SecurityDefinitions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityRequirement"><span class="hs-identifier">SecurityRequirement</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityScheme"><span class="hs-identifier">SecurityScheme</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecuritySchemeType"><span class="hs-identifier">SecuritySchemeType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeUtf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html"><span class="hs-identifier">Haskemathesis.Execute.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier">ApiRequest</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html"><span class="hs-identifier">Haskemathesis.OpenApi.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier">ResolvedOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.html"><span class="hs-identifier">Network.HTTP.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.Header.html#HeaderName"><span class="hs-identifier">HeaderName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><span class="hs-comment">{- | User-provided auth values keyed by security scheme name.

The 'AuthConfig' type wraps a map from security scheme names (as defined
in the OpenAPI spec) to their corresponding 'AuthValue's. The scheme
names must match those defined in the OpenAPI specification's
@securitySchemes@ section.

=== Example

@
authConfig :: AuthConfig
authConfig = AuthConfig $ Map.fromList
    [ (&quot;bearerAuth&quot;, AuthBearer &quot;my-token&quot;)
    , (&quot;basicAuth&quot;, AuthBasic &quot;user&quot; &quot;pass&quot;)
    , (&quot;apiKey&quot;, AuthApiKey &quot;secret-key&quot;)
    ]
@
-}</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">newtype</span><span> </span><span id="AuthConfig"><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthConfig"><span class="hs-identifier hs-var">AuthConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AuthConfig"><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthConfig"><span class="hs-identifier hs-var">AuthConfig</span></a></span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="authValues"><span class="annot"><span class="annottext">AuthConfig -&gt; Map Text AuthValue
</span><a href="Haskemathesis.Auth.Config.html#authValues"><span class="hs-identifier hs-var hs-var">authValues</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthValue"><span class="hs-identifier hs-type">AuthValue</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679219524"><span id="local-6989586621679219531"><span class="annot"><span class="annottext">AuthConfig -&gt; AuthConfig -&gt; Bool
(AuthConfig -&gt; AuthConfig -&gt; Bool)
-&gt; (AuthConfig -&gt; AuthConfig -&gt; Bool) -&gt; Eq AuthConfig
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: AuthConfig -&gt; AuthConfig -&gt; Bool
== :: AuthConfig -&gt; AuthConfig -&gt; Bool
$c/= :: AuthConfig -&gt; AuthConfig -&gt; Bool
/= :: AuthConfig -&gt; AuthConfig -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679219542"><span id="local-6989586621679219550"><span id="local-6989586621679219554"><span class="annot"><span class="annottext">Int -&gt; AuthConfig -&gt; ShowS
[AuthConfig] -&gt; ShowS
AuthConfig -&gt; String
(Int -&gt; AuthConfig -&gt; ShowS)
-&gt; (AuthConfig -&gt; String)
-&gt; ([AuthConfig] -&gt; ShowS)
-&gt; Show AuthConfig
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; AuthConfig -&gt; ShowS
showsPrec :: Int -&gt; AuthConfig -&gt; ShowS
$cshow :: AuthConfig -&gt; String
show :: AuthConfig -&gt; String
$cshowList :: [AuthConfig] -&gt; ShowS
showList :: [AuthConfig] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><span class="hs-comment">{- | Authentication values supplied by users.

This type represents the different kinds of authentication credentials
that can be provided. The constructor used must match the security
scheme type defined in the OpenAPI specification.

=== Constructors

* 'AuthBearer' - Bearer token (for HTTP Bearer auth)
* 'AuthBasic' - Username and password (for HTTP Basic auth)
* 'AuthApiKey' - API key string (for API key auth)

=== Example

@
-- Bearer token (OAuth2, JWT, etc.)
bearerAuth :: AuthValue
bearerAuth = AuthBearer &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;

-- Basic authentication
basicAuth :: AuthValue
basicAuth = AuthBasic &quot;username&quot; &quot;password&quot;

-- API key
apiKeyAuth :: AuthValue
apiKeyAuth = AuthApiKey &quot;my-secret-api-key&quot;
@
-}</span></span><span>
</span><span id="line-116"></span><span class="hs-keyword">data</span><span> </span><span id="AuthValue"><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthValue"><span class="hs-identifier hs-var">AuthValue</span></a></span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="AuthBearer"><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthBearer"><span class="hs-identifier hs-var">AuthBearer</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AuthBasic"><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthBasic"><span class="hs-identifier hs-var">AuthBasic</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AuthApiKey"><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthApiKey"><span class="hs-identifier hs-var">AuthApiKey</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679219561"><span id="local-6989586621679219570"><span class="annot"><span class="annottext">AuthValue -&gt; AuthValue -&gt; Bool
(AuthValue -&gt; AuthValue -&gt; Bool)
-&gt; (AuthValue -&gt; AuthValue -&gt; Bool) -&gt; Eq AuthValue
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: AuthValue -&gt; AuthValue -&gt; Bool
== :: AuthValue -&gt; AuthValue -&gt; Bool
$c/= :: AuthValue -&gt; AuthValue -&gt; Bool
/= :: AuthValue -&gt; AuthValue -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679219573"><span id="local-6989586621679219582"><span id="local-6989586621679219585"><span class="annot"><span class="annottext">Int -&gt; AuthValue -&gt; ShowS
[AuthValue] -&gt; ShowS
AuthValue -&gt; String
(Int -&gt; AuthValue -&gt; ShowS)
-&gt; (AuthValue -&gt; String)
-&gt; ([AuthValue] -&gt; ShowS)
-&gt; Show AuthValue
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; AuthValue -&gt; ShowS
showsPrec :: Int -&gt; AuthValue -&gt; ShowS
$cshow :: AuthValue -&gt; String
show :: AuthValue -&gt; String
$cshowList :: [AuthValue] -&gt; ShowS
showList :: [AuthValue] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><span class="hs-comment">{- | Apply authentication to a request for a specific operation.

This function examines the security requirements of the given operation
and applies the appropriate authentication credentials from the
'AuthConfig'. It supports multiple authentication schemes and will
use the first one that matches both the operation's requirements and
the available credentials.

=== Parameters

* @openApi@ - The OpenAPI specification (contains security scheme definitions)
* @config@ - The 'AuthConfig' containing user credentials
* @op@ - The 'ResolvedOperation' being tested
* @req@ - The 'ApiRequest' to add authentication to

=== Return Value

Returns the request with authentication headers/query parameters added.
If no authentication is required or available, the request is returned
unchanged.

=== Example

@
import Haskemathesis.Auth.Config (AuthConfig(..), AuthValue(..), applyAuthForOperation)
import Data.OpenApi (OpenApi)

addAuth :: OpenApi -&gt; ApiRequest -&gt; ResolvedOperation -&gt; ApiRequest
addAuth spec req op =
    let authConfig = AuthConfig $ Map.fromList [(&quot;bearerAuth&quot;, AuthBearer &quot;my-token&quot;)]
    in applyAuthForOperation spec authConfig op req
@
-}</span></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#applyAuthForOperation"><span class="hs-identifier hs-type">applyAuthForOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthConfig"><span class="hs-identifier hs-type">AuthConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span>
</span><span id="line-156"></span><span id="applyAuthForOperation"><span class="annot"><span class="annottext">applyAuthForOperation :: OpenApi
-&gt; AuthConfig -&gt; ResolvedOperation -&gt; ApiRequest -&gt; ApiRequest
</span><a href="Haskemathesis.Auth.Config.html#applyAuthForOperation"><span class="hs-identifier hs-var hs-var">applyAuthForOperation</span></a></span></span><span> </span><span id="local-6989586621679219589"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679219589"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679219590"><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679219590"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679219591"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679219591"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679219592"><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679219592"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; AuthConfig -&gt; ResolvedOperation -&gt; Maybe [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#selectAuthForOperation"><span class="hs-identifier hs-var">selectAuthForOperation</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679219589"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679219590"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679219591"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">Maybe [AppliedAuth]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679219592"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679219594"><span class="annot"><span class="annottext">[AppliedAuth]
</span><a href="#local-6989586621679219594"><span class="hs-identifier hs-var">auths</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ApiRequest -&gt; AppliedAuth -&gt; ApiRequest)
-&gt; ApiRequest -&gt; [AppliedAuth] -&gt; ApiRequest
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">ApiRequest -&gt; AppliedAuth -&gt; ApiRequest
</span><a href="Haskemathesis.Auth.Config.html#applyAuth"><span class="hs-identifier hs-var">applyAuth</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679219592"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">[AppliedAuth]
</span><a href="#local-6989586621679219594"><span class="hs-identifier hs-var">auths</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#applyAuth"><span class="hs-identifier hs-type">applyAuth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AppliedAuth"><span class="hs-identifier hs-type">AppliedAuth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span>
</span><span id="line-162"></span><span id="applyAuth"><span class="annot"><span class="annottext">applyAuth :: ApiRequest -&gt; AppliedAuth -&gt; ApiRequest
</span><a href="Haskemathesis.Auth.Config.html#applyAuth"><span class="hs-identifier hs-var hs-var">applyAuth</span></a></span></span><span> </span><span id="local-6989586621679219597"><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679219597"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679219598"><span class="annot"><span class="annottext">AppliedAuth
</span><a href="#local-6989586621679219598"><span class="hs-identifier hs-var">auth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AppliedAuth
</span><a href="#local-6989586621679219598"><span class="hs-identifier hs-var">auth</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#ApplyHeader"><span class="hs-identifier hs-type">ApplyHeader</span></a></span><span> </span><span id="local-6989586621679219600"><span class="annot"><span class="annottext">HeaderName
</span><a href="#local-6989586621679219600"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679219601"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679219601"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>            </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679219597"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqHeaders"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679219600"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679219601"><span class="hs-identifier hs-type">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqHeaders"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219597"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#ApplyQuery"><span class="hs-identifier hs-type">ApplyQuery</span></a></span><span> </span><span id="local-6989586621679219604"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219604"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679219605"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219605"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>            </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679219597"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqQueryParams"><span class="hs-identifier hs-var">reqQueryParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679219604"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679219605"><span class="hs-identifier hs-type">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqQueryParams"><span class="hs-identifier hs-var">reqQueryParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219597"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#selectAuthForOperation"><span class="hs-identifier hs-type">selectAuthForOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthConfig"><span class="hs-identifier hs-type">AuthConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AppliedAuth"><span class="hs-identifier hs-type">AppliedAuth</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span id="selectAuthForOperation"><span class="annot"><span class="annottext">selectAuthForOperation :: OpenApi -&gt; AuthConfig -&gt; ResolvedOperation -&gt; Maybe [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#selectAuthForOperation"><span class="hs-identifier hs-var hs-var">selectAuthForOperation</span></a></span></span><span> </span><span id="local-6989586621679219607"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679219607"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679219608"><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679219608"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679219609"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679219609"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[SecurityRequirement] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; [SecurityRequirement]
</span><a href="Haskemathesis.OpenApi.Types.html#roSecurity"><span class="hs-identifier hs-var">roSecurity</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679219609"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe [AppliedAuth]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-174"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679219612"><span class="annot"><span class="annottext">schemes :: Map Text SecurityScheme
</span><a href="#local-6989586621679219612"><span class="hs-identifier hs-var hs-var">schemes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Components -&gt; Map Text SecurityScheme
</span><a href="Haskemathesis.Auth.Config.html#securitySchemesMap"><span class="hs-identifier hs-var">securitySchemesMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; Components
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_openApiComponents"><span class="hs-identifier hs-var">_openApiComponents</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679219607"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map Text SecurityScheme
-&gt; [SecurityRequirement] -&gt; AuthConfig -&gt; Maybe [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#findSatisfied"><span class="hs-identifier hs-var">findSatisfied</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text SecurityScheme
</span><a href="#local-6989586621679219612"><span class="hs-identifier hs-var">schemes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; [SecurityRequirement]
</span><a href="Haskemathesis.OpenApi.Types.html#roSecurity"><span class="hs-identifier hs-var">roSecurity</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679219609"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679219608"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#findSatisfied"><span class="hs-identifier hs-type">findSatisfied</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityScheme"><span class="hs-identifier hs-type">SecurityScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityRequirement"><span class="hs-identifier hs-type">SecurityRequirement</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthConfig"><span class="hs-identifier hs-type">AuthConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AppliedAuth"><span class="hs-identifier hs-type">AppliedAuth</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span id="findSatisfied"><span class="annot"><span class="annottext">findSatisfied :: Map Text SecurityScheme
-&gt; [SecurityRequirement] -&gt; AuthConfig -&gt; Maybe [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#findSatisfied"><span class="hs-identifier hs-var hs-var">findSatisfied</span></a></span></span><span> </span><span id="local-6989586621679219616"><span class="annot"><span class="annottext">Map Text SecurityScheme
</span><a href="#local-6989586621679219616"><span class="hs-identifier hs-var">schemes</span></a></span></span><span> </span><span id="local-6989586621679219617"><span class="annot"><span class="annottext">[SecurityRequirement]
</span><a href="#local-6989586621679219617"><span class="hs-identifier hs-var">requirements</span></a></span></span><span> </span><span id="local-6989586621679219618"><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679219618"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">[Maybe [AppliedAuth]] -&gt; Maybe [AppliedAuth]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Foldable t, Alternative f) =&gt;
t (f a) -&gt; f a
</span><span class="hs-identifier hs-var">asum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SecurityRequirement -&gt; Maybe [AppliedAuth])
-&gt; [SecurityRequirement] -&gt; [Maybe [AppliedAuth]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Text SecurityScheme
-&gt; AuthConfig -&gt; SecurityRequirement -&gt; Maybe [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#applyRequirement"><span class="hs-identifier hs-var">applyRequirement</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text SecurityScheme
</span><a href="#local-6989586621679219616"><span class="hs-identifier hs-var">schemes</span></a></span><span> </span><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679219618"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SecurityRequirement]
</span><a href="#local-6989586621679219617"><span class="hs-identifier hs-var">requirements</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#applyRequirement"><span class="hs-identifier hs-type">applyRequirement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityScheme"><span class="hs-identifier hs-type">SecurityScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthConfig"><span class="hs-identifier hs-type">AuthConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityRequirement"><span class="hs-identifier hs-type">SecurityRequirement</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AppliedAuth"><span class="hs-identifier hs-type">AppliedAuth</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span id="applyRequirement"><span class="annot"><span class="annottext">applyRequirement :: Map Text SecurityScheme
-&gt; AuthConfig -&gt; SecurityRequirement -&gt; Maybe [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#applyRequirement"><span class="hs-identifier hs-var hs-var">applyRequirement</span></a></span></span><span> </span><span id="local-6989586621679219620"><span class="annot"><span class="annottext">Map Text SecurityScheme
</span><a href="#local-6989586621679219620"><span class="hs-identifier hs-var">schemes</span></a></span></span><span> </span><span id="local-6989586621679219621"><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679219621"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityRequirement"><span class="hs-identifier hs-type">SecurityRequirement</span></a></span><span> </span><span id="local-6989586621679219623"><span class="annot"><span class="annottext">InsOrdHashMap Text [Text]
</span><a href="#local-6989586621679219623"><span class="hs-identifier hs-var">requirement</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">((Text, [Text]) -&gt; Maybe [AppliedAuth])
-&gt; [(Text, [Text])] -&gt; Maybe [[AppliedAuth]]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Text SecurityScheme
-&gt; AuthConfig -&gt; (Text, [Text]) -&gt; Maybe [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#resolveScheme"><span class="hs-identifier hs-var">resolveScheme</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text SecurityScheme
</span><a href="#local-6989586621679219620"><span class="hs-identifier hs-var">schemes</span></a></span><span> </span><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679219621"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsOrdHashMap Text [Text] -&gt; [(Text, [Text])]
forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html#toList"><span class="hs-identifier hs-var">InsOrdHashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Text [Text]
</span><a href="#local-6989586621679219623"><span class="hs-identifier hs-var">requirement</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">Maybe [[AppliedAuth]]
-&gt; ([[AppliedAuth]] -&gt; Maybe [AppliedAuth]) -&gt; Maybe [AppliedAuth]
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AppliedAuth] -&gt; Maybe [AppliedAuth]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">([AppliedAuth] -&gt; Maybe [AppliedAuth])
-&gt; ([[AppliedAuth]] -&gt; [AppliedAuth])
-&gt; [[AppliedAuth]]
-&gt; Maybe [AppliedAuth]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[AppliedAuth]] -&gt; [AppliedAuth]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#resolveScheme"><span class="hs-identifier hs-type">resolveScheme</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityScheme"><span class="hs-identifier hs-type">SecurityScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthConfig"><span class="hs-identifier hs-type">AuthConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AppliedAuth"><span class="hs-identifier hs-type">AppliedAuth</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span id="resolveScheme"><span class="annot"><span class="annottext">resolveScheme :: Map Text SecurityScheme
-&gt; AuthConfig -&gt; (Text, [Text]) -&gt; Maybe [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#resolveScheme"><span class="hs-identifier hs-var hs-var">resolveScheme</span></a></span></span><span> </span><span id="local-6989586621679219629"><span class="annot"><span class="annottext">Map Text SecurityScheme
</span><a href="#local-6989586621679219629"><span class="hs-identifier hs-var">schemes</span></a></span></span><span> </span><span id="local-6989586621679219630"><span class="annot"><span class="annottext">AuthConfig
</span><a href="#local-6989586621679219630"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679219631"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219631"><span class="hs-identifier hs-var">schemeName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679219632"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679219632"><span class="hs-identifier hs-var">_scopes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679219633"><span class="annot"><a href="#local-6989586621679219633"><span class="hs-identifier hs-var">scheme</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Map Text SecurityScheme -&gt; Maybe SecurityScheme
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219631"><span class="hs-identifier hs-var">schemeName</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text SecurityScheme
</span><a href="#local-6989586621679219629"><span class="hs-identifier hs-var">schemes</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679219635"><span class="annot"><a href="#local-6989586621679219635"><span class="hs-identifier hs-var">authValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.lookup</span></span><span> </span><span class="annot"><a href="#local-6989586621679219631"><span class="hs-identifier hs-type">schemeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Auth.Config.html#authValues"><span class="hs-identifier hs-var">authValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219630"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#applyScheme"><span class="hs-identifier hs-type">applyScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219633"><span class="hs-identifier hs-type">scheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679219635"><span class="hs-identifier hs-type">authValue</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#applyScheme"><span class="hs-identifier hs-type">applyScheme</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityScheme"><span class="hs-identifier hs-type">SecurityScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthValue"><span class="hs-identifier hs-type">AuthValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AppliedAuth"><span class="hs-identifier hs-type">AppliedAuth</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span id="applyScheme"><span class="annot"><span class="annottext">applyScheme :: SecurityScheme -&gt; AuthValue -&gt; Maybe [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#applyScheme"><span class="hs-identifier hs-var hs-var">applyScheme</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityScheme"><span class="hs-identifier hs-type">SecurityScheme</span></a></span><span> </span><span id="local-6989586621679219638"><span class="annot"><span class="annottext">SecuritySchemeType
</span><a href="#local-6989586621679219638"><span class="hs-identifier hs-var">schemeType</span></a></span></span><span> </span><span id="local-6989586621679219639"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679219639"><span class="hs-identifier hs-var">_desc</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679219640"><span class="annot"><span class="annottext">AuthValue
</span><a href="#local-6989586621679219640"><span class="hs-identifier hs-var">authValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SecuritySchemeType
</span><a href="#local-6989586621679219638"><span class="hs-identifier hs-var">schemeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AuthValue
</span><a href="#local-6989586621679219640"><span class="hs-identifier hs-var">authValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecuritySchemeHttp"><span class="hs-identifier hs-type">SecuritySchemeHttp</span></a></span><span> </span><span class="annot"><span class="annottext">HttpSchemeType
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#HttpSchemeBasic"><span class="hs-identifier hs-var">HttpSchemeBasic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthBasic"><span class="hs-identifier hs-type">AuthBasic</span></a></span><span> </span><span id="local-6989586621679219643"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219643"><span class="hs-identifier hs-var">username</span></a></span></span><span> </span><span id="local-6989586621679219644"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219644"><span class="hs-identifier hs-var">password</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><span class="annottext">[AppliedAuth] -&gt; Maybe [AppliedAuth]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HeaderName -&gt; ByteString -&gt; AppliedAuth
</span><a href="Haskemathesis.Auth.Config.html#ApplyHeader"><span class="hs-identifier hs-var">ApplyHeader</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Authorization&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ByteString
</span><a href="Haskemathesis.Auth.Config.html#basicHeader"><span class="hs-identifier hs-var">basicHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219643"><span class="hs-identifier hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219644"><span class="hs-identifier hs-var">password</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecuritySchemeHttp"><span class="hs-identifier hs-type">SecuritySchemeHttp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#HttpSchemeBearer"><span class="hs-identifier hs-type">HttpSchemeBearer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthBearer"><span class="hs-identifier hs-type">AuthBearer</span></a></span><span> </span><span id="local-6989586621679219647"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219647"><span class="hs-identifier hs-var">token</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-198"></span><span>            </span><span class="annot"><span class="annottext">[AppliedAuth] -&gt; Maybe [AppliedAuth]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HeaderName -&gt; ByteString -&gt; AppliedAuth
</span><a href="Haskemathesis.Auth.Config.html#ApplyHeader"><span class="hs-identifier hs-var">ApplyHeader</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Authorization&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="Haskemathesis.Auth.Config.html#bearerHeader"><span class="hs-identifier hs-var">bearerHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219647"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecuritySchemeApiKey"><span class="hs-identifier hs-type">SecuritySchemeApiKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ApiKeyParams"><span class="hs-identifier hs-type">ApiKeyParams</span></a></span><span> </span><span id="local-6989586621679219651"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219651"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679219652"><span class="annot"><span class="annottext">ApiKeyLocation
</span><a href="#local-6989586621679219652"><span class="hs-identifier hs-var">location</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AuthApiKey"><span class="hs-identifier hs-type">AuthApiKey</span></a></span><span> </span><span id="local-6989586621679219653"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219653"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>            </span><span class="annot"><span class="annottext">[AppliedAuth] -&gt; Maybe [AppliedAuth]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiKeyLocation -&gt; Text -&gt; Text -&gt; [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#apiKeyAuth"><span class="hs-identifier hs-var">apiKeyAuth</span></a></span><span> </span><span class="annot"><span class="annottext">ApiKeyLocation
</span><a href="#local-6989586621679219652"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219651"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219653"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621679219655"><span class="annot"><span class="annottext">(SecuritySchemeType, AuthValue)
</span><a href="#local-6989586621679219655"><span class="hs-identifier hs-var">_otherScheme</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [AppliedAuth]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#apiKeyAuth"><span class="hs-identifier hs-type">apiKeyAuth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ApiKeyLocation"><span class="hs-identifier hs-type">ApiKeyLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Auth.Config.html#AppliedAuth"><span class="hs-identifier hs-type">AppliedAuth</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span id="apiKeyAuth"><span class="annot"><span class="annottext">apiKeyAuth :: ApiKeyLocation -&gt; Text -&gt; Text -&gt; [AppliedAuth]
</span><a href="Haskemathesis.Auth.Config.html#apiKeyAuth"><span class="hs-identifier hs-var hs-var">apiKeyAuth</span></a></span></span><span> </span><span id="local-6989586621679219656"><span class="annot"><span class="annottext">ApiKeyLocation
</span><a href="#local-6989586621679219656"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span id="local-6989586621679219657"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219657"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679219658"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219658"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ApiKeyLocation
</span><a href="#local-6989586621679219656"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">ApiKeyLocation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ApiKeyHeader"><span class="hs-identifier hs-var">ApiKeyHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HeaderName -&gt; ByteString -&gt; AppliedAuth
</span><a href="Haskemathesis.Auth.Config.html#ApplyHeader"><span class="hs-identifier hs-var">ApplyHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; HeaderName
</span><a href="Haskemathesis.Auth.Config.html#toHeaderName"><span class="hs-identifier hs-var">toHeaderName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219657"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219658"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">ApiKeyLocation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ApiKeyQuery"><span class="hs-identifier hs-var">ApiKeyQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; AppliedAuth
</span><a href="Haskemathesis.Auth.Config.html#ApplyQuery"><span class="hs-identifier hs-var">ApplyQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219657"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219658"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">ApiKeyLocation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ApiKeyCookie"><span class="hs-identifier hs-var">ApiKeyCookie</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HeaderName -&gt; ByteString -&gt; AppliedAuth
</span><a href="Haskemathesis.Auth.Config.html#ApplyHeader"><span class="hs-identifier hs-var">ApplyHeader</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Cookie&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219657"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219658"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#basicHeader"><span class="hs-identifier hs-type">basicHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-211"></span><span id="basicHeader"><span class="annot"><span class="annottext">basicHeader :: Text -&gt; Text -&gt; ByteString
</span><a href="Haskemathesis.Auth.Config.html#basicHeader"><span class="hs-identifier hs-var hs-var">basicHeader</span></a></span></span><span> </span><span id="local-6989586621679219663"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219663"><span class="hs-identifier hs-var">username</span></a></span></span><span> </span><span id="local-6989586621679219664"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219664"><span class="hs-identifier hs-var">password</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679219668"><span class="annot"><span class="annottext">raw :: ByteString
</span><a href="#local-6989586621679219668"><span class="hs-identifier hs-var hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219663"><span class="hs-identifier hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219664"><span class="hs-identifier hs-var">password</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS8.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Basic &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="file:///nix/store/d6bww1rn97ymdg7b343g7rpxx79hzq9g-base64-bytestring-1.2.1.0-doc/share/doc/base64-bytestring-1.2.1.0/html/src/Data.ByteString.Base64.html#encode"><span class="hs-identifier hs-var">Base64.encode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679219668"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#bearerHeader"><span class="hs-identifier hs-type">bearerHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-216"></span><span id="bearerHeader"><span class="annot"><span class="annottext">bearerHeader :: Text -&gt; ByteString
</span><a href="Haskemathesis.Auth.Config.html#bearerHeader"><span class="hs-identifier hs-var hs-var">bearerHeader</span></a></span></span><span> </span><span id="local-6989586621679219671"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219671"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS8.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Bearer &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679219671"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#toHeaderName"><span class="hs-identifier hs-type">toHeaderName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.Header.html#HeaderName"><span class="hs-identifier hs-type">HeaderName</span></a></span><span>
</span><span id="line-220"></span><span id="toHeaderName"><span class="annot"><span class="annottext">toHeaderName :: Text -&gt; HeaderName
</span><a href="Haskemathesis.Auth.Config.html#toHeaderName"><span class="hs-identifier hs-var hs-var">toHeaderName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HeaderName
forall s. FoldCase s =&gt; s -&gt; CI s
</span><a href="file:///nix/store/j3bcnc7r5q4sz7xij5naq8pf2zh1xr44-case-insensitive-1.2.1.0-doc/share/doc/case-insensitive-1.2.1.0/html/src/Data.CaseInsensitive.Internal.html#mk"><span class="hs-identifier hs-var">CI.mk</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HeaderName)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; HeaderName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Haskemathesis.Auth.Config.html#securitySchemesMap"><span class="hs-identifier hs-type">securitySchemesMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Components"><span class="hs-identifier hs-type">Components</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityScheme"><span class="hs-identifier hs-type">SecurityScheme</span></a></span><span>
</span><span id="line-223"></span><span id="securitySchemesMap"><span class="annot"><span class="annottext">securitySchemesMap :: Components -&gt; Map Text SecurityScheme
</span><a href="Haskemathesis.Auth.Config.html#securitySchemesMap"><span class="hs-identifier hs-var hs-var">securitySchemesMap</span></a></span></span><span> </span><span id="local-6989586621679219673"><span class="annot"><span class="annottext">Components
</span><a href="#local-6989586621679219673"><span class="hs-identifier hs-var">components</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Components -&gt; SecurityDefinitions
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_componentsSecuritySchemes"><span class="hs-identifier hs-var">_componentsSecuritySchemes</span></a></span><span> </span><span class="annot"><span class="annottext">Components
</span><a href="#local-6989586621679219673"><span class="hs-identifier hs-var">components</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#SecurityDefinitions"><span class="hs-identifier hs-type">SecurityDefinitions</span></a></span><span> </span><span id="local-6989586621679219676"><span class="annot"><span class="annottext">Definitions SecurityScheme
</span><a href="#local-6989586621679219676"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Text, SecurityScheme)] -&gt; Map Text SecurityScheme
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Definitions SecurityScheme -&gt; [(Text, SecurityScheme)]
forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html#toList"><span class="hs-identifier hs-var">InsOrdHashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Definitions SecurityScheme
</span><a href="#local-6989586621679219676"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- Internal representation for applying auth to a request.</span><span>
</span><span id="line-228"></span><span class="hs-keyword">data</span><span> </span><span id="AppliedAuth"><span class="annot"><a href="Haskemathesis.Auth.Config.html#AppliedAuth"><span class="hs-identifier hs-var">AppliedAuth</span></a></span></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="ApplyHeader"><span class="annot"><a href="Haskemathesis.Auth.Config.html#ApplyHeader"><span class="hs-identifier hs-var">ApplyHeader</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.Header.html#HeaderName"><span class="hs-identifier hs-type">HeaderName</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ApplyQuery"><span class="annot"><a href="Haskemathesis.Auth.Config.html#ApplyQuery"><span class="hs-identifier hs-var">ApplyQuery</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-231"></span></pre></body></html>