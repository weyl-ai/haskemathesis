<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | Generate API requests from resolved operations.

This module provides generators for creating 'ApiRequest' values from
'ResolvedOperation' definitions. It handles parameter generation
(path, query, header), request body generation, and path interpolation.

=== Basic Usage

@
import Haskemathesis.Gen.Request (genApiRequest)
import Haskemathesis.OpenApi.Types (ResolvedOperation)

-- Generate a request for an operation
let operation :: ResolvedOperation = ...
request &lt;- genApiRequest operation
@
-}</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Request.html"><span class="hs-identifier">Haskemathesis.Gen.Request</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Haskemathesis.Gen.Request.html#genApiRequest"><span class="hs-identifier">genApiRequest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Haskemathesis.Gen.Request.html#genParam"><span class="hs-identifier">genParam</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Haskemathesis.Gen.Request.html#genRequestBody"><span class="hs-identifier">genRequestBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html#encode"><span class="hs-identifier">encode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LBS</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/j3bcnc7r5q4sz7xij5naq8pf2zh1xr44-case-insensitive-1.2.1.0-doc/share/doc/case-insensitive-1.2.1.0/html/src/Data.CaseInsensitive.html"><span class="hs-identifier">Data.CaseInsensitive</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeUtf8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">encodeUtf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html"><span class="hs-identifier">Haskemathesis.Execute.Types</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.html"><span class="hs-identifier">Haskemathesis.Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Gen.Core.html#genFromSchema"><span class="hs-identifier">genFromSchema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html"><span class="hs-identifier">Haskemathesis.OpenApi.Types</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier">Gen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.html"><span class="hs-identifier">Network.HTTP.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.Header.html#HeaderName"><span class="hs-identifier">HeaderName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.URI.html"><span class="hs-identifier">Network.HTTP.Types.URI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.URI.html#urlEncode"><span class="hs-identifier">urlEncode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">{- | Generate a complete API request for a resolved operation.

This generator creates an 'ApiRequest' by:

1. Generating values for all parameters (path, query, header)
2. Generating a request body if the operation has one
3. Interpolating path parameters into the URL path

=== Parameters

* @op@ - The 'ResolvedOperation' to generate a request for

=== Return Value

Returns a 'Gen ApiRequest' that generates valid requests for the operation.

=== Example

@
import Haskemathesis.Gen.Request (genApiRequest)
import Haskemathesis.OpenApi.Types (ResolvedOperation)

let operation :: ResolvedOperation = ...
request &lt;- genApiRequest operation
-- request will have all required parameters and body filled in
@
-}</span></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Haskemathesis.Gen.Request.html#genApiRequest"><span class="hs-identifier hs-type">genApiRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span>
</span><span id="line-69"></span><span id="genApiRequest"><span class="annot"><span class="annottext">genApiRequest :: ResolvedOperation -&gt; Gen ApiRequest
</span><a href="Haskemathesis.Gen.Request.html#genApiRequest"><span class="hs-identifier hs-var hs-var">genApiRequest</span></a></span></span><span> </span><span id="local-6989586621679243606"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679243606"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679243607"><span class="annot"><a href="#local-6989586621679243607"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ResolvedParam -&gt; GenT Identity (ParamLocation, (Text, Text)))
-&gt; [ResolvedParam] -&gt; GenT Identity [(ParamLocation, (Text, Text))]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">ResolvedParam -&gt; GenT Identity (ParamLocation, (Text, Text))
</span><a href="Haskemathesis.Gen.Request.html#genParam"><span class="hs-identifier hs-var">genParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; [ResolvedParam]
</span><a href="Haskemathesis.OpenApi.Types.html#roParameters"><span class="hs-identifier hs-var">roParameters</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679243606"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679243610"><span class="annot"><a href="#local-6989586621679243610"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Request.html#genRequestBody"><span class="hs-identifier hs-type">genRequestBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#roRequestBody"><span class="hs-identifier hs-var">roRequestBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243606"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679243612"><span class="annot"><a href="#local-6989586621679243612"><span class="hs-identifier hs-var">pathParams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679243613"><span class="annot"><a href="#local-6989586621679243613"><span class="hs-identifier hs-var">queryParams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679243614"><span class="annot"><a href="#local-6989586621679243614"><span class="hs-identifier hs-var">headerParams</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Request.html#partitionParams"><span class="hs-identifier hs-type">partitionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243607"><span class="hs-identifier hs-type">params</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679243616"><span class="annot"><a href="#local-6989586621679243616"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, Text)] -&gt; Text
</span><a href="Haskemathesis.Gen.Request.html#interpolatePath"><span class="hs-identifier hs-var">interpolatePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roPath"><span class="hs-identifier hs-var">roPath</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679243606"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243612"><span class="hs-identifier hs-var">pathParams</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span>
</span><span id="line-76"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqMethod"><span class="hs-identifier hs-var">reqMethod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">encodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243606"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqPath"><span class="hs-identifier hs-var">reqPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679243616"><span class="hs-identifier hs-type">path</span></a></span><span>
</span><span id="line-78"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqQueryParams"><span class="hs-identifier hs-var">reqQueryParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679243613"><span class="hs-identifier hs-type">queryParams</span></a></span><span>
</span><span id="line-79"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqHeaders"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679243614"><span class="hs-identifier hs-type">headerParams</span></a></span><span>
</span><span id="line-80"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#reqBody"><span class="hs-identifier hs-var">reqBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679243610"><span class="hs-identifier hs-type">body</span></a></span><span>
</span><span id="line-81"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">{- | Generate a parameter value.

This generator creates a value for a single parameter based on its
schema. The generated value is returned along with its location and name
so it can be properly placed in the request (path, query, or header).

=== Parameters

* @param@ - The 'ResolvedParam' to generate a value for

=== Return Value

Returns a 'Gen' that produces a tuple of (location, (name, value)).

=== Example

@
import Haskemathesis.Gen.Request (genParam)
import Haskemathesis.OpenApi.Types (ResolvedParam(..), ParamLocation(..))

let param = ResolvedParam
        { rpName = &quot;userId&quot;
        , rpLocation = ParamPath
        , rpRequired = True
        , rpSchema = ...
        }
(location, (name, value)) &lt;- genParam param
@
-}</span></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Haskemathesis.Gen.Request.html#genParam"><span class="hs-identifier hs-type">genParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedParam"><span class="hs-identifier hs-type">ResolvedParam</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ParamLocation"><span class="hs-identifier hs-type">ParamLocation</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span id="genParam"><span class="annot"><span class="annottext">genParam :: ResolvedParam -&gt; GenT Identity (ParamLocation, (Text, Text))
</span><a href="Haskemathesis.Gen.Request.html#genParam"><span class="hs-identifier hs-var hs-var">genParam</span></a></span></span><span> </span><span id="local-6989586621679243626"><span class="annot"><span class="annottext">ResolvedParam
</span><a href="#local-6989586621679243626"><span class="hs-identifier hs-var">param</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679243627"><span class="annot"><a href="#local-6989586621679243627"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Gen Value
</span><a href="Haskemathesis.Gen.Core.html#genFromSchema"><span class="hs-identifier hs-var">genFromSchema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedParam -&gt; Schema
</span><a href="Haskemathesis.OpenApi.Types.html#rpSchema"><span class="hs-identifier hs-var">rpSchema</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedParam
</span><a href="#local-6989586621679243626"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#rpLocation"><span class="hs-identifier hs-var">rpLocation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243626"><span class="hs-identifier hs-type">param</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#rpName"><span class="hs-identifier hs-var">rpName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243626"><span class="hs-identifier hs-type">param</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Gen.Request.html#renderValue"><span class="hs-identifier hs-type">renderValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243627"><span class="hs-identifier hs-type">value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><span class="hs-comment">{- | Generate a request body.

This generator creates a request body by generating a value according
to the body schema and encoding it as JSON. The content type is preserved
from the resolved request body definition.

=== Parameters

* @body@ - The 'ResolvedRequestBody' to generate content for

=== Return Value

Returns a 'Gen' that produces a tuple of (contentType, bodyBytes).

=== Example

@
import Haskemathesis.Gen.Request (genRequestBody)
import Haskemathesis.OpenApi.Types (ResolvedRequestBody(..))

let bodyDef = ResolvedRequestBody
        { rbContentType = &quot;application/json&quot;
        , rbSchema = ...
        }
(contentType, bodyBytes) &lt;- genRequestBody bodyDef
@
-}</span></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Haskemathesis.Gen.Request.html#genRequestBody"><span class="hs-identifier hs-type">genRequestBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedRequestBody"><span class="hs-identifier hs-type">ResolvedRequestBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#MediaType"><span class="hs-identifier hs-type">MediaType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span id="genRequestBody"><span class="annot"><span class="annottext">genRequestBody :: ResolvedRequestBody -&gt; GenT Identity (Text, ByteString)
</span><a href="Haskemathesis.Gen.Request.html#genRequestBody"><span class="hs-identifier hs-var hs-var">genRequestBody</span></a></span></span><span> </span><span id="local-6989586621679243634"><span class="annot"><span class="annottext">ResolvedRequestBody
</span><a href="#local-6989586621679243634"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679243635"><span class="annot"><a href="#local-6989586621679243635"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Gen Value
</span><a href="Haskemathesis.Gen.Core.html#genFromSchema"><span class="hs-identifier hs-var">genFromSchema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedRequestBody -&gt; Schema
</span><a href="Haskemathesis.OpenApi.Types.html#rbSchema"><span class="hs-identifier hs-var">rbSchema</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedRequestBody
</span><a href="#local-6989586621679243634"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#rbContentType"><span class="hs-identifier hs-var">rbContentType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243634"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LBS.toStrict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html#encode"><span class="hs-identifier hs-type">encode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243635"><span class="hs-identifier hs-type">value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Haskemathesis.Gen.Request.html#partitionParams"><span class="hs-identifier hs-type">partitionParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ParamLocation"><span class="hs-identifier hs-type">ParamLocation</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.Header.html#HeaderName"><span class="hs-identifier hs-type">HeaderName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span id="partitionParams"><span class="annot"><span class="annottext">partitionParams :: [(ParamLocation, (Text, Text))]
-&gt; ([(Text, Text)], [(Text, Text)], [(HeaderName, ByteString)])
</span><a href="Haskemathesis.Gen.Request.html#partitionParams"><span class="hs-identifier hs-var hs-var">partitionParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">((ParamLocation, (Text, Text))
 -&gt; ([(Text, Text)], [(Text, Text)], [(HeaderName, ByteString)])
 -&gt; ([(Text, Text)], [(Text, Text)], [(HeaderName, ByteString)]))
-&gt; ([(Text, Text)], [(Text, Text)], [(HeaderName, ByteString)])
-&gt; [(ParamLocation, (Text, Text))]
-&gt; ([(Text, Text)], [(Text, Text)], [(HeaderName, ByteString)])
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(ParamLocation, (Text, Text))
-&gt; ([(Text, Text)], [(Text, Text)], [(HeaderName, ByteString)])
-&gt; ([(Text, Text)], [(Text, Text)], [(HeaderName, ByteString)])
</span><a href="#local-6989586621679243640"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679243640"><span class="annot"><span class="annottext">step :: (ParamLocation, (Text, Text))
-&gt; ([(Text, Text)], [(Text, Text)], [(HeaderName, ByteString)])
-&gt; ([(Text, Text)], [(Text, Text)], [(HeaderName, ByteString)])
</span><a href="#local-6989586621679243640"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679243641"><span class="annot"><span class="annottext">ParamLocation
</span><a href="#local-6989586621679243641"><span class="hs-identifier hs-var">location</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679243642"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243642"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679243643"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243643"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679243644"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243644"><span class="hs-identifier hs-var">paths</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679243645"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243645"><span class="hs-identifier hs-var">queries</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679243646"><span class="annot"><span class="annottext">[(HeaderName, ByteString)]
</span><a href="#local-6989586621679243646"><span class="hs-identifier hs-var">headers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="#local-6989586621679243641"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>            </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#ParamPath"><span class="hs-identifier hs-var">ParamPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243642"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243643"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text, Text) -&gt; [(Text, Text)] -&gt; [(Text, Text)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243644"><span class="hs-identifier hs-var">paths</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243645"><span class="hs-identifier hs-var">queries</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(HeaderName, ByteString)]
</span><a href="#local-6989586621679243646"><span class="hs-identifier hs-var">headers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#ParamQuery"><span class="hs-identifier hs-var">ParamQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243644"><span class="hs-identifier hs-var">paths</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243642"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243643"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text, Text) -&gt; [(Text, Text)] -&gt; [(Text, Text)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243645"><span class="hs-identifier hs-var">queries</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(HeaderName, ByteString)]
</span><a href="#local-6989586621679243646"><span class="hs-identifier hs-var">headers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>            </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#ParamHeader"><span class="hs-identifier hs-var">ParamHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243644"><span class="hs-identifier hs-var">paths</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243645"><span class="hs-identifier hs-var">queries</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (HeaderName, ByteString)
</span><a href="Haskemathesis.Gen.Request.html#toHeader"><span class="hs-identifier hs-var">toHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243642"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243643"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">(HeaderName, ByteString)
-&gt; [(HeaderName, ByteString)] -&gt; [(HeaderName, ByteString)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(HeaderName, ByteString)]
</span><a href="#local-6989586621679243646"><span class="hs-identifier hs-var">headers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>            </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="Haskemathesis.OpenApi.Types.html#ParamCookie"><span class="hs-identifier hs-var">ParamCookie</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243644"><span class="hs-identifier hs-var">paths</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679243645"><span class="hs-identifier hs-var">queries</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(HeaderName, ByteString)]
</span><a href="#local-6989586621679243646"><span class="hs-identifier hs-var">headers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Haskemathesis.Gen.Request.html#toHeader"><span class="hs-identifier hs-type">toHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.Header.html#HeaderName"><span class="hs-identifier hs-type">HeaderName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span id="toHeader"><span class="annot"><span class="annottext">toHeader :: Text -&gt; Text -&gt; (HeaderName, ByteString)
</span><a href="Haskemathesis.Gen.Request.html#toHeader"><span class="hs-identifier hs-var hs-var">toHeader</span></a></span></span><span> </span><span id="local-6989586621679243652"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243652"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679243653"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243653"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; HeaderName
forall s. FoldCase s =&gt; s -&gt; CI s
</span><a href="file:///nix/store/j3bcnc7r5q4sz7xij5naq8pf2zh1xr44-case-insensitive-1.2.1.0-doc/share/doc/case-insensitive-1.2.1.0/html/src/Data.CaseInsensitive.Internal.html#mk"><span class="hs-identifier hs-var">CI.mk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243652"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243653"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Haskemathesis.Gen.Request.html#interpolatePath"><span class="hs-identifier hs-type">interpolatePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-166"></span><span id="interpolatePath"><span class="annot"><span class="annottext">interpolatePath :: Text -&gt; [(Text, Text)] -&gt; Text
</span><a href="Haskemathesis.Gen.Request.html#interpolatePath"><span class="hs-identifier hs-var hs-var">interpolatePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">(Text -&gt; (Text, Text) -&gt; Text) -&gt; Text -&gt; [(Text, Text)] -&gt; Text
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Text, Text) -&gt; Text
</span><a href="#local-6989586621679243656"><span class="hs-identifier hs-var">replace</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679243656"><span class="annot"><span class="annottext">replace :: Text -&gt; (Text, Text) -&gt; Text
</span><a href="#local-6989586621679243656"><span class="hs-identifier hs-var hs-var">replace</span></a></span></span><span> </span><span id="local-6989586621679243664"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243664"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679243665"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243665"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679243666"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243666"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">HasCallStack =&gt; Text -&gt; Text -&gt; Text -&gt; Text
Text -&gt; Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.replace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243665"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Haskemathesis.Gen.Request.html#encodePathSegment"><span class="hs-identifier hs-var">encodePathSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243666"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243664"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Haskemathesis.Gen.Request.html#encodePathSegment"><span class="hs-identifier hs-type">encodePathSegment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-173"></span><span id="encodePathSegment"><span class="annot"><span class="annottext">encodePathSegment :: Text -&gt; Text
</span><a href="Haskemathesis.Gen.Request.html#encodePathSegment"><span class="hs-identifier hs-var hs-var">encodePathSegment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; (Text -&gt; ByteString) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ByteString -&gt; ByteString
</span><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.URI.html#urlEncode"><span class="hs-identifier hs-var">urlEncode</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Haskemathesis.Gen.Request.html#renderValue"><span class="hs-identifier hs-type">renderValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-176"></span><span id="renderValue"><span class="annot"><span class="annottext">renderValue :: Value -&gt; Text
</span><a href="Haskemathesis.Gen.Request.html#renderValue"><span class="hs-identifier hs-var hs-var">renderValue</span></a></span></span><span> </span><span id="local-6989586621679243670"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679243670"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679243670"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621679243672"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243672"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243672"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span id="local-6989586621679243674"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679243674"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scientific -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679243674"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">Null</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;null&quot;</span></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><span class="annottext">Array
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243680"><span class="hs-identifier hs-var">jsonText</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679243680"><span class="hs-identifier hs-var">jsonText</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679243680"><span class="annot"><span class="annottext">jsonText :: Text
</span><a href="#local-6989586621679243680"><span class="hs-identifier hs-var hs-var">jsonText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LazyByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">LBS.toStrict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; LazyByteString
forall a. ToJSON a =&gt; a -&gt; LazyByteString
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679243670"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span></pre></body></html>