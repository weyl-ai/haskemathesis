<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | Tasty integration helpers for generated properties.

This module provides convenient functions for integrating Haskemathesis
properties with the Tasty test framework. It handles the conversion
of generated properties into Tasty 'TestTree' values.

=== Basic Usage

Create a Tasty test suite from an OpenAPI spec:

@
import Test.Tasty (defaultMain)
import Haskemathesis.Integration.Tasty (testTreeForApp)
import Haskemathesis.Check.Standard (defaultChecks)
import Data.OpenApi (OpenApi)

main :: IO ()
main = do
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let app = myWaiApplication
        tests = testTreeForApp Nothing defaultChecks spec app
    defaultMain tests
@

=== With Custom Configuration

For more control, use the configuration-based functions:

@
import Haskemathesis.Config

myConfig :: TestConfig
myConfig = defaultTestConfig
    { tcPropertyCount = 200
    , tcNegativeTesting = True
    }

tests = testTreeForAppWithConfig myConfig spec app
@

=== Testing Remote APIs

Test a running HTTP server:

@
import Network.HTTP.Client (newManager, defaultManagerSettings)

main :: IO ()
main = do
    manager &lt;- newManager defaultManagerSettings
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let tests = testTreeForUrl defaultTestConfig spec manager &quot;http://localhost:8080&quot;
    defaultMain tests
@

=== Streaming Endpoint Handling

WAI-based tests (in-memory, synchronous) cannot handle streaming endpoints
like Server-Sent Events (SSE) or NDJSON streams. These operations are
__automatically skipped__ when using 'testTreeForApp' or 'testTreeForAppWithConfig'.

To see which operations were skipped, use 'testTreeForAppIO':

@
main :: IO ()
main = do
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    (tests, skipped) &lt;- testTreeForAppIO defaultTestConfig spec myApp
    unless (null skipped) $
        hPutStrLn stderr $ &quot;Skipped streaming operations: &quot; ++ show skipped
    defaultMain tests
@

For streaming endpoints, use 'testTreeForUrl' with a running HTTP server
which properly handles timeouts.
-}</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html"><span class="hs-identifier">Haskemathesis.Integration.Tasty</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Basic Test Trees</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutor"><span class="hs-identifier">testTreeForExecutor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForApp"><span class="hs-identifier">testTreeForApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Configuration-Based Test Trees</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier">testTreeForExecutorWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppWithConfig"><span class="hs-identifier">testTreeForAppWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrl"><span class="hs-identifier">testTreeForUrl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="hs-comment">-- * WAI with Streaming Info</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppIO"><span class="hs-identifier">testTreeForAppIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppNegativeIO"><span class="hs-identifier">testTreeForAppNegativeIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Negative Testing</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier">testTreeForExecutorNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppNegative"><span class="hs-identifier">testTreeForAppNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrlNegative"><span class="hs-identifier">testTreeForUrlNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.html"><span class="hs-identifier">Data.OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier">OpenApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html"><span class="hs-identifier">Haskemathesis.Check.Standard.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier">operationLabel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html"><span class="hs-identifier">Haskemathesis.Check.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier">Check</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html"><span class="hs-identifier">Haskemathesis.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier">TestConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Http.html"><span class="hs-identifier">Haskemathesis.Execute.Http</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Http.html#executeHttpWithTimeout"><span class="hs-identifier">executeHttpWithTimeout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html"><span class="hs-identifier">Haskemathesis.Execute.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier">BaseUrl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier">ExecutorWithTimeout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Wai.html"><span class="hs-identifier">Haskemathesis.Execute.Wai</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier">executeWaiWithTimeout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Resolve.html"><span class="hs-identifier">Haskemathesis.OpenApi.Resolve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier">resolveOperations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html"><span class="hs-identifier">Haskemathesis.OpenApi.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier">ResolvedOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html"><span class="hs-identifier">Haskemathesis.Property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier">propertyForOperation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier">propertyForOperationWithConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html"><span class="hs-identifier">Hedgehog.Internal.Property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyName"><span class="hs-identifier">PropertyName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.html"><span class="hs-identifier">Network.HTTP.Client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier">Manager</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html"><span class="hs-identifier">Network.Wai</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier">Application</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hPutStrLn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stderr</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.html"><span class="hs-identifier">Test.Tasty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier">TestTree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#testGroup"><span class="hs-identifier">testGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/lvny4gcc5n9wz81pxl3la2n2lhjd119x-tasty-hedgehog-1.4.0.2-doc/share/doc/tasty-hedgehog-1.4.0.2/html/src/Test.Tasty.Hedgehog.html"><span class="hs-identifier">Test.Tasty.Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/lvny4gcc5n9wz81pxl3la2n2lhjd119x-tasty-hedgehog-1.4.0.2-doc/share/doc/tasty-hedgehog-1.4.0.2/html/src/Test.Tasty.Hedgehog.html#testPropertyNamed"><span class="hs-identifier">testPropertyNamed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' from a custom executor.

This is the most flexible way to create tests, allowing you to
provide any function that can execute 'ApiRequest' values.

=== Parameters

* @mBase@ - Optional base URL for failure reports
* @checks@ - List of 'Check' functions to validate responses
* @execute@ - Your custom executor function
* @ops@ - List of operations to test (from 'resolveOperations')

=== Example

@
myExecutor :: ApiRequest -&gt; IO ApiResponse
myExecutor req = ... -- your custom logic

tests = testTreeForExecutor Nothing defaultChecks myExecutor ops
@
-}</span></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutor"><span class="hs-identifier hs-type">testTreeForExecutor</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-147"></span><span id="testTreeForExecutor"><span class="annot"><span class="annottext">testTreeForExecutor :: Maybe BaseUrl
-&gt; [Check]
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutor"><span class="hs-identifier hs-var hs-var">testTreeForExecutor</span></a></span></span><span> </span><span id="local-6989586621679227844"><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679227844"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679227845"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679227845"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679227846"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679227846"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679227847"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227847"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; [TestTree] -&gt; TestTree
</span><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#testGroup"><span class="hs-identifier hs-var">testGroup</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;OpenAPI Conformance&quot;</span></span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PropertyName -&gt; Property -&gt; TestTree
</span><a href="file:///nix/store/lvny4gcc5n9wz81pxl3la2n2lhjd119x-tasty-hedgehog-1.4.0.2-doc/share/doc/tasty-hedgehog-1.4.0.2/html/src/Test.Tasty.Hedgehog.html#testPropertyNamed"><span class="hs-identifier hs-var">testPropertyNamed</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679227848"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; PropertyName
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyName"><span class="hs-identifier hs-var">PropertyName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679227848"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe BaseUrl
-&gt; [Check] -&gt; ExecutorWithTimeout -&gt; ResolvedOperation -&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier hs-var">propertyForOperation</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679227844"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679227845"><span class="hs-identifier hs-var">checks</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679227846"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679227850"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679227850"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679227850"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227847"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227848"><span class="annot"><span class="annottext">name :: [Char]
</span><a href="#local-6989586621679227848"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseUrl -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; BaseUrl
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679227850"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' from a WAI 'Application'.

This is a convenient way to test a WAI application (e.g., Servant,
Yesod, or any other WAI-based framework) without starting a
real HTTP server.

__Note:__ Streaming operations (SSE, NDJSON) are automatically filtered
out because WAI testing is synchronous and cannot handle streaming
responses. Use 'testTreeForAppIO' if you need to know which operations
were skipped.

=== Parameters

* @mBase@ - Optional base URL for failure reports
* @checks@ - List of 'Check' functions to validate responses
* @openApi@ - The OpenAPI specification
* @app@ - Your WAI 'Application'

=== Example

@
import Network.Wai (Application)

myApp :: Application
myApp = ... -- your WAI application

main :: IO ()
main = do
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let tests = testTreeForApp Nothing defaultChecks spec myApp
    defaultMain tests
@
-}</span></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForApp"><span class="hs-identifier hs-type">testTreeForApp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-194"></span><span id="testTreeForApp"><span class="annot"><span class="annottext">testTreeForApp :: Maybe BaseUrl -&gt; [Check] -&gt; OpenApi -&gt; Application -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForApp"><span class="hs-identifier hs-var hs-var">testTreeForApp</span></a></span></span><span> </span><span id="local-6989586621679227852"><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679227852"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679227853"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679227853"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679227854"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227854"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679227855"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227855"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227856"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679227856"><span class="hs-identifier hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227854"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679227857"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227857"><span class="hs-identifier hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227858"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227858"><span class="hs-identifier hs-var">_skipped</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Tasty.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227856"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-197"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Maybe BaseUrl
-&gt; [Check]
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutor"><span class="hs-identifier hs-var">testTreeForExecutor</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679227852"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679227853"><span class="hs-identifier hs-var">checks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227855"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227857"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' with full configuration support.

This function provides the most flexibility for creating test trees.
It accepts a 'TestConfig' for authentication, filtering, and
other advanced options.

=== Parameters

* @openApi@ - The OpenAPI specification
* @config@ - The 'TestConfig' controlling test generation
* @execute@ - Function to execute requests
* @ops@ - List of operations to test

=== Example

@
config = defaultTestConfig
    { tcPropertyCount = 200
    , tcAuthConfig = Just myAuthConfig
    }

tests = testTreeForExecutorWithConfig spec config executor ops
@
-}</span></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-type">testTreeForExecutorWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-229"></span><span id="testTreeForExecutorWithConfig"><span class="annot"><span class="annottext">testTreeForExecutorWithConfig :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-var hs-var">testTreeForExecutorWithConfig</span></a></span></span><span> </span><span id="local-6989586621679227861"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227861"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679227862"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227862"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679227863"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679227863"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679227864"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227864"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; [TestTree] -&gt; TestTree
</span><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#testGroup"><span class="hs-identifier hs-var">testGroup</span></a></span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;OpenAPI Conformance&quot;</span></span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PropertyName -&gt; Property -&gt; TestTree
</span><a href="file:///nix/store/lvny4gcc5n9wz81pxl3la2n2lhjd119x-tasty-hedgehog-1.4.0.2-doc/share/doc/tasty-hedgehog-1.4.0.2/html/src/Test.Tasty.Hedgehog.html#testPropertyNamed"><span class="hs-identifier hs-var">testPropertyNamed</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679227865"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; PropertyName
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyName"><span class="hs-identifier hs-var">PropertyName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679227865"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier hs-var">propertyForOperationWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227861"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227862"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679227863"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679227866"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679227866"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679227866"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227864"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcOperationFilter"><span class="hs-identifier hs-var">tcOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227862"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679227866"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227865"><span class="annot"><span class="annottext">name :: [Char]
</span><a href="#local-6989586621679227865"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseUrl -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; BaseUrl
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679227866"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' from a WAI 'Application' with configuration.

Combines 'testTreeForExecutorWithConfig' with 'executeWai' for
convenient testing of WAI applications.

__Note:__ Streaming operations (SSE, NDJSON) are automatically filtered
out because WAI testing is synchronous and cannot handle streaming
responses. Use 'testTreeForAppIO' if you need to know which operations
were skipped.

=== Parameters

* @config@ - The 'TestConfig' controlling test generation
* @openApi@ - The OpenAPI specification
* @app@ - Your WAI 'Application'

=== Example

@
config = defaultTestConfig { tcPropertyCount = 200 }
tests = testTreeForAppWithConfig config spec myApp
@
-}</span></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppWithConfig"><span class="hs-identifier hs-type">testTreeForAppWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-266"></span><span id="testTreeForAppWithConfig"><span class="annot"><span class="annottext">testTreeForAppWithConfig :: TestConfig -&gt; OpenApi -&gt; Application -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppWithConfig"><span class="hs-identifier hs-var hs-var">testTreeForAppWithConfig</span></a></span></span><span> </span><span id="local-6989586621679227868"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227868"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679227869"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227869"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679227870"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227870"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227871"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679227871"><span class="hs-identifier hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227869"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679227872"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227872"><span class="hs-identifier hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227873"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227873"><span class="hs-identifier hs-var">_skipped</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Tasty.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227871"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-269"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-var">testTreeForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227869"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227868"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227870"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227872"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' for testing a running HTTP server.

This function creates tests that execute against a live HTTP server
at the specified base URL.

=== Parameters

* @config@ - The 'TestConfig' controlling test generation
* @openApi@ - The OpenAPI specification
* @manager@ - HTTP connection manager
* @baseUrl@ - Base URL of the running server (e.g., &quot;http://localhost:8080&quot;)

=== Example

@
import Network.HTTP.Client (newManager, defaultManagerSettings)

main :: IO ()
main = do
    manager &lt;- newManager defaultManagerSettings
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let tests = testTreeForUrl defaultTestConfig spec manager &quot;http://localhost:8080&quot;
    defaultMain tests
@
-}</span></span><span>
</span><span id="line-296"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrl"><span class="hs-identifier hs-type">testTreeForUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-302"></span><span id="testTreeForUrl"><span class="annot"><span class="annottext">testTreeForUrl :: TestConfig -&gt; OpenApi -&gt; Manager -&gt; BaseUrl -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrl"><span class="hs-identifier hs-var hs-var">testTreeForUrl</span></a></span></span><span> </span><span id="local-6989586621679227874"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227874"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679227875"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227875"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679227876"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679227876"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679227877"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679227877"><span class="hs-identifier hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227878"><span class="annot"><span class="annottext">config' :: TestConfig
</span><a href="#local-6989586621679227878"><span class="hs-identifier hs-var hs-var">config'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227874"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679227877"><span class="hs-identifier hs-type">baseUrl</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-304"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-var">testTreeForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227875"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227878"><span class="hs-identifier hs-var">config'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; BaseUrl -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Http.html#executeHttpWithTimeout"><span class="hs-identifier hs-var">executeHttpWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679227876"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679227877"><span class="hs-identifier hs-var">baseUrl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227875"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' for negative testing with a custom executor.

Negative testing generates invalid requests to verify that the API
properly rejects them with appropriate error responses.

=== Parameters

* @openApi@ - The OpenAPI specification
* @config@ - The 'TestConfig' (negative testing flag is ignored, always enabled)
* @execute@ - Function to execute requests
* @ops@ - List of operations to test

=== Example

@
-- Test that invalid requests are properly rejected
negTests = testTreeForExecutorNegative spec config executor ops
@
-}</span></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier hs-type">testTreeForExecutorNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-331"></span><span id="testTreeForExecutorNegative"><span class="annot"><span class="annottext">testTreeForExecutorNegative :: OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier hs-var hs-var">testTreeForExecutorNegative</span></a></span></span><span> </span><span id="local-6989586621679227880"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227880"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679227881"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227881"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679227882"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679227882"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679227883"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227883"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227884"><span class="annot"><span class="annottext">config' :: TestConfig
</span><a href="#local-6989586621679227884"><span class="hs-identifier hs-var hs-var">config'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227881"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcNegativeTesting"><span class="hs-identifier hs-var">tcNegativeTesting</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">}</span><span>
</span><span id="line-333"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-var">testTreeForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227880"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227884"><span class="hs-identifier hs-var">config'</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679227882"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227883"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' for negative testing with a WAI application.

Convenience function that combines 'testTreeForExecutorNegative' with
'executeWai' for testing WAI applications.

__Note:__ Streaming operations (SSE, NDJSON) are automatically filtered
out because WAI testing is synchronous and cannot handle streaming
responses. Use 'testTreeForAppNegativeIO' if you need to know which
operations were skipped.

=== Parameters

* @config@ - The 'TestConfig'
* @openApi@ - The OpenAPI specification
* @app@ - Your WAI 'Application'

=== Example

@
negTests = testTreeForAppNegative defaultTestConfig spec myApp
@
-}</span></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppNegative"><span class="hs-identifier hs-type">testTreeForAppNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-362"></span><span id="testTreeForAppNegative"><span class="annot"><span class="annottext">testTreeForAppNegative :: TestConfig -&gt; OpenApi -&gt; Application -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppNegative"><span class="hs-identifier hs-var hs-var">testTreeForAppNegative</span></a></span></span><span> </span><span id="local-6989586621679227886"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227886"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679227887"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227887"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679227888"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227888"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227889"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679227889"><span class="hs-identifier hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227887"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-364"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679227890"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227890"><span class="hs-identifier hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227891"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227891"><span class="hs-identifier hs-var">_skipped</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Tasty.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227889"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-365"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier hs-var">testTreeForExecutorNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227887"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227886"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227888"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227890"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' for negative testing against a live server.

Convenience function for running negative tests against a running
HTTP server at the specified base URL.

=== Parameters

* @config@ - The 'TestConfig'
* @openApi@ - The OpenAPI specification
* @manager@ - HTTP connection manager
* @baseUrl@ - Base URL of the running server

=== Example

@
import Network.HTTP.Client (newManager, defaultManagerSettings)

main :: IO ()
main = do
    manager &lt;- newManager defaultManagerSettings
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let negTests = testTreeForUrlNegative defaultTestConfig spec manager &quot;http://localhost:8080&quot;
    defaultMain negTests
@
-}</span></span><span>
</span><span id="line-392"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrlNegative"><span class="hs-identifier hs-type">testTreeForUrlNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-398"></span><span id="testTreeForUrlNegative"><span class="annot"><span class="annottext">testTreeForUrlNegative :: TestConfig -&gt; OpenApi -&gt; Manager -&gt; BaseUrl -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrlNegative"><span class="hs-identifier hs-var hs-var">testTreeForUrlNegative</span></a></span></span><span> </span><span id="local-6989586621679227892"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227892"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679227893"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227893"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679227894"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679227894"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679227895"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679227895"><span class="hs-identifier hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier hs-var">testTreeForExecutorNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227893"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227892"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679227895"><span class="hs-identifier hs-type">baseUrl</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; BaseUrl -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Http.html#executeHttpWithTimeout"><span class="hs-identifier hs-var">executeHttpWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679227894"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679227895"><span class="hs-identifier hs-var">baseUrl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227893"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- WAI IO variants (with streaming operation info)</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' from a WAI 'Application', returning skipped operations.

Like 'testTreeForAppWithConfig', but returns the list of operations that were
skipped due to being streaming endpoints. Also prints a warning to stderr
if any operations are skipped.

Streaming operations (SSE, NDJSON) cannot be tested with WAI because WAI
testing is synchronous and in-memory. For streaming endpoints, use
'testTreeForUrl' with a running HTTP server.

=== Parameters

* @config@ - The 'TestConfig' controlling test generation
* @openApi@ - The OpenAPI specification
* @app@ - Your WAI 'Application'

=== Return Value

Returns a tuple of:

* The 'TestTree' for non-streaming operations
* List of operation labels that were skipped (streaming operations)

=== Example

@
main :: IO ()
main = do
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    (tests, skipped) &lt;- testTreeForAppIO defaultTestConfig spec myApp
    unless (null skipped) $
        putStrLn $ &quot;Note: &quot; ++ show (length skipped) ++ &quot; streaming ops skipped&quot;
    defaultMain tests
@
-}</span></span><span>
</span><span id="line-440"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppIO"><span class="hs-identifier hs-type">testTreeForAppIO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-441"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span id="testTreeForAppIO"><span class="annot"><span class="annottext">testTreeForAppIO :: TestConfig -&gt; OpenApi -&gt; Application -&gt; IO (TestTree, [BaseUrl])
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppIO"><span class="hs-identifier hs-var hs-var">testTreeForAppIO</span></a></span></span><span> </span><span id="local-6989586621679227896"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227896"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679227897"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227897"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679227898"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227898"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227899"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679227899"><span class="hs-identifier hs-var hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227897"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679227900"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227900"><span class="hs-identifier hs-var hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227901"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227901"><span class="hs-identifier hs-var hs-var">streaming</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Tasty.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227899"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-448"></span><span>        </span><span id="local-6989586621679227902"><span class="annot"><span class="annottext">skippedLabels :: [BaseUrl]
</span><a href="#local-6989586621679227902"><span class="hs-identifier hs-var hs-var hs-var">skippedLabels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; BaseUrl) -&gt; [ResolvedOperation] -&gt; [BaseUrl]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; BaseUrl
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227901"><span class="hs-identifier hs-var">streaming</span></a></span><span>
</span><span id="line-449"></span><span>        </span><span id="local-6989586621679227903"><span class="annot"><span class="annottext">tree :: TestTree
</span><a href="#local-6989586621679227903"><span class="hs-identifier hs-var hs-var hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-var">testTreeForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227897"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227896"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227898"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227900"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><span class="annottext">[BaseUrl] -&gt; IO ()
</span><a href="Haskemathesis.Integration.Tasty.html#warnSkippedStreaming"><span class="hs-identifier hs-var">warnSkippedStreaming</span></a></span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679227902"><span class="hs-identifier hs-var">skippedLabels</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><span class="annottext">(TestTree, [BaseUrl]) -&gt; IO (TestTree, [BaseUrl])
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679227903"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679227902"><span class="hs-identifier hs-var">skippedLabels</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="annot"><span class="hs-comment">{- | Create a negative testing 'TestTree' from a WAI 'Application', returning skipped operations.

Like 'testTreeForAppNegative', but returns the list of operations that were
skipped due to being streaming endpoints. Also prints a warning to stderr
if any operations are skipped.

=== Parameters

* @config@ - The 'TestConfig'
* @openApi@ - The OpenAPI specification
* @app@ - Your WAI 'Application'

=== Return Value

Returns a tuple of:

* The 'TestTree' for non-streaming operations (negative tests)
* List of operation labels that were skipped (streaming operations)
-}</span></span><span>
</span><span id="line-472"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppNegativeIO"><span class="hs-identifier hs-type">testTreeForAppNegativeIO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-476"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span id="testTreeForAppNegativeIO"><span class="annot"><span class="annottext">testTreeForAppNegativeIO :: TestConfig -&gt; OpenApi -&gt; Application -&gt; IO (TestTree, [BaseUrl])
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppNegativeIO"><span class="hs-identifier hs-var hs-var">testTreeForAppNegativeIO</span></a></span></span><span> </span><span id="local-6989586621679227905"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227905"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679227906"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227906"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679227907"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227907"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227908"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679227908"><span class="hs-identifier hs-var hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227906"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-479"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679227909"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227909"><span class="hs-identifier hs-var hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227910"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227910"><span class="hs-identifier hs-var hs-var">streaming</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Tasty.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227908"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-480"></span><span>        </span><span id="local-6989586621679227911"><span class="annot"><span class="annottext">skippedLabels :: [BaseUrl]
</span><a href="#local-6989586621679227911"><span class="hs-identifier hs-var hs-var hs-var">skippedLabels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; BaseUrl) -&gt; [ResolvedOperation] -&gt; [BaseUrl]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; BaseUrl
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227910"><span class="hs-identifier hs-var">streaming</span></a></span><span>
</span><span id="line-481"></span><span>        </span><span id="local-6989586621679227912"><span class="annot"><span class="annottext">tree :: TestTree
</span><a href="#local-6989586621679227912"><span class="hs-identifier hs-var hs-var hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier hs-var">testTreeForExecutorNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679227906"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679227905"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679227907"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679227909"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><span class="annottext">[BaseUrl] -&gt; IO ()
</span><a href="Haskemathesis.Integration.Tasty.html#warnSkippedStreaming"><span class="hs-identifier hs-var">warnSkippedStreaming</span></a></span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679227911"><span class="hs-identifier hs-var">skippedLabels</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span class="annot"><span class="annottext">(TestTree, [BaseUrl]) -&gt; IO (TestTree, [BaseUrl])
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679227912"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679227911"><span class="hs-identifier hs-var">skippedLabels</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- Helpers</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="annot"><span class="hs-comment">-- | Partition operations into (non-streaming, streaming).</span></span><span>
</span><span id="line-490"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#partitionStreamingOps"><span class="hs-identifier hs-type">partitionStreamingOps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span id="partitionStreamingOps"><span class="annot"><span class="annottext">partitionStreamingOps :: [ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Tasty.html#partitionStreamingOps"><span class="hs-identifier hs-var hs-var">partitionStreamingOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation]
-&gt; ([ResolvedOperation], [ResolvedOperation])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (ResolvedOperation -&gt; Bool) -&gt; ResolvedOperation -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.OpenApi.Types.html#roIsStreaming"><span class="hs-identifier hs-var">roIsStreaming</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="annot"><span class="hs-comment">-- | Print a warning to stderr if any streaming operations were skipped.</span></span><span>
</span><span id="line-494"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#warnSkippedStreaming"><span class="hs-identifier hs-type">warnSkippedStreaming</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span id="warnSkippedStreaming"><span class="annot"><span class="annottext">warnSkippedStreaming :: [BaseUrl] -&gt; IO ()
</span><a href="Haskemathesis.Integration.Tasty.html#warnSkippedStreaming"><span class="hs-identifier hs-var hs-var">warnSkippedStreaming</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#warnSkippedStreaming"><span class="hs-identifier hs-var">warnSkippedStreaming</span></a></span><span> </span><span id="local-6989586621679227916"><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679227916"><span class="hs-identifier hs-var">skipped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227921"><span class="annot"><span class="annottext">count :: Int
</span><a href="#local-6989586621679227921"><span class="hs-identifier hs-var hs-var hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; BaseUrl -&gt; Int) -&gt; Int -&gt; [BaseUrl] -&gt; Int
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679227923"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227923"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227923"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679227916"><span class="hs-identifier hs-var">skipped</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; [Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-499"></span><span>        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;[haskemathesis] Skipping &quot;</span></span><span>
</span><span id="line-500"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227921"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-501"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; streaming operation(s) (WAI executor cannot handle streaming):&quot;</span></span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><span class="annottext">(BaseUrl -&gt; IO ()) -&gt; [BaseUrl] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; [Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; (BaseUrl -&gt; [Char]) -&gt; BaseUrl -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  - &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (BaseUrl -&gt; [Char]) -&gt; BaseUrl -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BaseUrl -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679227916"><span class="hs-identifier hs-var">skipped</span></a></span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; [Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  Use testTreeForUrl with a live HTTP server to test streaming endpoints.&quot;</span></span><span>
</span><span id="line-504"></span></pre></body></html>