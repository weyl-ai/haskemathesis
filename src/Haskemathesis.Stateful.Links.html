<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | OpenAPI Links parsing and resolution.

This module extracts link definitions from OpenAPI specs and converts them
into our internal OperationLink representation for stateful testing.

OpenAPI links define relationships between operations, specifying how the
response from one operation can provide parameters for another operation.
-}</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html"><span class="hs-identifier">Haskemathesis.Stateful.Links</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Link extraction</span></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#extractLinks"><span class="hs-identifier">extractLinks</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#extractLinksFromOperation"><span class="hs-identifier">extractLinksFromOperation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Expression parsing</span></span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#parseExpression"><span class="hs-identifier">parseExpression</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#parseRuntimeExpression"><span class="hs-identifier">parseRuntimeExpression</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Target resolution</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#resolveOperationId"><span class="hs-identifier">resolveOperationId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#findOperationById"><span class="hs-identifier">findOperationById</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Helpers</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#expressionOrValueToSource"><span class="hs-identifier">expressionOrValueToSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#decodeJsonPointer"><span class="hs-identifier">decodeJsonPointer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#parseOperationRef"><span class="hs-identifier">parseOperationRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier">String</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IOHM</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.html"><span class="hs-identifier">Data.OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Components"><span class="hs-identifier">Components</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Link"><span class="hs-identifier">Link</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier">OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Operation"><span class="hs-identifier">Operation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#PathItem"><span class="hs-identifier">PathItem</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Reference"><span class="hs-identifier">Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier">Referenced</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Response"><span class="hs-identifier">Response</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Responses"><span class="hs-identifier">Responses</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html"><span class="hs-identifier">Data.OpenApi.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ExpressionOrValue"><span class="hs-identifier">ExpressionOrValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html"><span class="hs-identifier">Haskemathesis.Stateful.Types</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier">OperationLink</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#ParameterBinding"><span class="hs-identifier">ParameterBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#ValueSource"><span class="hs-identifier">ValueSource</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="annot"><span class="hs-comment">{- | Extract all links from an OpenAPI specification.

This traverses all paths, operations, and responses to find link definitions.
Each link is converted to an OperationLink with the source operation
identified by path and method.
-}</span></span><span>
</span><span id="line-60"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#extractLinks"><span class="hs-identifier hs-type">extractLinks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span id="extractLinks"><span class="annot"><span class="annottext">extractLinks :: OpenApi -&gt; [OperationLink]
</span><a href="Haskemathesis.Stateful.Links.html#extractLinks"><span class="hs-identifier hs-var hs-var">extractLinks</span></a></span></span><span> </span><span id="local-6989586621679240132"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240132"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[OperationLink]] -&gt; [OperationLink]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[OperationLink]] -&gt; [OperationLink])
-&gt; [[OperationLink]] -&gt; [OperationLink]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679240134"><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240135"><span class="annot"><a href="#local-6989586621679240135"><span class="hs-identifier hs-var">pathItem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap FilePath PathItem -&gt; [(FilePath, PathItem)]
forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html#toList"><span class="hs-identifier hs-var">IOHM.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; InsOrdHashMap FilePath PathItem
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_openApiPaths"><span class="hs-identifier hs-var">_openApiPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240132"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679240138"><span class="annot"><a href="#local-6989586621679240138"><span class="hs-identifier hs-var">method</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240139"><span class="annot"><a href="#local-6989586621679240139"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#getOperationsWithMethod"><span class="hs-identifier hs-type">getOperationsWithMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240135"><span class="hs-identifier hs-type">pathItem</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#extractLinksFromOperation"><span class="hs-identifier hs-type">extractLinksFromOperation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240132"><span class="hs-identifier hs-type">spec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.pack</span></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">path</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679240138"><span class="hs-identifier hs-type">method</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240139"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="annot"><span class="hs-comment">-- | Get all operations from a PathItem with their HTTP methods.</span></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#getOperationsWithMethod"><span class="hs-identifier hs-type">getOperationsWithMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#PathItem"><span class="hs-identifier hs-type">PathItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span id="getOperationsWithMethod"><span class="annot"><span class="annottext">getOperationsWithMethod :: PathItem -&gt; [(Text, Operation)]
</span><a href="Haskemathesis.Stateful.Links.html#getOperationsWithMethod"><span class="hs-identifier hs-var hs-var">getOperationsWithMethod</span></a></span></span><span> </span><span id="local-6989586621679240142"><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240142"><span class="hs-identifier hs-var">pathItem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">[Maybe (Text, Operation)] -&gt; [(Text, Operation)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-70"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;GET&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; (Text, Operation))
-&gt; Maybe Operation -&gt; Maybe (Text, Operation)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; Maybe Operation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_pathItemGet"><span class="hs-identifier hs-var">_pathItemGet</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240142"><span class="hs-identifier hs-var">pathItem</span></a></span><span>
</span><span id="line-71"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;PUT&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; (Text, Operation))
-&gt; Maybe Operation -&gt; Maybe (Text, Operation)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; Maybe Operation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_pathItemPut"><span class="hs-identifier hs-var">_pathItemPut</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240142"><span class="hs-identifier hs-var">pathItem</span></a></span><span>
</span><span id="line-72"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; (Text, Operation))
-&gt; Maybe Operation -&gt; Maybe (Text, Operation)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; Maybe Operation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_pathItemPost"><span class="hs-identifier hs-var">_pathItemPost</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240142"><span class="hs-identifier hs-var">pathItem</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;DELETE&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; (Text, Operation))
-&gt; Maybe Operation -&gt; Maybe (Text, Operation)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; Maybe Operation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_pathItemDelete"><span class="hs-identifier hs-var">_pathItemDelete</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240142"><span class="hs-identifier hs-var">pathItem</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;OPTIONS&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; (Text, Operation))
-&gt; Maybe Operation -&gt; Maybe (Text, Operation)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; Maybe Operation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_pathItemOptions"><span class="hs-identifier hs-var">_pathItemOptions</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240142"><span class="hs-identifier hs-var">pathItem</span></a></span><span>
</span><span id="line-75"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;HEAD&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; (Text, Operation))
-&gt; Maybe Operation -&gt; Maybe (Text, Operation)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; Maybe Operation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_pathItemHead"><span class="hs-identifier hs-var">_pathItemHead</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240142"><span class="hs-identifier hs-var">pathItem</span></a></span><span>
</span><span id="line-76"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;PATCH&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; (Text, Operation))
-&gt; Maybe Operation -&gt; Maybe (Text, Operation)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; Maybe Operation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_pathItemPatch"><span class="hs-identifier hs-var">_pathItemPatch</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240142"><span class="hs-identifier hs-var">pathItem</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;TRACE&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; (Text, Operation))
-&gt; Maybe Operation -&gt; Maybe (Text, Operation)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; Maybe Operation
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_pathItemTrace"><span class="hs-identifier hs-var">_pathItemTrace</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240142"><span class="hs-identifier hs-var">pathItem</span></a></span><span>
</span><span id="line-78"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><span class="hs-comment">-- | Extract links from a single operation.</span></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#extractLinksFromOperation"><span class="hs-identifier hs-type">extractLinksFromOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Path</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Method</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span id="extractLinksFromOperation"><span class="annot"><span class="annottext">extractLinksFromOperation :: OpenApi -&gt; Text -&gt; Text -&gt; Operation -&gt; [OperationLink]
</span><a href="Haskemathesis.Stateful.Links.html#extractLinksFromOperation"><span class="hs-identifier hs-var hs-var">extractLinksFromOperation</span></a></span></span><span> </span><span id="local-6989586621679240152"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240152"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span id="local-6989586621679240153"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240153"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679240154"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240154"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621679240155"><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621679240155"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240156"><span class="annot"><span class="annottext">responses :: Responses
</span><a href="#local-6989586621679240156"><span class="hs-identifier hs-var hs-var">responses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operation -&gt; Responses
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_operationResponses"><span class="hs-identifier hs-var">_operationResponses</span></a></span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621679240155"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span id="local-6989586621679240158"><span class="annot"><span class="annottext">sourceOpId :: Maybe Text
</span><a href="#local-6989586621679240158"><span class="hs-identifier hs-var hs-var">sourceOpId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operation -&gt; Maybe Text
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_operationOperationId"><span class="hs-identifier hs-var">_operationOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621679240155"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span id="local-6989586621679240163"><span class="annot"><span class="annottext">sourceLabel :: Text
</span><a href="#local-6989586621679240163"><span class="hs-identifier hs-var hs-var">sourceLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Text
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240154"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240153"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679240158"><span class="hs-identifier hs-var">sourceOpId</span></a></span><span>
</span><span id="line-93"></span><span>        </span><span id="local-6989586621679240164"><span class="annot"><span class="annottext">allResponses :: [Response]
</span><a href="#local-6989586621679240164"><span class="hs-identifier hs-var hs-var">allResponses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; Responses -&gt; [Response]
</span><a href="Haskemathesis.Stateful.Links.html#getAllResponses"><span class="hs-identifier hs-var">getAllResponses</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240152"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">Responses
</span><a href="#local-6989586621679240156"><span class="hs-identifier hs-var">responses</span></a></span><span>
</span><span id="line-94"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Response -&gt; [OperationLink]) -&gt; [Response] -&gt; [OperationLink]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; Text -&gt; Response -&gt; [OperationLink]
</span><a href="Haskemathesis.Stateful.Links.html#extractLinksFromResponse"><span class="hs-identifier hs-var">extractLinksFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240152"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240163"><span class="hs-identifier hs-var">sourceLabel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Response]
</span><a href="#local-6989586621679240164"><span class="hs-identifier hs-var">allResponses</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><span class="hs-comment">-- | Get all responses from a Responses object, resolving references.</span></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#getAllResponses"><span class="hs-identifier hs-type">getAllResponses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Responses"><span class="hs-identifier hs-type">Responses</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span id="getAllResponses"><span class="annot"><span class="annottext">getAllResponses :: OpenApi -&gt; Responses -&gt; [Response]
</span><a href="Haskemathesis.Stateful.Links.html#getAllResponses"><span class="hs-identifier hs-var hs-var">getAllResponses</span></a></span></span><span> </span><span id="local-6989586621679240168"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240168"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span id="local-6989586621679240169"><span class="annot"><span class="annottext">Responses
</span><a href="#local-6989586621679240169"><span class="hs-identifier hs-var">responses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240171"><span class="annot"><span class="annottext">defaultResp :: [Response]
</span><a href="#local-6989586621679240171"><span class="hs-identifier hs-var hs-var">defaultResp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Response -&gt; [Response]
forall {a}. Maybe a -&gt; [a]
</span><a href="#local-6989586621679240172"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Response -&gt; [Response]) -&gt; Maybe Response -&gt; [Response]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; Referenced Response -&gt; Maybe Response
</span><a href="Haskemathesis.Stateful.Links.html#resolveResponse"><span class="hs-identifier hs-var">resolveResponse</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240168"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">(Referenced Response -&gt; Maybe Response)
-&gt; Maybe (Referenced Response) -&gt; Maybe Response
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Responses -&gt; Maybe (Referenced Response)
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_responsesDefault"><span class="hs-identifier hs-var">_responsesDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Responses
</span><a href="#local-6989586621679240169"><span class="hs-identifier hs-var">responses</span></a></span><span>
</span><span id="line-100"></span><span>        </span><span id="local-6989586621679240176"><span class="annot"><span class="annottext">codeResponses :: [Response]
</span><a href="#local-6989586621679240176"><span class="hs-identifier hs-var hs-var">codeResponses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Referenced Response -&gt; Maybe Response)
-&gt; [Referenced Response] -&gt; [Response]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; Referenced Response -&gt; Maybe Response
</span><a href="Haskemathesis.Stateful.Links.html#resolveResponse"><span class="hs-identifier hs-var">resolveResponse</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240168"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Referenced Response] -&gt; [Response])
-&gt; [Referenced Response] -&gt; [Response]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap HttpStatusCode (Referenced Response)
-&gt; [Referenced Response]
forall k v. InsOrdHashMap k v -&gt; [v]
</span><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html#elems"><span class="hs-identifier hs-var">IOHM.elems</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Responses -&gt; InsOrdHashMap HttpStatusCode (Referenced Response)
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_responsesResponses"><span class="hs-identifier hs-var">_responsesResponses</span></a></span><span> </span><span class="annot"><span class="annottext">Responses
</span><a href="#local-6989586621679240169"><span class="hs-identifier hs-var">responses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Response]
</span><a href="#local-6989586621679240171"><span class="hs-identifier hs-var">defaultResp</span></a></span><span> </span><span class="annot"><span class="annottext">[Response] -&gt; [Response] -&gt; [Response]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Response]
</span><a href="#local-6989586621679240176"><span class="hs-identifier hs-var">codeResponses</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679240172"><span class="annot"><span class="annottext">maybeToList :: Maybe a -&gt; [a]
</span><a href="#local-6989586621679240172"><span class="hs-identifier hs-var hs-var">maybeToList</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="#local-6989586621679240172"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679240179"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240179"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240179"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><span class="hs-comment">-- | Resolve a Referenced Response to a Response.</span></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#resolveResponse"><span class="hs-identifier hs-type">resolveResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-108"></span><span id="resolveResponse"><span class="annot"><span class="annottext">resolveResponse :: OpenApi -&gt; Referenced Response -&gt; Maybe Response
</span><a href="Haskemathesis.Stateful.Links.html#resolveResponse"><span class="hs-identifier hs-var hs-var">resolveResponse</span></a></span></span><span> </span><span id="local-6989586621679240180"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240180"><span class="hs-identifier hs-var">_spec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span> </span><span id="local-6989586621679240182"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679240182"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response -&gt; Maybe Response
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679240182"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-109"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#resolveResponse"><span class="hs-identifier hs-var">resolveResponse</span></a></span><span> </span><span id="local-6989586621679240183"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240183"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span id="local-6989586621679240185"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621679240185"><span class="hs-identifier hs-var">ref</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240189"><span class="annot"><span class="annottext">refName :: Text
</span><a href="#local-6989586621679240189"><span class="hs-identifier hs-var hs-var">refName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Text
</span><a href="#local-6989586621679240193"><span class="hs-identifier hs-var">getRefText</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621679240185"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-111"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text -&gt; InsOrdHashMap Text Response -&gt; Maybe Response
forall k v. (Eq k, Hashable k) =&gt; k -&gt; InsOrdHashMap k v -&gt; Maybe v
</span><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html#lookup"><span class="hs-identifier hs-var">IOHM.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240189"><span class="hs-identifier hs-var">refName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Components -&gt; InsOrdHashMap Text Response
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_componentsResponses"><span class="hs-identifier hs-var">_componentsResponses</span></a></span><span> </span><span class="annot"><span class="annottext">(Components -&gt; InsOrdHashMap Text Response)
-&gt; Components -&gt; InsOrdHashMap Text Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; Components
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_openApiComponents"><span class="hs-identifier hs-var">_openApiComponents</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240183"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679240193"><span class="annot"><span class="annottext">getRefText :: Reference -&gt; Text
</span><a href="#local-6989586621679240193"><span class="hs-identifier hs-var hs-var">getRefText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span id="local-6989586621679240198"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240198"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240198"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><span class="hs-comment">-- | Extract links from a single response.</span></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#extractLinksFromResponse"><span class="hs-identifier hs-type">extractLinksFromResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Source operation label</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span id="extractLinksFromResponse"><span class="annot"><span class="annottext">extractLinksFromResponse :: OpenApi -&gt; Text -&gt; Response -&gt; [OperationLink]
</span><a href="Haskemathesis.Stateful.Links.html#extractLinksFromResponse"><span class="hs-identifier hs-var hs-var">extractLinksFromResponse</span></a></span></span><span> </span><span id="local-6989586621679240199"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240199"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span id="local-6989586621679240200"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240200"><span class="hs-identifier hs-var">sourceLabel</span></a></span></span><span> </span><span id="local-6989586621679240201"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679240201"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">((Text, Referenced Link) -&gt; Maybe OperationLink)
-&gt; [(Text, Referenced Link)] -&gt; [OperationLink]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; Referenced Link -&gt; Maybe OperationLink)
-&gt; (Text, Referenced Link) -&gt; Maybe OperationLink
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Referenced Link -&gt; Maybe OperationLink)
 -&gt; (Text, Referenced Link) -&gt; Maybe OperationLink)
-&gt; (Text -&gt; Referenced Link -&gt; Maybe OperationLink)
-&gt; (Text, Referenced Link)
-&gt; Maybe OperationLink
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; Text -&gt; Text -&gt; Referenced Link -&gt; Maybe OperationLink
</span><a href="Haskemathesis.Stateful.Links.html#linkToOperationLink"><span class="hs-identifier hs-var">linkToOperationLink</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240199"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240200"><span class="hs-identifier hs-var">sourceLabel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Text, Referenced Link)] -&gt; [OperationLink])
-&gt; [(Text, Referenced Link)] -&gt; [OperationLink]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">InsOrdHashMap Text (Referenced Link) -&gt; [(Text, Referenced Link)]
forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html#toList"><span class="hs-identifier hs-var">IOHM.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap Text (Referenced Link) -&gt; [(Text, Referenced Link)])
-&gt; InsOrdHashMap Text (Referenced Link)
-&gt; [(Text, Referenced Link)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-125"></span><span>            </span><span class="annot"><span class="annottext">Response -&gt; InsOrdHashMap Text (Referenced Link)
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_responseLinks"><span class="hs-identifier hs-var">_responseLinks</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679240201"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><span class="hs-comment">-- | Convert an OpenAPI Link to our OperationLink type.</span></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#linkToOperationLink"><span class="hs-identifier hs-type">linkToOperationLink</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Source operation label</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Link name</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Link"><span class="hs-identifier hs-type">Link</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span>
</span><span id="line-136"></span><span id="linkToOperationLink"><span class="annot"><span class="annottext">linkToOperationLink :: OpenApi -&gt; Text -&gt; Text -&gt; Referenced Link -&gt; Maybe OperationLink
</span><a href="Haskemathesis.Stateful.Links.html#linkToOperationLink"><span class="hs-identifier hs-var hs-var">linkToOperationLink</span></a></span></span><span> </span><span id="local-6989586621679240205"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240205"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span id="local-6989586621679240206"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240206"><span class="hs-identifier hs-var">sourceLabel</span></a></span></span><span> </span><span id="local-6989586621679240207"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240207"><span class="hs-identifier hs-var">linkName</span></a></span></span><span> </span><span id="local-6989586621679240208"><span class="annot"><span class="annottext">Referenced Link
</span><a href="#local-6989586621679240208"><span class="hs-identifier hs-var">refLink</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679240209"><span class="annot"><a href="#local-6989586621679240209"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; Referenced Link -&gt; Maybe Link
</span><a href="Haskemathesis.Stateful.Links.html#resolveLink"><span class="hs-identifier hs-var">resolveLink</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240205"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">Referenced Link
</span><a href="#local-6989586621679240208"><span class="hs-identifier hs-var">refLink</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679240211"><span class="annot"><a href="#local-6989586621679240211"><span class="hs-identifier hs-var">targetOpId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#getTargetOperationId"><span class="hs-identifier hs-type">getTargetOperationId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240209"><span class="hs-identifier hs-type">link</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240213"><span class="annot"><a href="#local-6989586621679240213"><span class="hs-identifier hs-var hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Link -&gt; [ParameterBinding]
</span><a href="Haskemathesis.Stateful.Links.html#parseParameterBindings"><span class="hs-identifier hs-var">parseParameterBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Link
</span><a href="#local-6989586621679240209"><span class="hs-identifier hs-var">link</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#OperationLink"><span class="hs-identifier hs-type">OperationLink</span></a></span><span>
</span><span id="line-142"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#olSourceOperation"><span class="hs-identifier hs-var">olSourceOperation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679240206"><span class="hs-identifier hs-type">sourceLabel</span></a></span><span>
</span><span id="line-143"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#olTargetOperation"><span class="hs-identifier hs-var">olTargetOperation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679240211"><span class="hs-identifier hs-type">targetOpId</span></a></span><span>
</span><span id="line-144"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#olParameterBindings"><span class="hs-identifier hs-var">olParameterBindings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679240213"><span class="hs-identifier hs-type">bindings</span></a></span><span>
</span><span id="line-145"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#olDescription"><span class="hs-identifier hs-var">olDescription</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_linkDescription"><span class="hs-identifier hs-var">_linkDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240209"><span class="hs-identifier hs-type">link</span></a></span><span>
</span><span id="line-146"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#olLinkName"><span class="hs-identifier hs-var">olLinkName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679240207"><span class="hs-identifier hs-type">linkName</span></a></span><span>
</span><span id="line-147"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><span class="hs-comment">-- | Resolve a Referenced Link to a Link.</span></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#resolveLink"><span class="hs-identifier hs-type">resolveLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Link"><span class="hs-identifier hs-type">Link</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Link"><span class="hs-identifier hs-type">Link</span></a></span><span>
</span><span id="line-151"></span><span id="resolveLink"><span class="annot"><span class="annottext">resolveLink :: OpenApi -&gt; Referenced Link -&gt; Maybe Link
</span><a href="Haskemathesis.Stateful.Links.html#resolveLink"><span class="hs-identifier hs-var hs-var">resolveLink</span></a></span></span><span> </span><span id="local-6989586621679240222"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240222"><span class="hs-identifier hs-var">_spec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span> </span><span id="local-6989586621679240223"><span class="annot"><span class="annottext">Link
</span><a href="#local-6989586621679240223"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Link -&gt; Maybe Link
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Link
</span><a href="#local-6989586621679240223"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#resolveLink"><span class="hs-identifier hs-var">resolveLink</span></a></span><span> </span><span id="local-6989586621679240224"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240224"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span id="local-6989586621679240225"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621679240225"><span class="hs-identifier hs-var">ref</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240228"><span class="annot"><span class="annottext">refName :: Text
</span><a href="#local-6989586621679240228"><span class="hs-identifier hs-var hs-var">refName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Text
</span><a href="#local-6989586621679240229"><span class="hs-identifier hs-var">getRefText</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621679240225"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-154"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text -&gt; InsOrdHashMap Text Link -&gt; Maybe Link
forall k v. (Eq k, Hashable k) =&gt; k -&gt; InsOrdHashMap k v -&gt; Maybe v
</span><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html#lookup"><span class="hs-identifier hs-var">IOHM.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240228"><span class="hs-identifier hs-var">refName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Components -&gt; InsOrdHashMap Text Link
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_componentsLinks"><span class="hs-identifier hs-var">_componentsLinks</span></a></span><span> </span><span class="annot"><span class="annottext">(Components -&gt; InsOrdHashMap Text Link)
-&gt; Components -&gt; InsOrdHashMap Text Link
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; Components
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_openApiComponents"><span class="hs-identifier hs-var">_openApiComponents</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240224"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679240229"><span class="annot"><span class="annottext">getRefText :: Reference -&gt; Text
</span><a href="#local-6989586621679240229"><span class="hs-identifier hs-var hs-var">getRefText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span id="local-6989586621679240231"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240231"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240231"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><span class="hs-comment">{- | Get the target operation ID from a Link.
Prefers operationId over operationRef.
-}</span></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#getTargetOperationId"><span class="hs-identifier hs-type">getTargetOperationId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Link"><span class="hs-identifier hs-type">Link</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-162"></span><span id="getTargetOperationId"><span class="annot"><span class="annottext">getTargetOperationId :: Link -&gt; Maybe Text
</span><a href="Haskemathesis.Stateful.Links.html#getTargetOperationId"><span class="hs-identifier hs-var hs-var">getTargetOperationId</span></a></span></span><span> </span><span id="local-6989586621679240232"><span class="annot"><span class="annottext">Link
</span><a href="#local-6989586621679240232"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="annottext">Link -&gt; Maybe Text
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_linkOperationId"><span class="hs-identifier hs-var">_linkOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">Link
</span><a href="#local-6989586621679240232"><span class="hs-identifier hs-var">link</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text -&gt; Maybe Text
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="#local-6989586621679240234"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text
</span><a href="Haskemathesis.Stateful.Links.html#parseOperationRef"><span class="hs-identifier hs-var">parseOperationRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Link -&gt; Maybe Text
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_linkOperationRef"><span class="hs-identifier hs-var">_linkOperationRef</span></a></span><span> </span><span class="annot"><span class="annottext">Link
</span><a href="#local-6989586621679240232"><span class="hs-identifier hs-var">link</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679240016"><span class="annot"><a href="#local-6989586621679240234"><span class="hs-operator hs-type">(&lt;|&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679240016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679240016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679240016"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679240234"><span class="annot"><span class="annottext">&lt;|&gt; :: forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="#local-6989586621679240234"><span class="hs-operator hs-var hs-var">(&lt;|&gt;)</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679240236"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679240236"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679240236"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><a href="#local-6989586621679240234"><span class="hs-operator hs-var">(&lt;|&gt;)</span></a></span><span> </span><span id="local-6989586621679240237"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679240237"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679240237"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">{- | Parse an operationRef to extract the operation path.
operationRef is a JSON Reference like &quot;#/paths/~1users~1{userId}/get&quot;
-}</span></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#parseOperationRef"><span class="hs-identifier hs-type">parseOperationRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-173"></span><span id="parseOperationRef"><span class="annot"><span class="annottext">parseOperationRef :: Maybe Text -&gt; Maybe Text
</span><a href="Haskemathesis.Stateful.Links.html#parseOperationRef"><span class="hs-identifier hs-var hs-var">parseOperationRef</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#parseOperationRef"><span class="hs-identifier hs-var">parseOperationRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679240238"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240238"><span class="hs-identifier hs-var">ref</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;#/paths/&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240238"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-comment">-- Extract the path and method from the ref</span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-comment">-- Format: #/paths/~1users~1{userId}/get</span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240240"><span class="annot"><span class="annottext">withoutPrefix :: Text
</span><a href="#local-6989586621679240240"><span class="hs-identifier hs-var hs-var">withoutPrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240238"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="hs-comment">-- Drop &quot;#/paths/&quot;</span><span>
</span><span id="line-179"></span><span>            </span><span id="local-6989586621679240244"><span class="annot"><span class="annottext">parts :: [Text]
</span><a href="#local-6989586621679240244"><span class="hs-identifier hs-var hs-var">parts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Text -&gt; Text -&gt; [Text]
Text -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.splitOn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240240"><span class="hs-identifier hs-var">withoutPrefix</span></a></span><span>
</span><span id="line-180"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679240244"><span class="hs-identifier hs-var">parts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>                </span><span class="hs-special">[</span><span id="local-6989586621679240246"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240246"><span class="hs-identifier hs-var">encodedPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240247"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240247"><span class="hs-identifier hs-var">method</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-182"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240248"><span class="annot"><span class="annottext">path :: Text
</span><a href="#local-6989586621679240248"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Haskemathesis.Stateful.Links.html#decodeJsonPointer"><span class="hs-identifier hs-var">decodeJsonPointer</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240246"><span class="hs-identifier hs-var">encodedPath</span></a></span><span>
</span><span id="line-183"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toUpper</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240247"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240248"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-184"></span><span>                </span><span id="local-6989586621679240250"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679240250"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><span class="hs-comment">{- | Decode a JSON Pointer path segment (RFC 6901).
~1 -&gt; /, ~0 -&gt; ~
-}</span></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#decodeJsonPointer"><span class="hs-identifier hs-type">decodeJsonPointer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-191"></span><span id="decodeJsonPointer"><span class="annot"><span class="annottext">decodeJsonPointer :: Text -&gt; Text
</span><a href="Haskemathesis.Stateful.Links.html#decodeJsonPointer"><span class="hs-identifier hs-var hs-var">decodeJsonPointer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Text -&gt; Text -&gt; Text -&gt; Text
Text -&gt; Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.replace</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;~1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Text -&gt; Text -&gt; Text -&gt; Text
Text -&gt; Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.replace</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;~0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;~&quot;</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><span class="hs-comment">-- | Parse parameter bindings from a Link.</span></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#parseParameterBindings"><span class="hs-identifier hs-type">parseParameterBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Link"><span class="hs-identifier hs-type">Link</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#ParameterBinding"><span class="hs-identifier hs-type">ParameterBinding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span id="parseParameterBindings"><span class="annot"><span class="annottext">parseParameterBindings :: Link -&gt; [ParameterBinding]
</span><a href="Haskemathesis.Stateful.Links.html#parseParameterBindings"><span class="hs-identifier hs-var hs-var">parseParameterBindings</span></a></span></span><span> </span><span id="local-6989586621679240253"><span class="annot"><span class="annottext">Link
</span><a href="#local-6989586621679240253"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">((Text, ExpressionOrValue) -&gt; ParameterBinding)
-&gt; [(Text, ExpressionOrValue)] -&gt; [ParameterBinding]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; ExpressionOrValue -&gt; ParameterBinding)
-&gt; (Text, ExpressionOrValue) -&gt; ParameterBinding
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ExpressionOrValue -&gt; ParameterBinding
</span><a href="#local-6989586621679240254"><span class="hs-identifier hs-var">parseBinding</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Text, ExpressionOrValue)] -&gt; [ParameterBinding])
-&gt; [(Text, ExpressionOrValue)] -&gt; [ParameterBinding]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Text ExpressionOrValue -&gt; [(Text, ExpressionOrValue)]
forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html#toList"><span class="hs-identifier hs-var">IOHM.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Link -&gt; InsOrdHashMap Text ExpressionOrValue
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_linkParameters"><span class="hs-identifier hs-var">_linkParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Link
</span><a href="#local-6989586621679240253"><span class="hs-identifier hs-var">link</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="#local-6989586621679240254"><span class="hs-identifier hs-type">parseBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ExpressionOrValue"><span class="hs-identifier hs-type">ExpressionOrValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#ParameterBinding"><span class="hs-identifier hs-type">ParameterBinding</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679240254"><span class="annot"><span class="annottext">parseBinding :: Text -&gt; ExpressionOrValue -&gt; ParameterBinding
</span><a href="#local-6989586621679240254"><span class="hs-identifier hs-var hs-var">parseBinding</span></a></span></span><span> </span><span id="local-6989586621679240256"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240256"><span class="hs-identifier hs-var">paramName</span></a></span></span><span> </span><span id="local-6989586621679240257"><span class="annot"><span class="annottext">ExpressionOrValue
</span><a href="#local-6989586621679240257"><span class="hs-identifier hs-var">exprOrVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#ParameterBinding"><span class="hs-identifier hs-type">ParameterBinding</span></a></span><span>
</span><span id="line-201"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pbTargetParam :: Text
</span><a href="Haskemathesis.Stateful.Types.html#pbTargetParam"><span class="hs-identifier hs-var">pbTargetParam</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240256"><span class="hs-identifier hs-var">paramName</span></a></span><span>
</span><span id="line-202"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pbSource :: ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#pbSource"><span class="hs-identifier hs-var">pbSource</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpressionOrValue -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Links.html#expressionOrValueToSource"><span class="hs-identifier hs-var">expressionOrValueToSource</span></a></span><span> </span><span class="annot"><span class="annottext">ExpressionOrValue
</span><a href="#local-6989586621679240257"><span class="hs-identifier hs-var">exprOrVal</span></a></span><span>
</span><span id="line-203"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><span class="hs-comment">-- | Convert an ExpressionOrValue to a ValueSource.</span></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#expressionOrValueToSource"><span class="hs-identifier hs-type">expressionOrValueToSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#ExpressionOrValue"><span class="hs-identifier hs-type">ExpressionOrValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#ValueSource"><span class="hs-identifier hs-type">ValueSource</span></a></span><span>
</span><span id="line-207"></span><span id="expressionOrValueToSource"><span class="annot"><span class="annottext">expressionOrValueToSource :: ExpressionOrValue -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Links.html#expressionOrValueToSource"><span class="hs-identifier hs-var hs-var">expressionOrValueToSource</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span id="local-6989586621679240262"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240262"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Links.html#parseExpression"><span class="hs-identifier hs-var">parseExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240262"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#expressionOrValueToSource"><span class="hs-identifier hs-var">expressionOrValueToSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679240264"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679240264"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679240264"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><span class="hs-comment">{- | Parse a runtime expression string into a ValueSource.

Supports:
- $response.body#/path/to/field - Extract from response body
- $response.header.X-Header - Extract from response header
- $request.path.paramName - Use request path parameter
- $request.query.paramName - Use request query parameter
- $request.body#/path - Extract from request body
- $url - The URL of the operation
- Plain text - Treated as a literal
-}</span></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#parseExpression"><span class="hs-identifier hs-type">parseExpression</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.Stateful.Types.html#ValueSource"><span class="hs-identifier hs-type">ValueSource</span></a></span><span>
</span><span id="line-222"></span><span id="parseExpression"><span class="annot"><span class="annottext">parseExpression :: Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Links.html#parseExpression"><span class="hs-identifier hs-var hs-var">parseExpression</span></a></span></span><span> </span><span id="local-6989586621679240266"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$response.body#&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#FromResponseBody"><span class="hs-identifier hs-var">FromResponseBody</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$response.header.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240268"><span class="annot"><span class="annottext">header :: Text
</span><a href="#local-6989586621679240268"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">17</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-comment">-- Length of &quot;$response.header.&quot;</span><span>
</span><span id="line-227"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#FromResponseHeader"><span class="hs-identifier hs-var">FromResponseHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240268"><span class="hs-identifier hs-var">header</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$request.path.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240270"><span class="annot"><span class="annottext">param :: Text
</span><a href="#local-6989586621679240270"><span class="hs-identifier hs-var hs-var">param</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">14</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-comment">-- Length of &quot;$request.path.&quot;</span><span>
</span><span id="line-230"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#FromState"><span class="hs-identifier hs-var">FromState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;path.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240270"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$request.query.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240272"><span class="annot"><span class="annottext">param :: Text
</span><a href="#local-6989586621679240272"><span class="hs-identifier hs-var hs-var">param</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-comment">-- Length of &quot;$request.query.&quot;</span><span>
</span><span id="line-233"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#FromState"><span class="hs-identifier hs-var">FromState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;query.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240272"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$request.body#&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#FromState"><span class="hs-identifier hs-var">FromState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;requestBody&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">14</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$url&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#FromState"><span class="hs-identifier hs-var">FromState</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;url&quot;</span></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-comment">-- Other $ expressions we don't fully support yet</span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#FromState"><span class="hs-identifier hs-var">FromState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>        </span><span class="hs-comment">-- Plain text is a literal string</span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="annottext">Value -&gt; ValueSource
</span><a href="Haskemathesis.Stateful.Types.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-var">String</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240266"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><span class="hs-comment">{- | Parse a runtime expression and return the parsed components.
Returns (source, jsonPath) where source is one of &quot;body&quot;, &quot;header&quot;, &quot;path&quot;, etc.
-}</span></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#parseRuntimeExpression"><span class="hs-identifier hs-type">parseRuntimeExpression</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span id="parseRuntimeExpression"><span class="annot"><span class="annottext">parseRuntimeExpression :: Text -&gt; Either Text (Text, Maybe Text)
</span><a href="Haskemathesis.Stateful.Links.html#parseRuntimeExpression"><span class="hs-identifier hs-var hs-var">parseRuntimeExpression</span></a></span></span><span> </span><span id="local-6989586621679240273"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$response.body#&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>        </span><span class="hs-comment">-- Length of &quot;$response.body#&quot; is 15</span><span>
</span><span id="line-252"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240274"><span class="annot"><span class="annottext">pointer :: Text
</span><a href="#local-6989586621679240274"><span class="hs-identifier hs-var hs-var">pointer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-253"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Text, Maybe Text) -&gt; Either Text (Text, Maybe Text)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;response.body&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240274"><span class="hs-identifier hs-var">pointer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$response.header.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240275"><span class="annot"><span class="annottext">header :: Text
</span><a href="#local-6989586621679240275"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">17</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-256"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Text, Maybe Text) -&gt; Either Text (Text, Maybe Text)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;response.header.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240275"><span class="hs-identifier hs-var">header</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$request.path.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240276"><span class="annot"><span class="annottext">param :: Text
</span><a href="#local-6989586621679240276"><span class="hs-identifier hs-var hs-var">param</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">14</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-259"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Text, Maybe Text) -&gt; Either Text (Text, Maybe Text)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;request.path.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240276"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$request.query.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240277"><span class="annot"><span class="annottext">param :: Text
</span><a href="#local-6989586621679240277"><span class="hs-identifier hs-var hs-var">param</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-262"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Text, Maybe Text) -&gt; Either Text (Text, Maybe Text)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;request.query.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240277"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$request.body#&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240278"><span class="annot"><span class="annottext">pointer :: Text
</span><a href="#local-6989586621679240278"><span class="hs-identifier hs-var hs-var">pointer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">14</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-265"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Text, Maybe Text) -&gt; Either Text (Text, Maybe Text)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;request.body&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240278"><span class="hs-identifier hs-var">pointer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$url&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">(Text, Maybe Text) -&gt; Either Text (Text, Maybe Text)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;url&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Either Text (Text, Maybe Text)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either Text (Text, Maybe Text))
-&gt; Text -&gt; Either Text (Text, Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Unsupported runtime expression: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Either Text (Text, Maybe Text)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either Text (Text, Maybe Text))
-&gt; Text -&gt; Either Text (Text, Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Not a runtime expression: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240273"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><span class="hs-comment">-- | Resolve an operationId to find the operation in the spec.</span></span><span>
</span><span id="line-274"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#resolveOperationId"><span class="hs-identifier hs-type">resolveOperationId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span id="resolveOperationId"><span class="annot"><span class="annottext">resolveOperationId :: OpenApi -&gt; Text -&gt; Maybe (Text, Text, Operation)
</span><a href="Haskemathesis.Stateful.Links.html#resolveOperationId"><span class="hs-identifier hs-var hs-var">resolveOperationId</span></a></span></span><span> </span><span id="local-6989586621679240279"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240279"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span id="local-6989586621679240280"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240280"><span class="hs-identifier hs-var">opId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; OpenApi -&gt; Maybe (Text, Text, Operation)
</span><a href="Haskemathesis.Stateful.Links.html#findOperationById"><span class="hs-identifier hs-var">findOperationById</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240280"><span class="hs-identifier hs-var">opId</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240279"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><span class="hs-comment">{- | Find an operation by its operationId.
Returns (path, method, operation) if found.
-}</span></span><span>
</span><span id="line-280"></span><span class="annot"><a href="Haskemathesis.Stateful.Links.html#findOperationById"><span class="hs-identifier hs-type">findOperationById</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span id="findOperationById"><span class="annot"><span class="annottext">findOperationById :: Text -&gt; OpenApi -&gt; Maybe (Text, Text, Operation)
</span><a href="Haskemathesis.Stateful.Links.html#findOperationById"><span class="hs-identifier hs-var hs-var">findOperationById</span></a></span></span><span> </span><span id="local-6989586621679240281"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240281"><span class="hs-identifier hs-var">opId</span></a></span></span><span> </span><span id="local-6989586621679240282"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240282"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(FilePath, PathItem)] -&gt; Maybe (Text, Text, Operation)
</span><a href="#local-6989586621679240283"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([(FilePath, PathItem)] -&gt; Maybe (Text, Text, Operation))
-&gt; [(FilePath, PathItem)] -&gt; Maybe (Text, Text, Operation)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap FilePath PathItem -&gt; [(FilePath, PathItem)]
forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><a href="file:///nix/store/qrxnql6m31z8ycmg7kvmcv9hpa2ns4ix-insert-ordered-containers-0.2.7-doc/share/doc/insert-ordered-containers-0.2.7/html/src/Data.HashMap.Strict.InsOrd.html#toList"><span class="hs-identifier hs-var">IOHM.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; InsOrdHashMap FilePath PathItem
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_openApiPaths"><span class="hs-identifier hs-var">_openApiPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679240282"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679240283"><span class="annot"><span class="annottext">go :: [(FilePath, PathItem)] -&gt; Maybe (Text, Text, Operation)
</span><a href="#local-6989586621679240283"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text, Operation)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="#local-6989586621679240283"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240284"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679240284"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240285"><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240285"><span class="hs-identifier hs-var">pathItem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679240286"><span class="annot"><span class="annottext">[(FilePath, PathItem)]
</span><a href="#local-6989586621679240286"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; PathItem -&gt; Maybe (Text, Operation)
</span><a href="#local-6989586621679240287"><span class="hs-identifier hs-var">findInPathItem</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240281"><span class="hs-identifier hs-var">opId</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240285"><span class="hs-identifier hs-var">pathItem</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240288"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240288"><span class="hs-identifier hs-var">method</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240289"><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621679240289"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Text, Text, Operation) -&gt; Maybe (Text, Text, Operation)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679240284"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240288"><span class="hs-identifier hs-var">method</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621679240289"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Text, Operation)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(FilePath, PathItem)] -&gt; Maybe (Text, Text, Operation)
</span><a href="#local-6989586621679240283"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(FilePath, PathItem)]
</span><a href="#local-6989586621679240286"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><a href="#local-6989586621679240287"><span class="hs-identifier hs-type">findInPathItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#PathItem"><span class="hs-identifier hs-type">PathItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621679240287"><span class="annot"><span class="annottext">findInPathItem :: Text -&gt; PathItem -&gt; Maybe (Text, Operation)
</span><a href="#local-6989586621679240287"><span class="hs-identifier hs-var hs-var">findInPathItem</span></a></span></span><span> </span><span id="local-6989586621679240290"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240290"><span class="hs-identifier hs-var">targetId</span></a></span></span><span> </span><span id="local-6989586621679240291"><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240291"><span class="hs-identifier hs-var">pItem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240292"><span class="annot"><span class="annottext">ops :: [(Text, Operation)]
</span><a href="#local-6989586621679240292"><span class="hs-identifier hs-var hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; [(Text, Operation)]
</span><a href="Haskemathesis.Stateful.Links.html#getOperationsWithMethod"><span class="hs-identifier hs-var">getOperationsWithMethod</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679240291"><span class="hs-identifier hs-var">pItem</span></a></span><span>
</span><span id="line-292"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((Text, Operation) -&gt; Bool)
-&gt; [(Text, Operation)] -&gt; [(Text, Operation)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Operation -&gt; Bool
</span><a href="#local-6989586621679240293"><span class="hs-identifier hs-var">hasOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240290"><span class="hs-identifier hs-var">targetId</span></a></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; Bool)
-&gt; ((Text, Operation) -&gt; Operation) -&gt; (Text, Operation) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text, Operation) -&gt; Operation
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Operation)]
</span><a href="#local-6989586621679240292"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-293"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240295"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240295"><span class="hs-identifier hs-var">method</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240296"><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621679240296"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Operation)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Text, Operation) -&gt; Maybe (Text, Operation)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240295"><span class="hs-identifier hs-var">method</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621679240296"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Operation)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="#local-6989586621679240293"><span class="hs-identifier hs-type">hasOperationId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679240293"><span class="annot"><span class="annottext">hasOperationId :: Text -&gt; Operation -&gt; Bool
</span><a href="#local-6989586621679240293"><span class="hs-identifier hs-var hs-var">hasOperationId</span></a></span></span><span> </span><span id="local-6989586621679240297"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240297"><span class="hs-identifier hs-var">targetId</span></a></span></span><span> </span><span id="local-6989586621679240298"><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621679240298"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operation -&gt; Maybe Text
</span><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#_operationOperationId"><span class="hs-identifier hs-var">_operationOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621679240298"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679240297"><span class="hs-identifier hs-var">targetId</span></a></span><span>
</span><span id="line-298"></span></pre></body></html>