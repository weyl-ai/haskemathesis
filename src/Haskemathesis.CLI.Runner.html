<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | Test runner implementation for the Haskemathesis CLI.

This module provides the actual test execution logic for the CLI,
including HTTP testing, spec validation, and curl command generation.
-}</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Runner.html"><span class="hs-identifier">Haskemathesis.CLI.Runner</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#runTestCommand"><span class="hs-identifier">runTestCommand</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#runValidateCommand"><span class="hs-identifier">runValidateCommand</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#runCurlCommand"><span class="hs-identifier">runCurlCommand</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bracket</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Seq</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TIO</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier">Property</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Runner.html#check"><span class="hs-identifier">check</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.html"><span class="hs-identifier">Network.HTTP.Client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Manager.html#newManager"><span class="hs-identifier">newManager</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/frgzsv75xsqzxm0xxm7rd96lflgsl49l-http-client-tls-0.3.6.4-doc/share/doc/http-client-tls-0.3.6.4/html/src/Network.HTTP.Client.TLS.html"><span class="hs-identifier">Network.HTTP.Client.TLS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/frgzsv75xsqzxm0xxm7rd96lflgsl49l-http-client-tls-0.3.6.4-doc/share/doc/http-client-tls-0.3.6.4/html/src/Network.HTTP.Client.TLS.html#tlsManagerSettings"><span class="hs-identifier">tlsManagerSettings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">createDirectoryIfMissing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getCurrentDirectory</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">removeDirectoryRecursive</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setCurrentDirectory</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">setEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExitCode</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exitSuccess</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exitWith</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/pzdaikiimb5av6nndig6pmj2125wlji9-temporary-1.3-doc/share/doc/temporary-1.3/html/src/System.IO.Temp.html"><span class="hs-identifier">System.IO.Temp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/pzdaikiimb5av6nndig6pmj2125wlji9-temporary-1.3-doc/share/doc/temporary-1.3/html/src/System.IO.Temp.html#createTempDirectory"><span class="hs-identifier">createTempDirectory</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/pzdaikiimb5av6nndig6pmj2125wlji9-temporary-1.3-doc/share/doc/temporary-1.3/html/src/System.IO.Temp.html#getCanonicalTemporaryDirectory"><span class="hs-identifier">getCanonicalTemporaryDirectory</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Internal.html"><span class="hs-identifier">Haskemathesis.CLI.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.CLI.Internal.html#buildOperationFilter"><span class="hs-identifier">buildOperationFilter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Internal.html#buildTestConfig"><span class="hs-identifier">buildTestConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Internal.html#filterByAnyTag"><span class="hs-identifier">filterByAnyTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Internal.html#matchesPattern"><span class="hs-identifier">matchesPattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Options.html"><span class="hs-identifier">Haskemathesis.CLI.Options</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.CLI.Options.html#CurlOptions"><span class="hs-identifier">CurlOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Options.html#TestOptions"><span class="hs-identifier">TestOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Options.html#ValidateOptions"><span class="hs-identifier">ValidateOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Options.html#WorkdirOption"><span class="hs-identifier">WorkdirOption</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Http.html"><span class="hs-identifier">Haskemathesis.Execute.Http</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Http.html#executeHttp"><span class="hs-identifier">executeHttp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html"><span class="hs-identifier">Haskemathesis.Execute.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier">BaseUrl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html"><span class="hs-identifier">Haskemathesis.OpenApi.Loader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFile"><span class="hs-identifier">loadOpenApiFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Resolve.html"><span class="hs-identifier">Haskemathesis.OpenApi.Resolve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier">resolveOperations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html"><span class="hs-identifier">Haskemathesis.OpenApi.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier">ResolvedOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html"><span class="hs-identifier">Haskemathesis.Property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier">propertiesForSpecWithConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><span class="hs-comment">-- | Data structure for test results.</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">data</span><span> </span><span id="PropertyResult"><span class="annot"><a href="Haskemathesis.CLI.Runner.html#PropertyResult"><span class="hs-identifier hs-var">PropertyResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PropertyResult"><span class="annot"><a href="Haskemathesis.CLI.Runner.html#PropertyResult"><span class="hs-identifier hs-var">PropertyResult</span></a></span></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="propertyName"><span class="annot"><span class="annottext">PropertyResult -&gt; Text
</span><a href="Haskemathesis.CLI.Runner.html#propertyName"><span class="hs-identifier hs-var hs-var">propertyName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="propertyPassed"><span class="annot"><span class="annottext">PropertyResult -&gt; Bool
</span><a href="Haskemathesis.CLI.Runner.html#propertyPassed"><span class="hs-identifier hs-var hs-var">propertyPassed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="propertyTestCount"><span class="annot"><span class="annottext">PropertyResult -&gt; Int
</span><a href="Haskemathesis.CLI.Runner.html#propertyTestCount"><span class="hs-identifier hs-var hs-var">propertyTestCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><span class="hs-comment">-- | Run the test command.</span></span><span>
</span><span id="line-47"></span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#runTestCommand"><span class="hs-identifier hs-type">runTestCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Options.html#TestOptions"><span class="hs-identifier hs-type">TestOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span id="runTestCommand"><span class="annot"><span class="annottext">runTestCommand :: TestOptions -&gt; IO ()
</span><a href="Haskemathesis.CLI.Runner.html#runTestCommand"><span class="hs-identifier hs-var hs-var">runTestCommand</span></a></span></span><span> </span><span id="local-6989586621679223650"><span class="annot"><span class="annottext">TestOptions
</span><a href="#local-6989586621679223650"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-comment">-- Set seed if provided</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestOptions -&gt; Maybe Int
</span><a href="Haskemathesis.CLI.Options.html#testSeed"><span class="hs-identifier hs-var">testSeed</span></a></span><span> </span><span class="annot"><span class="annottext">TestOptions
</span><a href="#local-6989586621679223650"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679223652"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679223652"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">setEnv</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HEDGEHOG_SEED&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679223652"><span class="hs-identifier hs-var">seed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-comment">-- Load the OpenAPI spec (before changing directory so relative paths work)</span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621679223654"><span class="annot"><a href="#local-6989586621679223654"><span class="hs-identifier hs-var">specResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either Text OpenApi)
</span><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFile"><span class="hs-identifier hs-var">loadOpenApiFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestOptions -&gt; String
</span><a href="Haskemathesis.CLI.Options.html#testSpecPath"><span class="hs-identifier hs-var">testSpecPath</span></a></span><span> </span><span class="annot"><span class="annottext">TestOptions
</span><a href="#local-6989586621679223650"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679223654"><span class="hs-identifier hs-type">specResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-57"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679223656"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223656"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">TIO.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Error loading spec: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223656"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-59"></span><span>            </span><span class="annot"><span class="annottext">ExitCode -&gt; IO ()
forall a. ExitCode -&gt; IO a
</span><span class="hs-identifier hs-var">exitWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ExitCode
</span><span class="hs-identifier hs-var">ExitFailure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679223659"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679223659"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-61"></span><span>            </span><span class="hs-comment">-- Run tests in the appropriate working directory</span><span>
</span><span id="line-62"></span><span>            </span><span class="annot"><span class="annottext">WorkdirOption -&gt; IO () -&gt; IO ()
forall a. WorkdirOption -&gt; IO a -&gt; IO a
</span><a href="Haskemathesis.CLI.Runner.html#withWorkdir"><span class="hs-identifier hs-var">withWorkdir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestOptions -&gt; WorkdirOption
</span><a href="Haskemathesis.CLI.Options.html#testWorkdir"><span class="hs-identifier hs-var">testWorkdir</span></a></span><span> </span><span class="annot"><span class="annottext">TestOptions
</span><a href="#local-6989586621679223650"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-63"></span><span>                </span><span class="hs-comment">-- Resolve operations</span><span>
</span><span id="line-64"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223662"><span class="annot"><span class="annottext">operations :: [ResolvedOperation]
</span><a href="#local-6989586621679223662"><span class="hs-identifier hs-var hs-var hs-var">operations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679223659"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>                </span><span class="hs-comment">-- Build operation filter</span><span>
</span><span id="line-67"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223663"><span class="annot"><span class="annottext">opFilter :: ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223663"><span class="hs-identifier hs-var hs-var hs-var">opFilter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestOptions -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.CLI.Internal.html#buildOperationFilter"><span class="hs-identifier hs-var">buildOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">TestOptions
</span><a href="#local-6989586621679223650"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-68"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223664"><span class="annot"><span class="annottext">filteredOps :: [ResolvedOperation]
</span><a href="#local-6989586621679223664"><span class="hs-identifier hs-var hs-var hs-var">filteredOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223663"><span class="hs-identifier hs-var">opFilter</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679223662"><span class="hs-identifier hs-var">operations</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679223665"><span class="hs-identifier hs-type">filteredOpsSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span>
</span><span id="line-71"></span><span>                    </span><span id="local-6989586621679223665"><span class="annot"><span class="annottext">filteredOpsSeq :: Seq ResolvedOperation
</span><a href="#local-6989586621679223665"><span class="hs-identifier hs-var hs-var hs-var">filteredOpsSeq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; Seq ResolvedOperation
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679223664"><span class="hs-identifier hs-var">filteredOps</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResolvedOperation -&gt; Bool
forall a. Seq a -&gt; Bool
</span><span class="hs-identifier hs-var">Seq.null</span></span><span> </span><span class="annot"><span class="annottext">Seq ResolvedOperation
</span><a href="#local-6989586621679223665"><span class="hs-identifier hs-var">filteredOpsSeq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-74"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No operations match the given filters&quot;</span></span><span>
</span><span id="line-75"></span><span>                    </span><span class="annot"><span class="annottext">ExitCode -&gt; IO ()
forall a. ExitCode -&gt; IO a
</span><span class="hs-identifier hs-var">exitWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ExitCode
</span><span class="hs-identifier hs-var">ExitFailure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Testing &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResolvedOperation -&gt; Int
forall a. Seq a -&gt; Int
</span><span class="hs-identifier hs-var">Seq.length</span></span><span> </span><span class="annot"><span class="annottext">Seq ResolvedOperation
</span><a href="#local-6989586621679223665"><span class="hs-identifier hs-var">filteredOpsSeq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; operation(s)&quot;</span></span><span>
</span><span id="line-78"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Base URL: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestOptions -&gt; Text
</span><a href="Haskemathesis.CLI.Options.html#testBaseUrl"><span class="hs-identifier hs-var">testBaseUrl</span></a></span><span> </span><span class="annot"><span class="annottext">TestOptions
</span><a href="#local-6989586621679223650"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Test count per operation: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestOptions -&gt; Int
</span><a href="Haskemathesis.CLI.Options.html#testCount"><span class="hs-identifier hs-var">testCount</span></a></span><span> </span><span class="annot"><span class="annottext">TestOptions
</span><a href="#local-6989586621679223650"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>                </span><span class="hs-comment">-- Create test config</span><span>
</span><span id="line-82"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223673"><span class="annot"><span class="annottext">config :: TestConfig
</span><a href="#local-6989586621679223673"><span class="hs-identifier hs-var hs-var hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestOptions -&gt; TestConfig
</span><a href="Haskemathesis.CLI.Internal.html#buildTestConfig"><span class="hs-identifier hs-var">buildTestConfig</span></a></span><span> </span><span class="annot"><span class="annottext">TestOptions
</span><a href="#local-6989586621679223650"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>                </span><span class="hs-comment">-- Create HTTP manager</span><span>
</span><span id="line-85"></span><span>                </span><span id="local-6989586621679223674"><span class="annot"><a href="#local-6989586621679223674"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; IO Manager
</span><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Manager.html#newManager"><span class="hs-identifier hs-var">newManager</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="file:///nix/store/frgzsv75xsqzxm0xxm7rd96lflgsl49l-http-client-tls-0.3.6.4-doc/share/doc/http-client-tls-0.3.6.4/html/src/Network.HTTP.Client.TLS.html#tlsManagerSettings"><span class="hs-identifier hs-var">tlsManagerSettings</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>                </span><span class="hs-comment">-- Generate properties</span><span>
</span><span id="line-88"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223675"><span class="annot"><a href="#local-6989586621679223675"><span class="hs-identifier hs-var hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestOptions -&gt; Text
</span><a href="Haskemathesis.CLI.Options.html#testBaseUrl"><span class="hs-identifier hs-var">testBaseUrl</span></a></span><span> </span><span class="annot"><span class="annottext">TestOptions
</span><a href="#local-6989586621679223650"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-89"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223676"><span class="annot"><a href="#local-6989586621679223676"><span class="hs-identifier hs-var hs-var">props</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; [(Text, Property)]
</span><a href="Haskemathesis.Property.html#propertiesForSpecWithConfig"><span class="hs-identifier hs-var">propertiesForSpecWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679223659"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679223673"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; Text -&gt; ApiRequest -&gt; IO ApiResponse
</span><a href="Haskemathesis.Execute.Http.html#executeHttp"><span class="hs-identifier hs-var">executeHttp</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679223674"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223675"><span class="hs-identifier hs-var">baseUrl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679223664"><span class="hs-identifier hs-var">filteredOps</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>                </span><span class="hs-comment">-- Run tests</span><span>
</span><span id="line-92"></span><span>                </span><span id="local-6989586621679223677"><span class="annot"><a href="#local-6989586621679223677"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#runProperty"><span class="hs-identifier hs-type">runProperty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679223675"><span class="hs-identifier hs-type">baseUrl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679223676"><span class="hs-identifier hs-type">props</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>                </span><span class="hs-comment">-- Report results</span><span>
</span><span id="line-95"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679223680"><span class="hs-identifier hs-type">resultsSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span>
</span><span id="line-96"></span><span>                    </span><span id="local-6989586621679223680"><span class="annot"><a href="#local-6989586621679223680"><span class="hs-identifier hs-var hs-var">resultsSeq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropertyResult] -&gt; Seq PropertyResult
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">[PropertyResult]
</span><a href="#local-6989586621679223677"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-97"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223681"><span class="annot"><a href="#local-6989586621679223681"><span class="hs-identifier hs-var hs-var">failures</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PropertyResult -&gt; Bool)
-&gt; Seq PropertyResult -&gt; Seq PropertyResult
forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (PropertyResult -&gt; Bool) -&gt; PropertyResult -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PropertyResult -&gt; Bool
</span><a href="Haskemathesis.CLI.Runner.html#propertyPassed"><span class="hs-identifier hs-var">propertyPassed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq PropertyResult
</span><a href="#local-6989586621679223680"><span class="hs-identifier hs-var">resultsSeq</span></a></span><span>
</span><span id="line-98"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223691"><span class="annot"><a href="#local-6989586621679223691"><span class="hs-identifier hs-var hs-var">totalTests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; Int -&gt; Seq Int -&gt; Int
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Seq a -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PropertyResult -&gt; Int) -&gt; Seq PropertyResult -&gt; Seq Int
forall a b. (a -&gt; b) -&gt; Seq a -&gt; Seq b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PropertyResult -&gt; Int
</span><a href="Haskemathesis.CLI.Runner.html#propertyTestCount"><span class="hs-identifier hs-var">propertyTestCount</span></a></span><span> </span><span class="annot"><span class="annottext">Seq PropertyResult
</span><a href="#local-6989586621679223680"><span class="hs-identifier hs-var">resultsSeq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n=== Test Results ===&quot;</span></span><span>
</span><span id="line-101"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">putStrLn</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Total operations tested: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.length</span></span><span> </span><span class="annot"><a href="#local-6989586621679223680"><span class="hs-identifier hs-type">resultsSeq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">putStrLn</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Total test cases: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621679223691"><span class="hs-identifier hs-type">totalTests</span></a></span><span>
</span><span id="line-103"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">putStrLn</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Failures: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.length</span></span><span> </span><span class="annot"><a href="#local-6989586621679223681"><span class="hs-identifier hs-type">failures</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.null</span></span><span> </span><span class="annot"><a href="#local-6989586621679223681"><span class="hs-identifier hs-type">failures</span></a></span><span>
</span><span id="line-106"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">exitSuccess</span></span><span>
</span><span id="line-107"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-108"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\nFailed operations:&quot;</span></span><span>
</span><span id="line-109"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">putStrLn</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;- &quot;</span></span><span> </span><span class="annot"><span class="hs-operator">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.unpack</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#propertyName"><span class="hs-identifier hs-var">propertyName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679223681"><span class="hs-identifier hs-type">failures</span></a></span><span>
</span><span id="line-110"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">exitWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExitFailure</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><span class="hs-comment">{- | Run an action in the specified working directory.
For temp directories, the directory is created before and cleaned up after.
-}</span></span><span>
</span><span id="line-115"></span><span id="local-6989586621679223461"><span class="annot"><a href="Haskemathesis.CLI.Runner.html#withWorkdir"><span class="hs-identifier hs-type">withWorkdir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Options.html#WorkdirOption"><span class="hs-identifier hs-type">WorkdirOption</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679223461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679223461"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-116"></span><span id="withWorkdir"><span class="annot"><span class="annottext">withWorkdir :: forall a. WorkdirOption -&gt; IO a -&gt; IO a
</span><a href="Haskemathesis.CLI.Runner.html#withWorkdir"><span class="hs-identifier hs-var hs-var">withWorkdir</span></a></span></span><span> </span><span class="annot"><span class="annottext">WorkdirOption
</span><a href="Haskemathesis.CLI.Options.html#WorkdirCurrent"><span class="hs-identifier hs-var">WorkdirCurrent</span></a></span><span> </span><span id="local-6989586621679223707"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679223707"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679223707"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#withWorkdir"><span class="hs-identifier hs-var">withWorkdir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.CLI.Options.html#WorkdirPath"><span class="hs-identifier hs-type">WorkdirPath</span></a></span><span> </span><span id="local-6989586621679223709"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679223709"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679223710"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679223710"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679223709"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679223711"><span class="annot"><a href="#local-6989586621679223711"><span class="hs-identifier hs-var">originalDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getCurrentDirectory</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">bracket</span></span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">setCurrentDirectory</span></span><span> </span><span class="annot"><a href="#local-6989586621679223709"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679223711"><span class="hs-identifier hs-type">originalDir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">setCurrentDirectory</span></span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">const</span></span><span> </span><span class="annot"><a href="#local-6989586621679223710"><span class="hs-identifier hs-type">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#withWorkdir"><span class="hs-identifier hs-var">withWorkdir</span></a></span><span> </span><span class="annot"><span class="annottext">WorkdirOption
</span><a href="Haskemathesis.CLI.Options.html#WorkdirTemp"><span class="hs-identifier hs-var">WorkdirTemp</span></a></span><span> </span><span id="local-6989586621679223714"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679223714"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679223715"><span class="annot"><a href="#local-6989586621679223715"><span class="hs-identifier hs-var">tempBase</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="file:///nix/store/pzdaikiimb5av6nndig6pmj2125wlji9-temporary-1.3-doc/share/doc/temporary-1.3/html/src/System.IO.Temp.html#getCanonicalTemporaryDirectory"><span class="hs-identifier hs-var">getCanonicalTemporaryDirectory</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679223716"><span class="annot"><a href="#local-6989586621679223716"><span class="hs-identifier hs-var">originalDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">getCurrentDirectory</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">bracket</span></span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/pzdaikiimb5av6nndig6pmj2125wlji9-temporary-1.3-doc/share/doc/temporary-1.3/html/src/System.IO.Temp.html#createTempDirectory"><span class="hs-identifier hs-type">createTempDirectory</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679223715"><span class="hs-identifier hs-type">tempBase</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;haskemathesis-test&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679223717"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679223717"><span class="hs-identifier hs-var">tempDir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">setCurrentDirectory</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679223716"><span class="hs-identifier hs-var">originalDir</span></a></span><span>
</span><span id="line-131"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">removeDirectoryRecursive</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679223717"><span class="hs-identifier hs-var">tempDir</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679223718"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679223718"><span class="hs-identifier hs-var">tempDir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Running tests in temp directory: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679223718"><span class="hs-identifier hs-var">tempDir</span></a></span><span>
</span><span id="line-135"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">setCurrentDirectory</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679223718"><span class="hs-identifier hs-var">tempDir</span></a></span><span>
</span><span id="line-136"></span><span>            </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679223714"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><span class="hs-comment">-- | Run a single property and return results.</span></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#runProperty"><span class="hs-identifier hs-type">runProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span>
</span><span id="line-141"></span><span id="runProperty"><span class="annot"><span class="annottext">runProperty :: Text -&gt; (Text, Property) -&gt; IO PropertyResult
</span><a href="Haskemathesis.CLI.Runner.html#runProperty"><span class="hs-identifier hs-var hs-var">runProperty</span></a></span></span><span> </span><span id="local-6989586621679223719"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223719"><span class="hs-identifier hs-var">_baseUrl</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679223720"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223720"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679223721"><span class="annot"><span class="annottext">Property
</span><a href="#local-6989586621679223721"><span class="hs-identifier hs-var">prop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">TIO.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Running: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223720"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679223722"><span class="annot"><a href="#local-6989586621679223722"><span class="hs-identifier hs-var">passed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Property -&gt; IO Bool
forall (m :: * -&gt; *). MonadIO m =&gt; Property -&gt; m Bool
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Runner.html#check"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Property
</span><a href="#local-6989586621679223721"><span class="hs-identifier hs-var">prop</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679223722"><span class="hs-identifier hs-type">passed</span></a></span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679223720"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679223720"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><span class="hs-comment">-- | Run the validate command.</span></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#runValidateCommand"><span class="hs-identifier hs-type">runValidateCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Options.html#ValidateOptions"><span class="hs-identifier hs-type">ValidateOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span id="runValidateCommand"><span class="annot"><span class="annottext">runValidateCommand :: ValidateOptions -&gt; IO ()
</span><a href="Haskemathesis.CLI.Runner.html#runValidateCommand"><span class="hs-identifier hs-var hs-var">runValidateCommand</span></a></span></span><span> </span><span id="local-6989586621679223723"><span class="annot"><span class="annottext">ValidateOptions
</span><a href="#local-6989586621679223723"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679223724"><span class="annot"><a href="#local-6989586621679223724"><span class="hs-identifier hs-var">specResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either Text OpenApi)
</span><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFile"><span class="hs-identifier hs-var">loadOpenApiFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidateOptions -&gt; String
</span><a href="Haskemathesis.CLI.Options.html#validateSpecPath"><span class="hs-identifier hs-var">validateSpecPath</span></a></span><span> </span><span class="annot"><span class="annottext">ValidateOptions
</span><a href="#local-6989586621679223723"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679223724"><span class="hs-identifier hs-type">specResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679223726"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223726"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">TIO.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Validation failed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223726"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">ExitCode -&gt; IO ()
forall a. ExitCode -&gt; IO a
</span><span class="hs-identifier hs-var">exitWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ExitCode
</span><span class="hs-identifier hs-var">ExitFailure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-157"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">TIO.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;OpenAPI specification is valid&quot;</span></span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidateOptions -&gt; Bool
</span><a href="Haskemathesis.CLI.Options.html#validateVerbose"><span class="hs-identifier hs-var">validateVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">ValidateOptions
</span><a href="#local-6989586621679223723"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-159"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">TIO.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Specification loaded successfully&quot;</span></span><span>
</span><span id="line-160"></span><span>            </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><span class="hs-identifier hs-var">exitSuccess</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><span class="hs-comment">-- | Run the curl command.</span></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#runCurlCommand"><span class="hs-identifier hs-type">runCurlCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Options.html#CurlOptions"><span class="hs-identifier hs-type">CurlOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span id="runCurlCommand"><span class="annot"><span class="annottext">runCurlCommand :: CurlOptions -&gt; IO ()
</span><a href="Haskemathesis.CLI.Runner.html#runCurlCommand"><span class="hs-identifier hs-var hs-var">runCurlCommand</span></a></span></span><span> </span><span id="local-6989586621679223728"><span class="annot"><span class="annottext">CurlOptions
</span><a href="#local-6989586621679223728"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">-- Load the OpenAPI spec</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679223729"><span class="annot"><a href="#local-6989586621679223729"><span class="hs-identifier hs-var">specResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either Text OpenApi)
</span><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFile"><span class="hs-identifier hs-var">loadOpenApiFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurlOptions -&gt; String
</span><a href="Haskemathesis.CLI.Options.html#curlSpecPath"><span class="hs-identifier hs-var">curlSpecPath</span></a></span><span> </span><span class="annot"><span class="annottext">CurlOptions
</span><a href="#local-6989586621679223728"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679223729"><span class="hs-identifier hs-type">specResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679223731"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223731"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">TIO.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Error loading spec: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679223731"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-170"></span><span>            </span><span class="annot"><span class="annottext">ExitCode -&gt; IO ()
forall a. ExitCode -&gt; IO a
</span><span class="hs-identifier hs-var">exitWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ExitCode
</span><span class="hs-identifier hs-var">ExitFailure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679223732"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679223732"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>            </span><span class="hs-comment">-- Resolve operations</span><span>
</span><span id="line-173"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223733"><span class="annot"><span class="annottext">operations :: [ResolvedOperation]
</span><a href="#local-6989586621679223733"><span class="hs-identifier hs-var hs-var hs-var">operations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679223732"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-comment">-- Build operation filter</span><span>
</span><span id="line-176"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223734"><span class="annot"><span class="annottext">opFilter :: ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223734"><span class="hs-identifier hs-var hs-var hs-var">opFilter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CurlOptions -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.CLI.Runner.html#buildCurlOperationFilter"><span class="hs-identifier hs-var">buildCurlOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">CurlOptions
</span><a href="#local-6989586621679223728"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223736"><span class="annot"><span class="annottext">filteredOps :: [ResolvedOperation]
</span><a href="#local-6989586621679223736"><span class="hs-identifier hs-var hs-var hs-var">filteredOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation] -&gt; [ResolvedOperation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223734"><span class="hs-identifier hs-var">opFilter</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679223733"><span class="hs-identifier hs-var">operations</span></a></span><span>
</span><span id="line-178"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679223737"><span class="hs-identifier hs-type">filteredOpsSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span>
</span><span id="line-179"></span><span>                </span><span id="local-6989586621679223737"><span class="annot"><span class="annottext">filteredOpsSeq :: Seq ResolvedOperation
</span><a href="#local-6989586621679223737"><span class="hs-identifier hs-var hs-var hs-var">filteredOpsSeq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; Seq ResolvedOperation
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679223736"><span class="hs-identifier hs-var">filteredOps</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResolvedOperation -&gt; Bool
forall a. Seq a -&gt; Bool
</span><span class="hs-identifier hs-var">Seq.null</span></span><span> </span><span class="annot"><span class="annottext">Seq ResolvedOperation
</span><a href="#local-6989586621679223737"><span class="hs-identifier hs-var">filteredOpsSeq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No operations match the given filters&quot;</span></span><span>
</span><span id="line-183"></span><span>                </span><span class="annot"><span class="annottext">ExitCode -&gt; IO ()
forall a. ExitCode -&gt; IO a
</span><span class="hs-identifier hs-var">exitWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ExitCode
</span><span class="hs-identifier hs-var">ExitFailure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Generating curl commands for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResolvedOperation -&gt; Int
forall a. Seq a -&gt; Int
</span><span class="hs-identifier hs-var">Seq.length</span></span><span> </span><span class="annot"><span class="annottext">Seq ResolvedOperation
</span><a href="#local-6989586621679223737"><span class="hs-identifier hs-var">filteredOpsSeq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; operation(s)&quot;</span></span><span>
</span><span id="line-186"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Base URL: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurlOptions -&gt; Text
</span><a href="Haskemathesis.CLI.Options.html#curlBaseUrl"><span class="hs-identifier hs-var">curlBaseUrl</span></a></span><span> </span><span class="annot"><span class="annottext">CurlOptions
</span><a href="#local-6989586621679223728"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Examples per operation: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurlOptions -&gt; Int
</span><a href="Haskemathesis.CLI.Options.html#curlCount"><span class="hs-identifier hs-var">curlCount</span></a></span><span> </span><span class="annot"><span class="annottext">CurlOptions
</span><a href="#local-6989586621679223728"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>            </span><span class="hs-comment">-- For now, just print a message. In a full implementation,</span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-comment">-- we would generate sample requests and convert them to curl commands</span><span>
</span><span id="line-192"></span><span>            </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; IO ()) -&gt; [ResolvedOperation] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span>
</span><span id="line-193"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679223740"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223740"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-194"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;# &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Text
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223740"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roPath"><span class="hs-identifier hs-var">roPath</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223740"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Maybe Text
</span><a href="Haskemathesis.OpenApi.Types.html#roOperationId"><span class="hs-identifier hs-var">roOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223740"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;# &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223740"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roPath"><span class="hs-identifier hs-var">roPath</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223740"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-197"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>                </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679223736"><span class="hs-identifier hs-var">filteredOps</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>            </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><span class="hs-identifier hs-var">exitSuccess</span></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><span class="hs-comment">-- | Build operation filter for curl command.</span></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Haskemathesis.CLI.Runner.html#buildCurlOperationFilter"><span class="hs-identifier hs-type">buildCurlOperationFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.CLI.Options.html#CurlOptions"><span class="hs-identifier hs-type">CurlOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span id="buildCurlOperationFilter"><span class="annot"><span class="annottext">buildCurlOperationFilter :: CurlOptions -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.CLI.Runner.html#buildCurlOperationFilter"><span class="hs-identifier hs-var hs-var">buildCurlOperationFilter</span></a></span></span><span> </span><span id="local-6989586621679223744"><span class="annot"><span class="annottext">CurlOptions
</span><a href="#local-6989586621679223744"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679223746"><span class="annot"><span class="annottext">includeFilter :: ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223746"><span class="hs-identifier hs-var hs-var">includeFilter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CurlOptions -&gt; [Text]
</span><a href="Haskemathesis.CLI.Options.html#curlInclude"><span class="hs-identifier hs-var">curlInclude</span></a></span><span> </span><span class="annot"><span class="annottext">CurlOptions
</span><a href="#local-6989586621679223744"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ResolvedOperation -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-207"></span><span>            </span><span id="local-6989586621679223748"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679223748"><span class="hs-identifier hs-var">patterns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679223749"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223749"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text -&gt; Bool
</span><a href="Haskemathesis.CLI.Internal.html#matchesPattern"><span class="hs-identifier hs-var">matchesPattern</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223749"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679223748"><span class="hs-identifier hs-var">patterns</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span id="local-6989586621679223752"><span class="annot"><span class="annottext">excludeFilter :: ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223752"><span class="hs-identifier hs-var hs-var">excludeFilter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CurlOptions -&gt; [Text]
</span><a href="Haskemathesis.CLI.Options.html#curlExclude"><span class="hs-identifier hs-var">curlExclude</span></a></span><span> </span><span class="annot"><span class="annottext">CurlOptions
</span><a href="#local-6989586621679223744"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ResolvedOperation -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-210"></span><span>            </span><span id="local-6989586621679223754"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679223754"><span class="hs-identifier hs-var">patterns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679223755"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223755"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text -&gt; Bool
</span><a href="Haskemathesis.CLI.Internal.html#matchesPattern"><span class="hs-identifier hs-var">matchesPattern</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223755"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679223754"><span class="hs-identifier hs-var">patterns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>        </span><span id="local-6989586621679223756"><span class="annot"><span class="annottext">tagFilter :: ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223756"><span class="hs-identifier hs-var hs-var">tagFilter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CurlOptions -&gt; [Text]
</span><a href="Haskemathesis.CLI.Options.html#curlTags"><span class="hs-identifier hs-var">curlTags</span></a></span><span> </span><span class="annot"><span class="annottext">CurlOptions
</span><a href="#local-6989586621679223744"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ResolvedOperation -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-213"></span><span>            </span><span id="local-6989586621679223758"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679223758"><span class="hs-identifier hs-var">tags</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.CLI.Internal.html#filterByAnyTag"><span class="hs-identifier hs-var">filterByAnyTag</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679223758"><span class="hs-identifier hs-var">tags</span></a></span><span>
</span><span id="line-214"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679223759"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223759"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223746"><span class="hs-identifier hs-var">includeFilter</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223759"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223752"><span class="hs-identifier hs-var">excludeFilter</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223759"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="#local-6989586621679223756"><span class="hs-identifier hs-var">tagFilter</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679223759"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-215"></span></pre></body></html>