<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- |
Module      : Haskemathesis.Check.Standard.ResponseSchema
Description : Response body schema validation
Stability   : experimental

This module provides checks for validating API response bodies against
their documented JSON schemas in the OpenAPI specification.
-}</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Standard.ResponseSchema.html"><span class="hs-identifier">Haskemathesis.Check.Standard.ResponseSchema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Standard.ResponseSchema.html#responseSchemaConformance"><span class="hs-identifier">responseSchemaConformance</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Decoding.html#eitherDecode"><span class="hs-identifier">eitherDecode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html#encode"><span class="hs-identifier">encode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LBS</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeUtf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html"><span class="hs-identifier">Haskemathesis.Check.Standard.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html#failureDetail"><span class="hs-identifier">failureDetail</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html#findResponseSchema"><span class="hs-identifier">findResponseSchema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html"><span class="hs-identifier">Haskemathesis.Check.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier">Check</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#CheckResult"><span class="hs-identifier">CheckResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html"><span class="hs-identifier">Haskemathesis.Execute.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier">ApiResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html"><span class="hs-identifier">Haskemathesis.Schema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier">Schema</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#SchemaType"><span class="hs-identifier">SchemaType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Validate.html"><span class="hs-identifier">Haskemathesis.Validate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier">validateErrors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="annot"><span class="hs-comment">{- | Check that the response body conforms to the documented JSON schema.

This check validates the response body against the JSON Schema defined
in the OpenAPI specification for the given status code and content type.
It performs full schema validation including type checks, constraints,
and nested object/array validation.

==== Behavior

* __Passes__ when no schema is defined for the response
* __Passes__ when the response body validates against the schema
* __Fails__ when the response body is not valid JSON
* __Fails__ when the response body violates schema constraints

==== Validation includes

* Type checking (string, integer, number, boolean, array, object, null)
* String constraints (minLength, maxLength, pattern, format)
* Numeric constraints (minimum, maximum, exclusiveMinimum, exclusiveMaximum)
* Array constraints (minItems, maxItems, uniqueItems)
* Object constraints (required properties, additionalProperties)
* Composition keywords (oneOf, anyOf, allOf)

==== Example

@
-- Include schema validation in your checks
checks = ['responseSchemaConformance', 'notAServerError']
@
-}</span></span><span>
</span><span id="line-54"></span><span class="annot"><a href="Haskemathesis.Check.Standard.ResponseSchema.html#responseSchemaConformance"><span class="hs-identifier hs-type">responseSchemaConformance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span>
</span><span id="line-55"></span><span id="responseSchemaConformance"><span class="annot"><span class="annottext">responseSchemaConformance :: Check
</span><a href="Haskemathesis.Check.Standard.ResponseSchema.html#responseSchemaConformance"><span class="hs-identifier hs-var hs-var">responseSchemaConformance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; (ApiRequest -&gt; ApiResponse -&gt; ResolvedOperation -&gt; CheckResult)
-&gt; Check
</span><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-var">Check</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;response_schema_conformance&quot;</span></span><span> </span><span class="annot"><span class="annottext">((ApiRequest -&gt; ApiResponse -&gt; ResolvedOperation -&gt; CheckResult)
 -&gt; Check)
-&gt; (ApiRequest -&gt; ApiResponse -&gt; ResolvedOperation -&gt; CheckResult)
-&gt; Check
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679242518"><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679242518"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679242519"><span class="annot"><span class="annottext">ApiResponse
</span><a href="#local-6989586621679242519"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621679242520"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679242520"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-57"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ApiResponse -&gt; ResolvedOperation -&gt; Maybe Schema
</span><a href="Haskemathesis.Check.Standard.Helpers.html#findResponseSchema"><span class="hs-identifier hs-var">findResponseSchema</span></a></span><span> </span><span class="annot"><span class="annottext">ApiResponse
</span><a href="#local-6989586621679242519"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679242520"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-58"></span><span>            </span><span class="annot"><span class="annottext">Maybe Schema
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Haskemathesis.Check.Types.html#CheckPassed"><span class="hs-identifier hs-var">CheckPassed</span></a></span><span>
</span><span id="line-59"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679242522"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679242522"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-60"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String Value
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Decoding.html#eitherDecode"><span class="hs-identifier hs-var">eitherDecode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">LBS.fromStrict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiResponse -&gt; StrictByteString
</span><a href="Haskemathesis.Execute.Types.html#resBody"><span class="hs-identifier hs-var">resBody</span></a></span><span> </span><span class="annot"><span class="annottext">ApiResponse
</span><a href="#local-6989586621679242519"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-61"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679242525"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679242525"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-62"></span><span>                        </span><span class="annot"><span class="annottext">FailureDetail -&gt; CheckResult
</span><a href="Haskemathesis.Check.Types.html#CheckFailed"><span class="hs-identifier hs-var">CheckFailed</span></a></span><span>
</span><span id="line-63"></span><span>                            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Text
-&gt; [Text]
-&gt; Maybe Text
-&gt; ApiRequest
-&gt; ApiResponse
-&gt; ResolvedOperation
-&gt; FailureDetail
</span><a href="Haskemathesis.Check.Standard.Helpers.html#failureDetail"><span class="hs-identifier hs-var">failureDetail</span></a></span><span>
</span><span id="line-64"></span><span>                                </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;response_schema_conformance&quot;</span></span><span>
</span><span id="line-65"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;response body is not valid JSON: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679242525"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>                                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>                                </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-68"></span><span>                                </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679242518"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-69"></span><span>                                </span><span class="annot"><span class="annottext">ApiResponse
</span><a href="#local-6989586621679242519"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-70"></span><span>                                </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679242520"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-71"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679242528"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679242528"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-73"></span><span>                        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier hs-var">validateErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679242522"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679242528"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-74"></span><span>                            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Haskemathesis.Check.Types.html#CheckPassed"><span class="hs-identifier hs-var">CheckPassed</span></a></span><span>
</span><span id="line-75"></span><span>                            </span><span id="local-6989586621679242529"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679242529"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-76"></span><span>                                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679242530"><span class="annot"><span class="annottext">diff :: Text
</span><a href="#local-6989586621679242530"><span class="hs-identifier hs-var hs-var">diff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text] -&gt; Text
</span><a href="Haskemathesis.Check.Standard.ResponseSchema.html#schemaDiff"><span class="hs-identifier hs-var">schemaDiff</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679242522"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679242528"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679242529"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-77"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FailureDetail -&gt; CheckResult
</span><a href="Haskemathesis.Check.Types.html#CheckFailed"><span class="hs-identifier hs-var">CheckFailed</span></a></span><span>
</span><span id="line-78"></span><span>                                        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Text
-&gt; [Text]
-&gt; Maybe Text
-&gt; ApiRequest
-&gt; ApiResponse
-&gt; ResolvedOperation
-&gt; FailureDetail
</span><a href="Haskemathesis.Check.Standard.Helpers.html#failureDetail"><span class="hs-identifier hs-var">failureDetail</span></a></span><span>
</span><span id="line-79"></span><span>                                            </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;response_schema_conformance&quot;</span></span><span>
</span><span id="line-80"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;response violates schema: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;; &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679242529"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>                                            </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679242529"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-82"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679242530"><span class="hs-identifier hs-var">diff</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>                                            </span><span class="annot"><span class="annottext">ApiRequest
</span><a href="#local-6989586621679242518"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-84"></span><span>                                            </span><span class="annot"><span class="annottext">ApiResponse
</span><a href="#local-6989586621679242519"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-85"></span><span>                                            </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679242520"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-86"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Haskemathesis.Check.Standard.ResponseSchema.html#schemaDiff"><span class="hs-identifier hs-type">schemaDiff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-89"></span><span id="schemaDiff"><span class="annot"><span class="annottext">schemaDiff :: Schema -&gt; Value -&gt; [Text] -&gt; Text
</span><a href="Haskemathesis.Check.Standard.ResponseSchema.html#schemaDiff"><span class="hs-identifier hs-var hs-var">schemaDiff</span></a></span></span><span> </span><span id="local-6989586621679242533"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679242533"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679242534"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679242534"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679242535"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679242535"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span>
</span><span id="line-91"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Expected value to satisfy schema:&quot;</span></span><span>
</span><span id="line-93"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;  type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe SchemaType -&gt; Text
</span><a href="Haskemathesis.Check.Standard.ResponseSchema.html#renderSchemaType"><span class="hs-identifier hs-var">renderSchemaType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Maybe SchemaType
</span><a href="Haskemathesis.Schema.html#schemaType"><span class="hs-identifier hs-var">schemaType</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679242533"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>            </span><span class="annot"><span class="annottext">[Text] -&gt; [Text] -&gt; [Text]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; [Text] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;  - &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679242535"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-96"></span><span>            </span><span class="annot"><span class="annottext">[Text] -&gt; [Text] -&gt; [Text]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Actual value: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; StrictByteString
</span><span class="hs-identifier hs-var">LBS.toStrict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679242534"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Haskemathesis.Check.Standard.ResponseSchema.html#renderSchemaType"><span class="hs-identifier hs-type">renderSchemaType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#SchemaType"><span class="hs-identifier hs-type">SchemaType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-100"></span><span id="renderSchemaType"><span class="annot"><span class="annottext">renderSchemaType :: Maybe SchemaType -&gt; Text
</span><a href="Haskemathesis.Check.Standard.ResponseSchema.html#renderSchemaType"><span class="hs-identifier hs-var hs-var">renderSchemaType</span></a></span></span><span> </span><span id="local-6989586621679242539"><span class="annot"><span class="annottext">Maybe SchemaType
</span><a href="#local-6989586621679242539"><span class="hs-identifier hs-var">mType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe SchemaType
</span><a href="#local-6989586621679242539"><span class="hs-identifier hs-var">mType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="annottext">Maybe SchemaType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;unspecified&quot;</span></span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SString"><span class="hs-identifier hs-var">SString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;string&quot;</span></span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SInteger"><span class="hs-identifier hs-var">SInteger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;integer&quot;</span></span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SNumber"><span class="hs-identifier hs-var">SNumber</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;number&quot;</span></span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SBoolean"><span class="hs-identifier hs-var">SBoolean</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;boolean&quot;</span></span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SArray"><span class="hs-identifier hs-var">SArray</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;array&quot;</span></span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SObject"><span class="hs-identifier hs-var">SObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;object&quot;</span></span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SNull"><span class="hs-identifier hs-var">SNull</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;null&quot;</span></span><span>
</span><span id="line-110"></span></pre></body></html>