<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE StrictData #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">{- | Load OpenAPI specs from YAML or JSON files or URLs.

This module provides functions for loading OpenAPI specifications
from disk or remote URLs. It supports both YAML and JSON formats,
automatically detecting the format based on file extension and content.

=== Basic Usage

Load a specification from a file:

@
import Haskemathesis.OpenApi.Loader (loadOpenApiFile)

main :: IO ()
main = do
    result &lt;- loadOpenApiFile &quot;api.yaml&quot;
    case result of
        Left err -&gt; putStrLn $ &quot;Failed to load: &quot; ++ show err
        Right spec -&gt; putStrLn &quot;Loaded successfully!&quot;
@

=== Loading from URLs

You can also load specifications from URLs:

@
import Haskemathesis.OpenApi.Loader (loadOpenApi)

main :: IO ()
main = do
    result &lt;- loadOpenApi &quot;https://api.example.com/openapi.yaml&quot;
    case result of
        Left err -&gt; putStrLn $ &quot;Failed to load: &quot; ++ show err
        Right spec -&gt; putStrLn &quot;Loaded from URL!&quot;
@

=== Error Handling

The loader returns 'Either Text OpenApi', where the Left case
contains a descriptive error message if parsing fails. This
can happen due to:

* File not found or unreadable
* Network error when fetching from URL
* Invalid YAML/JSON syntax
* Invalid OpenAPI structure (validation errors)

=== Supported Formats

* YAML files (.yaml, .yml extension)
* JSON files (.json extension)
* Files without extension (auto-detected by content)
* HTTP/HTTPS URLs

=== OpenAPI 3.1 Support

This loader automatically transforms OpenAPI 3.1 constructs to
their OpenAPI 3.0 equivalents before parsing. This includes:

* @exclusiveMinimum: \&lt;number\&gt;@ &#8594; @minimum: \&lt;number\&gt;, exclusiveMinimum: true@
* @exclusiveMaximum: \&lt;number\&gt;@ &#8594; @maximum: \&lt;number\&gt;, exclusiveMaximum: true@

This allows specs written for OpenAPI 3.1 (which uses JSON Schema 2020-12)
to be loaded by the openapi3 library which only supports OpenAPI 3.0.
-}</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html"><span class="hs-identifier">Haskemathesis.OpenApi.Loader</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Loading functions</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApi"><span class="hs-identifier">loadOpenApi</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFile"><span class="hs-identifier">loadOpenApiFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiUrl"><span class="hs-identifier">loadOpenApiUrl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFileWithExtensions"><span class="hs-identifier">loadOpenApiFileWithExtensions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationExtensions"><span class="hs-identifier">OperationExtensions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationKey"><span class="hs-identifier">OperationKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="hs-comment">-- * URL detection</span></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#isUrl"><span class="hs-identifier">isUrl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Internal (exported for testing)</span></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#transformOpenApi31To30"><span class="hs-identifier">transformOpenApi31To30</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#extractOperationExtensions"><span class="hs-identifier">extractOperationExtensions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SomeException</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Result"><span class="hs-identifier">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.FromJSON.html#fromJSON"><span class="hs-identifier">fromJSON</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#Key"><span class="hs-identifier">Key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Key</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html"><span class="hs-identifier">Data.Aeson.KeyMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KM</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LBS</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isPrefixOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.html"><span class="hs-identifier">Data.OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier">OpenApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html"><span class="hs-identifier">Data.Scientific</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html#isInteger"><span class="hs-identifier">isInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html#toBoundedInteger"><span class="hs-identifier">toBoundedInteger</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.html"><span class="hs-identifier">Data.Yaml</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.html#decodeEither%27"><span class="hs-identifier">decodeEither'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.html#decodeFileEither"><span class="hs-identifier">decodeFileEither</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.Internal.html#prettyPrintParseException"><span class="hs-identifier">prettyPrintParseException</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.html"><span class="hs-identifier">Network.HTTP.Client</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Core.html#httpLbs"><span class="hs-identifier">httpLbs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Manager.html#newManager"><span class="hs-identifier">newManager</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Request.html#parseRequest"><span class="hs-identifier">parseRequest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#responseBody"><span class="hs-identifier">responseBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#responseStatus"><span class="hs-identifier">responseStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/frgzsv75xsqzxm0xxm7rd96lflgsl49l-http-client-tls-0.3.6.4-doc/share/doc/http-client-tls-0.3.6.4/html/src/Network.HTTP.Client.TLS.html"><span class="hs-identifier">Network.HTTP.Client.TLS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/frgzsv75xsqzxm0xxm7rd96lflgsl49l-http-client-tls-0.3.6.4-doc/share/doc/http-client-tls-0.3.6.4/html/src/Network.HTTP.Client.TLS.html#tlsManagerSettings"><span class="hs-identifier">tlsManagerSettings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.Status.html"><span class="hs-identifier">Network.HTTP.Types.Status</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.Status.html#statusCode"><span class="hs-identifier">statusCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><span class="hs-comment">{- | Load an OpenAPI specification from a file.

This function reads a YAML or JSON file and parses it into an
'OpenApi' value. It automatically detects the file format.

OpenAPI 3.1 specs are automatically transformed to OpenAPI 3.0
format before parsing, allowing compatibility with the openapi3 library.

=== Parameters

* @path@ - Path to the OpenAPI specification file

=== Return Value

Returns 'Right OpenApi' on success, or 'Left Text' with an error
message on failure.

=== Example

@
main :: IO ()
main = do
    result &lt;- loadOpenApiFile &quot;specs/api.yaml&quot;
    case result of
        Left err -&gt; putStrLn $ &quot;Error: &quot; ++ T.unpack err
        Right spec -&gt; do
            putStrLn $ &quot;Loaded API with &quot; ++ show (length spec) ++ &quot; paths&quot;
@
-}</span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><span class="hs-comment">{- | Load an OpenAPI specification from a file path or URL.

This is the recommended entry point for loading specs. It automatically
detects whether the input is a URL (starting with @http://@ or @https://@)
or a file path, and uses the appropriate loading method.

=== Parameters

* @pathOrUrl@ - Either a file path or a URL to the OpenAPI specification

=== Return Value

Returns 'Right OpenApi' on success, or 'Left Text' with an error
message on failure.

=== Example

@
-- Load from file
spec1 &lt;- loadOpenApi &quot;api.yaml&quot;

-- Load from URL
spec2 &lt;- loadOpenApi &quot;https://petstore.swagger.io/v2/swagger.json&quot;
@
-}</span></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApi"><span class="hs-identifier hs-type">loadOpenApi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span id="loadOpenApi"><span class="annot"><span class="annottext">loadOpenApi :: [Char] -&gt; IO (Either Text OpenApi)
</span><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApi"><span class="hs-identifier hs-var hs-var">loadOpenApi</span></a></span></span><span> </span><span id="local-6989586621679237688"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237688"><span class="hs-identifier hs-var">pathOrUrl</span></a></span></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
</span><a href="Haskemathesis.OpenApi.Loader.html#isUrl"><span class="hs-identifier hs-var">isUrl</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237688"><span class="hs-identifier hs-var">pathOrUrl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either Text OpenApi)
</span><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiUrl"><span class="hs-identifier hs-var">loadOpenApiUrl</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237688"><span class="hs-identifier hs-var">pathOrUrl</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either Text OpenApi)
</span><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFile"><span class="hs-identifier hs-var">loadOpenApiFile</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237688"><span class="hs-identifier hs-var">pathOrUrl</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><span class="hs-comment">-- | Check if a string is a URL (starts with http:// or https://).</span></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#isUrl"><span class="hs-identifier hs-type">isUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-174"></span><span id="isUrl"><span class="annot"><span class="annottext">isUrl :: [Char] -&gt; Bool
</span><a href="Haskemathesis.OpenApi.Loader.html#isUrl"><span class="hs-identifier hs-var hs-var">isUrl</span></a></span></span><span> </span><span id="local-6989586621679237689"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237689"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;http://&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237689"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237689"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFile"><span class="hs-identifier hs-type">loadOpenApiFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="loadOpenApiFile"><span class="annot"><span class="annottext">loadOpenApiFile :: [Char] -&gt; IO (Either Text OpenApi)
</span><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFile"><span class="hs-identifier hs-var hs-var">loadOpenApiFile</span></a></span></span><span> </span><span id="local-6989586621679237692"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237692"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-comment">-- First parse as raw Value to allow transformation</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679237693"><span class="annot"><a href="#local-6989586621679237693"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either ParseException Value)
forall a. FromJSON a =&gt; [Char] -&gt; IO (Either ParseException a)
</span><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.html#decodeFileEither"><span class="hs-identifier hs-var">decodeFileEither</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237692"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679237693"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679237694"><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679237694"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text OpenApi
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseException -&gt; [Char]
</span><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.Internal.html#prettyPrintParseException"><span class="hs-identifier hs-var">prettyPrintParseException</span></a></span><span> </span><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679237694"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679237696"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237696"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-comment">-- Transform 3.1 constructs to 3.0, then decode to OpenApi</span><span>
</span><span id="line-184"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237697"><span class="annot"><span class="annottext">transformed :: Value
</span><a href="#local-6989586621679237697"><span class="hs-identifier hs-var hs-var">transformed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><a href="Haskemathesis.OpenApi.Loader.html#transformOpenApi31To30"><span class="hs-identifier hs-var">transformOpenApi31To30</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237696"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-185"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Result OpenApi
forall a. FromJSON a =&gt; Value -&gt; Result a
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.FromJSON.html#fromJSON"><span class="hs-identifier hs-var">fromJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237697"><span class="hs-identifier hs-var">transformed</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span id="local-6989586621679237699"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237699"><span class="hs-identifier hs-var">err'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text OpenApi
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237699"><span class="hs-identifier hs-var">err'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span id="local-6989586621679237701"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679237701"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; Either Text OpenApi
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679237701"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><span class="hs-comment">{- | Load an OpenAPI specification from a URL.

This function fetches an OpenAPI specification from an HTTP or HTTPS URL.
It supports both YAML and JSON formats.

=== Parameters

* @url@ - URL to the OpenAPI specification (must start with http:// or https://)

=== Return Value

Returns 'Right OpenApi' on success, or 'Left Text' with an error
message on failure.

=== Example

@
result &lt;- loadOpenApiUrl &quot;https://petstore.swagger.io/v2/swagger.json&quot;
case result of
    Left err -&gt; putStrLn $ &quot;Failed to fetch: &quot; ++ T.unpack err
    Right spec -&gt; putStrLn &quot;Loaded from URL!&quot;
@

=== Notes

* Uses TLS for HTTPS connections
* Follows redirects automatically
* Returns an error if the response status is not 2xx
-}</span></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiUrl"><span class="hs-identifier hs-type">loadOpenApiUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span id="loadOpenApiUrl"><span class="annot"><span class="annottext">loadOpenApiUrl :: [Char] -&gt; IO (Either Text OpenApi)
</span><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiUrl"><span class="hs-identifier hs-var hs-var">loadOpenApiUrl</span></a></span></span><span> </span><span id="local-6989586621679237702"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237702"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679237703"><span class="annot"><a href="#local-6989586621679237703"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either Text ByteString)
</span><a href="Haskemathesis.OpenApi.Loader.html#fetchUrl"><span class="hs-identifier hs-var">fetchUrl</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237702"><span class="hs-identifier hs-var">url</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679237703"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679237705"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237705"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text OpenApi
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237705"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679237706"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679237706"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>            </span><span class="hs-comment">-- Parse as YAML (which is a superset of JSON)</span><span>
</span><span id="line-225"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either ParseException Value
forall a. FromJSON a =&gt; ByteString -&gt; Either ParseException a
</span><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.html#decodeEither%27"><span class="hs-identifier hs-var">decodeEither'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">LBS.toStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679237706"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679237708"><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679237708"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text OpenApi
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseException -&gt; [Char]
</span><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.Internal.html#prettyPrintParseException"><span class="hs-identifier hs-var">prettyPrintParseException</span></a></span><span> </span><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679237708"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679237709"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237709"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237710"><span class="annot"><span class="annottext">transformed :: Value
</span><a href="#local-6989586621679237710"><span class="hs-identifier hs-var hs-var">transformed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><a href="Haskemathesis.OpenApi.Loader.html#transformOpenApi31To30"><span class="hs-identifier hs-var">transformOpenApi31To30</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237709"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-229"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Result OpenApi
forall a. FromJSON a =&gt; Value -&gt; Result a
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.FromJSON.html#fromJSON"><span class="hs-identifier hs-var">fromJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237710"><span class="hs-identifier hs-var">transformed</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-230"></span><span>                            </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span id="local-6989586621679237711"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237711"><span class="hs-identifier hs-var">err'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text OpenApi
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237711"><span class="hs-identifier hs-var">err'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                            </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span id="local-6989586621679237712"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679237712"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; Either Text OpenApi
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679237712"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><span class="hs-comment">-- | Fetch content from a URL.</span></span><span>
</span><span id="line-234"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#fetchUrl"><span class="hs-identifier hs-type">fetchUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LBS.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span id="fetchUrl"><span class="annot"><span class="annottext">fetchUrl :: [Char] -&gt; IO (Either Text ByteString)
</span><a href="Haskemathesis.OpenApi.Loader.html#fetchUrl"><span class="hs-identifier hs-var hs-var">fetchUrl</span></a></span></span><span> </span><span id="local-6989586621679237713"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237713"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-237"></span><span>        </span><span id="local-6989586621679237714"><span class="annot"><a href="#local-6989586621679237714"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; IO Manager
</span><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Manager.html#newManager"><span class="hs-identifier hs-var">newManager</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="file:///nix/store/frgzsv75xsqzxm0xxm7rd96lflgsl49l-http-client-tls-0.3.6.4-doc/share/doc/http-client-tls-0.3.6.4/html/src/Network.HTTP.Client.TLS.html#tlsManagerSettings"><span class="hs-identifier hs-var">tlsManagerSettings</span></a></span><span>
</span><span id="line-238"></span><span>        </span><span id="local-6989586621679237715"><span class="annot"><a href="#local-6989586621679237715"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Request.html#parseRequest"><span class="hs-identifier hs-type">parseRequest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237713"><span class="hs-identifier hs-type">url</span></a></span><span>
</span><span id="line-239"></span><span>        </span><span id="local-6989586621679237716"><span class="annot"><a href="#local-6989586621679237716"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Core.html#httpLbs"><span class="hs-identifier hs-type">httpLbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237715"><span class="hs-identifier hs-type">request</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237714"><span class="hs-identifier hs-type">manager</span></a></span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237717"><span class="annot"><a href="#local-6989586621679237717"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status -&gt; Int
</span><a href="file:///nix/store/fsi2cvnm3mdngjk22hkkpyl0q5h66sjj-http-types-0.12.4-doc/share/doc/http-types-0.12.4/html/src/Network.HTTP.Types.Status.html#statusCode"><span class="hs-identifier hs-var">statusCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response ByteString -&gt; Status
forall body. Response body -&gt; Status
</span><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#responseStatus"><span class="hs-identifier hs-var">responseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679237716"><span class="hs-identifier hs-var">response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679237717"><span class="hs-identifier hs-type">status</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621679237717"><span class="hs-identifier hs-type">status</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">300</span></span><span>
</span><span id="line-242"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#responseBody"><span class="hs-identifier hs-var">responseBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237716"><span class="hs-identifier hs-type">response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HTTP error: status &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621679237717"><span class="hs-identifier hs-type">status</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>        </span><span class="annot"><span class="annottext">IO (Either Text ByteString)
-&gt; (SomeException -&gt; IO (Either Text ByteString))
-&gt; IO (Either Text ByteString)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`catch`</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; IO (Either Text ByteString)
</span><a href="#local-6989586621679237721"><span class="hs-identifier hs-var">handleHttpException</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><a href="#local-6989586621679237721"><span class="hs-identifier hs-type">handleHttpException</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LBS.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679237721"><span class="annot"><span class="annottext">handleHttpException :: SomeException -&gt; IO (Either Text ByteString)
</span><a href="#local-6989586621679237721"><span class="hs-identifier hs-var hs-var">handleHttpException</span></a></span></span><span> </span><span id="local-6989586621679237722"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679237722"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Text ByteString -&gt; IO (Either Text ByteString)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Text ByteString -&gt; IO (Either Text ByteString))
-&gt; Either Text ByteString -&gt; IO (Either Text ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either Text ByteString) -&gt; Text -&gt; Either Text ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Failed to fetch URL: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679237722"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><span class="hs-comment">{- | Transform OpenAPI 3.1 JSON Schema constructs to OpenAPI 3.0 equivalents.

This function recursively walks the JSON structure and transforms:

* OpenAPI version @3.1.x@ to @3.0.3@ (highest supported by openapi3 library)
* Numeric @exclusiveMinimum@ to @minimum@ + boolean @exclusiveMinimum: true@
* Numeric @exclusiveMaximum@ to @maximum@ + boolean @exclusiveMaximum: true@

This allows OpenAPI 3.1 specs (which use JSON Schema 2020-12 semantics)
to be parsed by libraries that only support OpenAPI 3.0 (JSON Schema draft-04).
-}</span></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#transformOpenApi31To30"><span class="hs-identifier hs-type">transformOpenApi31To30</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-262"></span><span id="transformOpenApi31To30"><span class="annot"><span class="annottext">transformOpenApi31To30 :: Value -&gt; Value
</span><a href="Haskemathesis.OpenApi.Loader.html#transformOpenApi31To30"><span class="hs-identifier hs-var hs-var">transformOpenApi31To30</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><a href="#local-6989586621679237723"><span class="hs-identifier hs-var">transformValue</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><a href="#local-6989586621679237723"><span class="hs-identifier hs-type">transformValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621679237723"><span class="annot"><span class="annottext">transformValue :: Value -&gt; Value
</span><a href="#local-6989586621679237723"><span class="hs-identifier hs-var hs-var">transformValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679237725"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237725"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Value
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-var">Object</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679237726"><span class="hs-identifier hs-var">transformObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237725"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><a href="#local-6989586621679237723"><span class="hs-identifier hs-var">transformValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span id="local-6989586621679237728"><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679237728"><span class="hs-identifier hs-var">arr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array -&gt; Value
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-var">Array</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; Array -&gt; Array
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><a href="#local-6989586621679237723"><span class="hs-identifier hs-var">transformValue</span></a></span><span> </span><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679237728"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><a href="#local-6989586621679237723"><span class="hs-identifier hs-var">transformValue</span></a></span><span> </span><span id="local-6989586621679237730"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237730"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237730"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><a href="#local-6989586621679237726"><span class="hs-identifier hs-type">transformObject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679237726"><span class="annot"><span class="annottext">transformObject :: Object -&gt; Object
</span><a href="#local-6989586621679237726"><span class="hs-identifier hs-var hs-var">transformObject</span></a></span></span><span> </span><span id="local-6989586621679237731"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237731"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-272"></span><span>            </span><span class="hs-comment">-- First recursively transform all nested values</span><span>
</span><span id="line-273"></span><span>            </span><span id="local-6989586621679237732"><span class="annot"><span class="annottext">recursed :: Object
</span><a href="#local-6989586621679237732"><span class="hs-identifier hs-var hs-var">recursed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; Object -&gt; Object
forall a b. (a -&gt; b) -&gt; KeyMap a -&gt; KeyMap b
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#map"><span class="hs-identifier hs-var">KM.map</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><a href="#local-6989586621679237723"><span class="hs-identifier hs-var">transformValue</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237731"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-274"></span><span>            </span><span class="hs-comment">-- Transform OpenAPI version 3.1.x to 3.0.3</span><span>
</span><span id="line-275"></span><span>            </span><span id="local-6989586621679237734"><span class="annot"><span class="annottext">withVersion :: Object
</span><a href="#local-6989586621679237734"><span class="hs-identifier hs-var hs-var">withVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679237735"><span class="hs-identifier hs-var">transformOpenapiVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237732"><span class="hs-identifier hs-var">recursed</span></a></span><span>
</span><span id="line-276"></span><span>            </span><span class="hs-comment">-- Then apply exclusiveMinimum/Maximum transformations</span><span>
</span><span id="line-277"></span><span>            </span><span id="local-6989586621679237736"><span class="annot"><span class="annottext">withExclMin :: Object
</span><a href="#local-6989586621679237736"><span class="hs-identifier hs-var hs-var">withExclMin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679237737"><span class="hs-identifier hs-var">transformExclusiveMinimum</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237734"><span class="hs-identifier hs-var">withVersion</span></a></span><span>
</span><span id="line-278"></span><span>            </span><span id="local-6989586621679237738"><span class="annot"><span class="annottext">withExclMax :: Object
</span><a href="#local-6989586621679237738"><span class="hs-identifier hs-var hs-var">withExclMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679237739"><span class="hs-identifier hs-var">transformExclusiveMaximum</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237736"><span class="hs-identifier hs-var">withExclMin</span></a></span><span>
</span><span id="line-279"></span><span>         </span><span class="hs-keyword">in</span><span>
</span><span id="line-280"></span><span>            </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237738"><span class="hs-identifier hs-var">withExclMax</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-comment">-- Transform openapi: &quot;3.1.x&quot; to &quot;3.0.3&quot;</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="#local-6989586621679237735"><span class="hs-identifier hs-type">transformOpenapiVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621679237735"><span class="annot"><span class="annottext">transformOpenapiVersion :: Object -&gt; Object
</span><a href="#local-6989586621679237735"><span class="hs-identifier hs-var hs-var">transformOpenapiVersion</span></a></span></span><span> </span><span id="local-6989586621679237740"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237740"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Object -&gt; Maybe Value
forall v. Key -&gt; KeyMap v -&gt; Maybe v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#lookup"><span class="hs-identifier hs-var">KM.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237742"><span class="hs-identifier hs-var">openapiKey</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237740"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621679237744"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237744"><span class="hs-identifier hs-var">ver</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.isPrefixOf</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;3.1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237744"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>                    </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Object -&gt; Object
forall v. Key -&gt; v -&gt; KeyMap v -&gt; KeyMap v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#insert"><span class="hs-identifier hs-var">KM.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237742"><span class="hs-identifier hs-var">openapiKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-var">String</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;3.0.3&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237740"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-289"></span><span>            </span><span id="local-6989586621679237747"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679237747"><span class="hs-identifier hs-var">_notOpenApi31</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237740"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-comment">-- Transform exclusive&lt;Bound&gt;: &lt;number&gt; to &lt;bound&gt;: &lt;number&gt;, exclusive&lt;Bound&gt;: true</span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><a href="#local-6989586621679237748"><span class="hs-identifier hs-type">transformExclusiveBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679237748"><span class="annot"><span class="annottext">transformExclusiveBound :: Key -&gt; Key -&gt; Object -&gt; Object
</span><a href="#local-6989586621679237748"><span class="hs-identifier hs-var hs-var">transformExclusiveBound</span></a></span></span><span> </span><span id="local-6989586621679237749"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237749"><span class="hs-identifier hs-var">exclusiveKey</span></a></span></span><span> </span><span id="local-6989586621679237750"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237750"><span class="hs-identifier hs-var">boundKey</span></a></span></span><span> </span><span id="local-6989586621679237751"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237751"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Object -&gt; Maybe Value
forall v. Key -&gt; KeyMap v -&gt; Maybe v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#lookup"><span class="hs-identifier hs-var">KM.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237749"><span class="hs-identifier hs-var">exclusiveKey</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237751"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-295"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span id="local-6989586621679237753"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679237753"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Bool
</span><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html#isInteger"><span class="hs-identifier hs-var">isInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679237753"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-297"></span><span>                    </span><span class="hs-comment">-- Remove the numeric exclusive bound</span><span>
</span><span id="line-298"></span><span>                    </span><span class="hs-comment">-- Add bound with the value, and exclusive bound: true</span><span>
</span><span id="line-299"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237754"><span class="annot"><span class="annottext">withoutOld :: Object
</span><a href="#local-6989586621679237754"><span class="hs-identifier hs-var hs-var">withoutOld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Object -&gt; Object
forall v. Key -&gt; KeyMap v -&gt; KeyMap v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#delete"><span class="hs-identifier hs-var">KM.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237749"><span class="hs-identifier hs-var">exclusiveKey</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237751"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-300"></span><span>                        </span><span id="local-6989586621679237756"><span class="annot"><span class="annottext">withBound :: Object
</span><a href="#local-6989586621679237756"><span class="hs-identifier hs-var hs-var">withBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Object -&gt; Object
forall v. Key -&gt; v -&gt; KeyMap v -&gt; KeyMap v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#insert"><span class="hs-identifier hs-var">KM.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237750"><span class="hs-identifier hs-var">boundKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scientific -&gt; Value
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-var">Number</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679237753"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237754"><span class="hs-identifier hs-var">withoutOld</span></a></span><span>
</span><span id="line-301"></span><span>                        </span><span id="local-6989586621679237757"><span class="annot"><span class="annottext">withExcl :: Object
</span><a href="#local-6989586621679237757"><span class="hs-identifier hs-var hs-var">withExcl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Object -&gt; Object
forall v. Key -&gt; v -&gt; KeyMap v -&gt; KeyMap v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#insert"><span class="hs-identifier hs-var">KM.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237749"><span class="hs-identifier hs-var">exclusiveKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Value
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237756"><span class="hs-identifier hs-var">withBound</span></a></span><span>
</span><span id="line-302"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237757"><span class="hs-identifier hs-var">withExcl</span></a></span><span>
</span><span id="line-303"></span><span>            </span><span id="local-6989586621679237759"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679237759"><span class="hs-identifier hs-var">_notNumericExcl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237751"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="#local-6989586621679237737"><span class="hs-identifier hs-type">transformExclusiveMinimum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679237737"><span class="annot"><span class="annottext">transformExclusiveMinimum :: Object -&gt; Object
</span><a href="#local-6989586621679237737"><span class="hs-identifier hs-var hs-var">transformExclusiveMinimum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Key -&gt; Object -&gt; Object
</span><a href="#local-6989586621679237748"><span class="hs-identifier hs-var">transformExclusiveBound</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;exclusiveMinimum&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;minimum&quot;</span></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><a href="#local-6989586621679237739"><span class="hs-identifier hs-type">transformExclusiveMaximum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679237739"><span class="annot"><span class="annottext">transformExclusiveMaximum :: Object -&gt; Object
</span><a href="#local-6989586621679237739"><span class="hs-identifier hs-var hs-var">transformExclusiveMaximum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Key -&gt; Object -&gt; Object
</span><a href="#local-6989586621679237748"><span class="hs-identifier hs-var">transformExclusiveBound</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;exclusiveMaximum&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;maximum&quot;</span></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="#local-6989586621679237742"><span class="hs-identifier hs-type">openapiKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679237742"><span class="annot"><span class="annottext">openapiKey :: Key
</span><a href="#local-6989586621679237742"><span class="hs-identifier hs-var hs-var">openapiKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;openapi&quot;</span></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><span class="hs-comment">{- | Vendor extensions extracted from an OpenAPI operation.

These extensions are non-standard fields (prefixed with @x-@) that
Haskemathesis recognizes for controlling test behavior.

=== Supported Extensions

[@x-timeout@] Request timeout in milliseconds. Useful for:

    * Streaming endpoints (SSE, NDJSON) that never complete
    * Slow endpoints that need longer than default timeout
    * Fast endpoints where you want to fail quickly

    Example in OpenAPI spec:

    @
    \/events:
      get:
        x-timeout: 2000  # 2 second timeout
        responses:
          &quot;200&quot;:
            content:
              text/event-stream: {}
    @

=== Why Use Extensions?

OpenAPI 3.x doesn't have a standard way to specify:

* Request timeouts
* Streaming behavior hints
* Test-specific configuration

Vendor extensions (x-* fields) are the OpenAPI-sanctioned way to add
such metadata while remaining spec-compliant.
-}</span></span><span>
</span><span id="line-350"></span><span class="hs-keyword">newtype</span><span> </span><span id="OperationExtensions"><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationExtensions"><span class="hs-identifier hs-var">OperationExtensions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OperationExtensions"><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationExtensions"><span class="hs-identifier hs-var">OperationExtensions</span></a></span></span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="oeTimeout"><span class="annot"><span class="annottext">OperationExtensions -&gt; Maybe Int
</span><a href="Haskemathesis.OpenApi.Loader.html#oeTimeout"><span class="hs-identifier hs-var hs-var">oeTimeout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Request timeout in milliseconds from @x-timeout@</span></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237763"><span id="local-6989586621679237769"><span class="annot"><span class="annottext">OperationExtensions -&gt; OperationExtensions -&gt; Bool
(OperationExtensions -&gt; OperationExtensions -&gt; Bool)
-&gt; (OperationExtensions -&gt; OperationExtensions -&gt; Bool)
-&gt; Eq OperationExtensions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: OperationExtensions -&gt; OperationExtensions -&gt; Bool
== :: OperationExtensions -&gt; OperationExtensions -&gt; Bool
$c/= :: OperationExtensions -&gt; OperationExtensions -&gt; Bool
/= :: OperationExtensions -&gt; OperationExtensions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237778"><span id="local-6989586621679237783"><span id="local-6989586621679237787"><span class="annot"><span class="annottext">Int -&gt; OperationExtensions -&gt; [Char] -&gt; [Char]
[OperationExtensions] -&gt; [Char] -&gt; [Char]
OperationExtensions -&gt; [Char]
(Int -&gt; OperationExtensions -&gt; [Char] -&gt; [Char])
-&gt; (OperationExtensions -&gt; [Char])
-&gt; ([OperationExtensions] -&gt; [Char] -&gt; [Char])
-&gt; Show OperationExtensions
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; OperationExtensions -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; OperationExtensions -&gt; [Char] -&gt; [Char]
$cshow :: OperationExtensions -&gt; [Char]
show :: OperationExtensions -&gt; [Char]
$cshowList :: [OperationExtensions] -&gt; [Char] -&gt; [Char]
showList :: [OperationExtensions] -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><span class="hs-comment">-- | Key for looking up operation extensions: (path, method)</span></span><span>
</span><span id="line-357"></span><span class="hs-keyword">type</span><span> </span><span id="OperationKey"><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationKey"><span class="hs-identifier hs-var">OperationKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><span class="hs-comment">{- | Load an OpenAPI spec along with vendor extensions.

This function returns both the parsed OpenAPI spec and a map of
vendor extensions for each operation, keyed by (path, method).

=== Example

@
result &lt;- loadOpenApiFileWithExtensions &quot;api.yaml&quot;
case result of
    Left err -&gt; putStrLn $ &quot;Error: &quot; ++ T.unpack err
    Right (spec, extensions) -&gt; do
        -- Look up timeout for GET /events
        let key = (&quot;/events&quot;, &quot;GET&quot;)
        case Map.lookup key extensions of
            Just ext -&gt; print (oeTimeout ext)
            Nothing -&gt; putStrLn &quot;No extensions&quot;
@
-}</span></span><span>
</span><span id="line-378"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFileWithExtensions"><span class="hs-identifier hs-type">loadOpenApiFileWithExtensions</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationKey"><span class="hs-identifier hs-type">OperationKey</span></a></span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationExtensions"><span class="hs-identifier hs-type">OperationExtensions</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span id="loadOpenApiFileWithExtensions"><span class="annot"><span class="annottext">loadOpenApiFileWithExtensions :: [Char]
-&gt; IO (Either Text (OpenApi, Map OperationKey OperationExtensions))
</span><a href="Haskemathesis.OpenApi.Loader.html#loadOpenApiFileWithExtensions"><span class="hs-identifier hs-var hs-var">loadOpenApiFileWithExtensions</span></a></span></span><span> </span><span id="local-6989586621679237791"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237791"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679237792"><span class="annot"><a href="#local-6989586621679237792"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either ParseException Value)
forall a. FromJSON a =&gt; [Char] -&gt; IO (Either ParseException a)
</span><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.html#decodeFileEither"><span class="hs-identifier hs-var">decodeFileEither</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237791"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679237792"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-384"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679237793"><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679237793"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text (OpenApi, Map OperationKey OperationExtensions)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseException -&gt; [Char]
</span><a href="file:///nix/store/5yy64md1ny6jpffrkgsq9gn90diwkshl-yaml-0.11.11.2-doc/share/doc/yaml-0.11.11.2/html/src/Data.Yaml.Internal.html#prettyPrintParseException"><span class="hs-identifier hs-var">prettyPrintParseException</span></a></span><span> </span><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679237793"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679237794"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237794"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-386"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237795"><span class="annot"><span class="annottext">transformed :: Value
</span><a href="#local-6989586621679237795"><span class="hs-identifier hs-var hs-var">transformed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><a href="Haskemathesis.OpenApi.Loader.html#transformOpenApi31To30"><span class="hs-identifier hs-var">transformOpenApi31To30</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237794"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-387"></span><span>                </span><span id="local-6989586621679237796"><span class="annot"><span class="annottext">extensions :: Map OperationKey OperationExtensions
</span><a href="#local-6989586621679237796"><span class="hs-identifier hs-var hs-var">extensions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Map OperationKey OperationExtensions
</span><a href="Haskemathesis.OpenApi.Loader.html#extractOperationExtensions"><span class="hs-identifier hs-var">extractOperationExtensions</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237794"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-388"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Result OpenApi
forall a. FromJSON a =&gt; Value -&gt; Result a
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.FromJSON.html#fromJSON"><span class="hs-identifier hs-var">fromJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237795"><span class="hs-identifier hs-var">transformed</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-389"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span id="local-6989586621679237797"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237797"><span class="hs-identifier hs-var">err'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text (OpenApi, Map OperationKey OperationExtensions)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679237797"><span class="hs-identifier hs-var">err'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span id="local-6989586621679237798"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679237798"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApi, Map OperationKey OperationExtensions)
-&gt; Either Text (OpenApi, Map OperationKey OperationExtensions)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679237798"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map OperationKey OperationExtensions
</span><a href="#local-6989586621679237796"><span class="hs-identifier hs-var">extensions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="annot"><span class="hs-comment">{- | Extract vendor extensions from all operations in a raw OpenAPI JSON value.

This function walks the paths and operations in the raw JSON to extract
x-* fields before they are discarded by the openapi3 library parser.

Returns a map from (path, method) to the extracted extensions.
-}</span></span><span>
</span><span id="line-399"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#extractOperationExtensions"><span class="hs-identifier hs-type">extractOperationExtensions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationKey"><span class="hs-identifier hs-type">OperationKey</span></a></span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationExtensions"><span class="hs-identifier hs-type">OperationExtensions</span></a></span><span>
</span><span id="line-400"></span><span id="extractOperationExtensions"><span class="annot"><span class="annottext">extractOperationExtensions :: Value -&gt; Map OperationKey OperationExtensions
</span><a href="Haskemathesis.OpenApi.Loader.html#extractOperationExtensions"><span class="hs-identifier hs-var hs-var">extractOperationExtensions</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679237799"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237799"><span class="hs-identifier hs-var">root</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Object -&gt; Maybe Value
forall v. Key -&gt; KeyMap v -&gt; Maybe v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#lookup"><span class="hs-identifier hs-var">KM.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;paths&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237799"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679237800"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237800"><span class="hs-identifier hs-var">paths</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>            </span><span class="annot"><span class="annottext">[(OperationKey, OperationExtensions)]
-&gt; Map OperationKey OperationExtensions
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-404"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237802"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237803"><span class="hs-identifier hs-var">method</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OperationExtensions
</span><a href="#local-6989586621679237804"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237805"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237805"><span class="hs-identifier hs-var">pathKey</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679237806"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237806"><span class="hs-identifier hs-var">pathItem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [(Key, Value)]
forall v. KeyMap v -&gt; [(Key, v)]
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#toList"><span class="hs-identifier hs-var">KM.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237800"><span class="hs-identifier hs-var">paths</span></a></span><span>
</span><span id="line-406"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237802"><span class="annot"><span class="annottext">path :: Text
</span><a href="#local-6989586621679237802"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#toText"><span class="hs-identifier hs-var">Key.toText</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237805"><span class="hs-identifier hs-var">pathKey</span></a></span><span>
</span><span id="line-407"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237809"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237809"><span class="hs-identifier hs-var">methodKey</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679237810"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237810"><span class="hs-identifier hs-var">operation</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [(Key, Value)]
forall v. KeyMap v -&gt; [(Key, v)]
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#toList"><span class="hs-identifier hs-var">KM.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237806"><span class="hs-identifier hs-var">pathItem</span></a></span><span>
</span><span id="line-408"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237803"><span class="annot"><span class="annottext">method :: Text
</span><a href="#local-6989586621679237803"><span class="hs-identifier hs-var hs-var">method</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toUpper</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; Text
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#toText"><span class="hs-identifier hs-var">Key.toText</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679237809"><span class="hs-identifier hs-var">methodKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679237803"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="Haskemathesis.OpenApi.Loader.html#httpMethods"><span class="hs-identifier hs-var">httpMethods</span></a></span><span>
</span><span id="line-410"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237804"><span class="annot"><span class="annottext">ext :: OperationExtensions
</span><a href="#local-6989586621679237804"><span class="hs-identifier hs-var hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; OperationExtensions
</span><a href="Haskemathesis.OpenApi.Loader.html#extractExtensionsFromOperation"><span class="hs-identifier hs-var">extractExtensionsFromOperation</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237810"><span class="hs-identifier hs-var">operation</span></a></span><span>
</span><span id="line-411"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-412"></span><span>        </span><span id="local-6989586621679237815"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679237815"><span class="hs-identifier hs-var">_noPaths</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map OperationKey OperationExtensions
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-413"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#extractOperationExtensions"><span class="hs-identifier hs-var">extractOperationExtensions</span></a></span><span> </span><span id="local-6989586621679237817"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679237817"><span class="hs-identifier hs-var">_notObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map OperationKey OperationExtensions
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="annot"><span class="hs-comment">-- | HTTP methods to look for in path items</span></span><span>
</span><span id="line-416"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#httpMethods"><span class="hs-identifier hs-type">httpMethods</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span id="httpMethods"><span class="annot"><span class="annottext">httpMethods :: [Text]
</span><a href="Haskemathesis.OpenApi.Loader.html#httpMethods"><span class="hs-identifier hs-var hs-var">httpMethods</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;GET&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;PUT&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;POST&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;DELETE&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;OPTIONS&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;HEAD&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;PATCH&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;TRACE&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="annot"><span class="hs-comment">-- | Extract extensions from a single operation object</span></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#extractExtensionsFromOperation"><span class="hs-identifier hs-type">extractExtensionsFromOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationExtensions"><span class="hs-identifier hs-type">OperationExtensions</span></a></span><span>
</span><span id="line-421"></span><span id="extractExtensionsFromOperation"><span class="annot"><span class="annottext">extractExtensionsFromOperation :: Object -&gt; OperationExtensions
</span><a href="Haskemathesis.OpenApi.Loader.html#extractExtensionsFromOperation"><span class="hs-identifier hs-var hs-var">extractExtensionsFromOperation</span></a></span></span><span> </span><span id="local-6989586621679237818"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237818"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#OperationExtensions"><span class="hs-identifier hs-type">OperationExtensions</span></a></span><span>
</span><span id="line-423"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">oeTimeout :: Maybe Int
</span><a href="Haskemathesis.OpenApi.Loader.html#oeTimeout"><span class="hs-identifier hs-var">oeTimeout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Maybe Int
</span><a href="Haskemathesis.OpenApi.Loader.html#extractTimeout"><span class="hs-identifier hs-var">extractTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237818"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-424"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="annot"><span class="hs-comment">-- | Extract x-timeout as milliseconds (Int)</span></span><span>
</span><span id="line-427"></span><span class="annot"><a href="Haskemathesis.OpenApi.Loader.html#extractTimeout"><span class="hs-identifier hs-type">extractTimeout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-428"></span><span id="extractTimeout"><span class="annot"><span class="annottext">extractTimeout :: Object -&gt; Maybe Int
</span><a href="Haskemathesis.OpenApi.Loader.html#extractTimeout"><span class="hs-identifier hs-var hs-var">extractTimeout</span></a></span></span><span> </span><span id="local-6989586621679237820"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237820"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Object -&gt; Maybe Value
forall v. Key -&gt; KeyMap v -&gt; Maybe v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#lookup"><span class="hs-identifier hs-var">KM.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;x-timeout&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679237820"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span id="local-6989586621679237821"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679237821"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Maybe Int
forall i. (Integral i, Bounded i) =&gt; Scientific -&gt; Maybe i
</span><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html#toBoundedInteger"><span class="hs-identifier hs-var">toBoundedInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679237821"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-431"></span><span>        </span><span id="local-6989586621679237822"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679237822"><span class="hs-identifier hs-var">_notNumber</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-432"></span></pre></body></html>