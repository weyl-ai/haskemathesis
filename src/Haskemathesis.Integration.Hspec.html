<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- |
Module      : Haskemathesis.Integration.Hspec
Description : Hspec test framework integration
Stability   : experimental

This module provides integration with the Hspec testing framework,
allowing you to run OpenAPI conformance tests as part of your Hspec
test suite. It supports both standard conformance testing and negative
testing modes.

==== Quick Start

@
import Test.Hspec
import Haskemathesis.Integration.Hspec
import Haskemathesis.Config

main :: IO ()
main = hspec $ specForAppWithConfig defaultConfig openApiSpec myApp
@

==== Streaming Endpoint Handling

WAI-based tests (in-memory, synchronous) cannot handle streaming endpoints
like Server-Sent Events (SSE) or NDJSON streams. These operations are
__automatically skipped__ when using 'specForApp' or 'specForAppWithConfig'.

To see which operations were skipped, use 'specForAppIO':

@
main :: IO ()
main = do
    (spec, skipped) &lt;- specForAppIO defaultConfig openApiSpec myApp
    unless (null skipped) $
        hPutStrLn stderr $ &quot;Skipped streaming operations: &quot; ++ show skipped
    hspec spec
@

For streaming endpoints, use 'specForUrl' with a running HTTP server
which properly handles timeouts.
-}</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html"><span class="hs-identifier">Haskemathesis.Integration.Hspec</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Standard testing (WAI Application)</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForApp"><span class="hs-identifier">specForApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForAppWithConfig"><span class="hs-identifier">specForAppWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Standard testing (custom executor)</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForExecutor"><span class="hs-identifier">specForExecutor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForExecutorWithConfig"><span class="hs-identifier">specForExecutorWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Standard testing (HTTP client)</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForUrl"><span class="hs-identifier">specForUrl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="hs-comment">-- * WAI with Streaming Info</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForAppIO"><span class="hs-identifier">specForAppIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForAppNegativeIO"><span class="hs-identifier">specForAppNegativeIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Negative testing</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForExecutorNegative"><span class="hs-identifier">specForExecutorNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForAppNegative"><span class="hs-identifier">specForAppNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForUrlNegative"><span class="hs-identifier">specForUrlNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.html"><span class="hs-identifier">Data.OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier">OpenApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html"><span class="hs-identifier">Haskemathesis.Check.Standard.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier">operationLabel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html"><span class="hs-identifier">Haskemathesis.Check.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier">Check</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html"><span class="hs-identifier">Haskemathesis.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier">TestConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Http.html"><span class="hs-identifier">Haskemathesis.Execute.Http</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Http.html#executeHttpWithTimeout"><span class="hs-identifier">executeHttpWithTimeout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html"><span class="hs-identifier">Haskemathesis.Execute.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier">BaseUrl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier">ExecutorWithTimeout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Wai.html"><span class="hs-identifier">Haskemathesis.Execute.Wai</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier">executeWaiWithTimeout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Resolve.html"><span class="hs-identifier">Haskemathesis.OpenApi.Resolve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier">resolveOperations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html"><span class="hs-identifier">Haskemathesis.OpenApi.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier">ResolvedOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html"><span class="hs-identifier">Haskemathesis.Property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier">propertyForOperation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier">propertyForOperationWithConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Runner.html#check"><span class="hs-identifier">check</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.html"><span class="hs-identifier">Network.HTTP.Client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier">Manager</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html"><span class="hs-identifier">Network.Wai</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier">Application</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hPutStrLn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stderr</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/5vhgdsj280ak61aqxp82icikr96pb068-hspec-2.11.16-doc/share/doc/hspec-2.11.16/html/src/Test.Hspec.html"><span class="hs-identifier">Test.Hspec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier">Spec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.html#describe"><span class="hs-identifier">describe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.html#it"><span class="hs-identifier">it</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/1nmdwaznq5zz7pf0m9bzlzalx84lw4b5-hspec-expectations-0.8.4-doc/share/doc/hspec-expectations-0.8.4/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-identifier">shouldBe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">{- | Create an Hspec 'Spec' from pre-resolved operations with a custom executor.

This is the most flexible form, allowing you to provide your own request
executor function and pre-resolved operations. Use this when you need
fine-grained control over request execution.

==== Parameters

* @mBase@ - Optional base URL for error reporting
* @checks@ - List of conformance checks to run
* @execute@ - Function to execute API requests
* @ops@ - List of resolved operations to test

==== Example

@
spec :: Spec
spec = specForExecutor (Just &quot;http://localhost:8080&quot;) checks myExecutor ops
@
-}</span></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForExecutor"><span class="hs-identifier hs-type">specForExecutor</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-112"></span><span id="specForExecutor"><span class="annot"><span class="annottext">specForExecutor :: Maybe BaseUrl
-&gt; [Check] -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutor"><span class="hs-identifier hs-var hs-var">specForExecutor</span></a></span></span><span> </span><span id="local-6989586621679244889"><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679244889"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679244890"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244890"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679244891"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244891"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244892"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244892"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; Spec -&gt; Spec
forall a. HasCallStack =&gt; [Char] -&gt; SpecWith a -&gt; SpecWith a
</span><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.html#describe"><span class="hs-identifier hs-var">describe</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;OpenAPI Conformance&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Spec) -&gt; Spec -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Spec) -&gt; [ResolvedOperation] -&gt; Spec
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe BaseUrl
-&gt; [Check] -&gt; ExecutorWithTimeout -&gt; ResolvedOperation -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForOperation"><span class="hs-identifier hs-var">specForOperation</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679244889"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244890"><span class="hs-identifier hs-var">checks</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244891"><span class="hs-identifier hs-var">execute</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244892"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><span class="hs-comment">{- | Create an Hspec 'Spec' for a WAI 'Application'.

This is the simplest way to test a WAI application against an OpenAPI
specification. Operations are automatically resolved from the spec.

__Note:__ Streaming operations (SSE, NDJSON) are automatically filtered
out because WAI testing is synchronous and cannot handle streaming
responses. Use 'specForAppIO' if you need to know which operations
were skipped.

==== Parameters

* @mBase@ - Optional base URL for error reporting
* @checks@ - List of conformance checks to run
* @openApi@ - The OpenAPI specification
* @app@ - The WAI application to test

==== Example

@
import Haskemathesis.Check.Standard (standardChecks)

spec :: Spec
spec = specForApp Nothing standardChecks openApiSpec myApp
@
-}</span></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForApp"><span class="hs-identifier hs-type">specForApp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-148"></span><span id="specForApp"><span class="annot"><span class="annottext">specForApp :: Maybe BaseUrl -&gt; [Check] -&gt; OpenApi -&gt; Application -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForApp"><span class="hs-identifier hs-var hs-var">specForApp</span></a></span></span><span> </span><span id="local-6989586621679244895"><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679244895"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679244896"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244896"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679244897"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244897"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244898"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244898"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244899"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679244899"><span class="hs-identifier hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244897"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679244900"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244900"><span class="hs-identifier hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244901"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244901"><span class="hs-identifier hs-var">_skipped</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Hspec.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244899"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-151"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Maybe BaseUrl
-&gt; [Check] -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutor"><span class="hs-identifier hs-var">specForExecutor</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679244895"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244896"><span class="hs-identifier hs-var">checks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244898"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244900"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><span class="hs-comment">{- | Create an Hspec 'Spec' with full configuration and custom executor.

This variant allows you to use a 'TestConfig' for fine-grained control
over test behavior including operation filtering, authentication, and
negative testing.

==== Parameters

* @openApi@ - The OpenAPI specification (used for request generation)
* @config@ - Test configuration
* @execute@ - Function to execute API requests
* @ops@ - List of resolved operations to test

==== Example

@
let config = defaultConfig { tcTestCount = 50 }
spec = specForExecutorWithConfig openApiSpec config myExecutor ops
@
-}</span></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForExecutorWithConfig"><span class="hs-identifier hs-type">specForExecutorWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-179"></span><span id="specForExecutorWithConfig"><span class="annot"><span class="annottext">specForExecutorWithConfig :: OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutorWithConfig"><span class="hs-identifier hs-var hs-var">specForExecutorWithConfig</span></a></span></span><span> </span><span id="local-6989586621679244904"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244904"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244905"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244905"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244906"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244906"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244907"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244907"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; Spec -&gt; Spec
forall a. HasCallStack =&gt; [Char] -&gt; SpecWith a -&gt; SpecWith a
</span><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.html#describe"><span class="hs-identifier hs-var">describe</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;OpenAPI Conformance&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Spec) -&gt; Spec -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Spec) -&gt; [ResolvedOperation] -&gt; Spec
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; ResolvedOperation -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForOperationWithConfig"><span class="hs-identifier hs-var">specForOperationWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244904"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244905"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244906"><span class="hs-identifier hs-var">execute</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244907"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">{- | Create an Hspec 'Spec' for a WAI 'Application' with full configuration.

Combines the convenience of WAI application testing with the flexibility
of 'TestConfig'. This is the recommended approach for most use cases.

__Note:__ Streaming operations (SSE, NDJSON) are automatically filtered
out because WAI testing is synchronous and cannot handle streaming
responses. Use 'specForAppIO' if you need to know which operations
were skipped.

==== Parameters

* @config@ - Test configuration
* @openApi@ - The OpenAPI specification
* @app@ - The WAI application to test

==== Example

@
import Haskemathesis.Config

spec :: Spec
spec = specForAppWithConfig defaultConfig openApiSpec myApp
@
-}</span></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForAppWithConfig"><span class="hs-identifier hs-type">specForAppWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-213"></span><span id="specForAppWithConfig"><span class="annot"><span class="annottext">specForAppWithConfig :: TestConfig -&gt; OpenApi -&gt; Application -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForAppWithConfig"><span class="hs-identifier hs-var hs-var">specForAppWithConfig</span></a></span></span><span> </span><span id="local-6989586621679244909"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244909"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244910"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244910"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244911"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244911"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244912"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679244912"><span class="hs-identifier hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244910"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679244913"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244913"><span class="hs-identifier hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244914"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244914"><span class="hs-identifier hs-var">_skipped</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Hspec.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244912"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-216"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutorWithConfig"><span class="hs-identifier hs-var">specForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244910"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244909"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244911"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244913"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><span class="hs-comment">{- | Create an Hspec 'Spec' for testing a remote HTTP server.

This variant uses an HTTP client manager to make real network requests
to a running server. Useful for integration testing against deployed
services or external APIs.

==== Parameters

* @config@ - Test configuration
* @openApi@ - The OpenAPI specification
* @manager@ - HTTP client manager for making requests
* @baseUrl@ - Base URL of the server to test

==== Example

@
import Network.HTTP.Client (newManager, defaultManagerSettings)

spec :: Spec
spec = do
   manager &lt;- runIO $ newManager defaultManagerSettings
   specForUrl defaultConfig openApiSpec manager &quot;http://localhost:8080&quot;
@
-}</span></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForUrl"><span class="hs-identifier hs-type">specForUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-248"></span><span id="specForUrl"><span class="annot"><span class="annottext">specForUrl :: TestConfig -&gt; OpenApi -&gt; Manager -&gt; BaseUrl -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForUrl"><span class="hs-identifier hs-var hs-var">specForUrl</span></a></span></span><span> </span><span id="local-6989586621679244915"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244915"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244916"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244916"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244917"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679244917"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679244918"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679244918"><span class="hs-identifier hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244919"><span class="annot"><span class="annottext">config' :: TestConfig
</span><a href="#local-6989586621679244919"><span class="hs-identifier hs-var hs-var">config'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244915"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679244918"><span class="hs-identifier hs-type">baseUrl</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-250"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutorWithConfig"><span class="hs-identifier hs-var">specForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244916"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244919"><span class="hs-identifier hs-var">config'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; BaseUrl -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Http.html#executeHttpWithTimeout"><span class="hs-identifier hs-var">executeHttpWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679244917"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679244918"><span class="hs-identifier hs-var">baseUrl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244916"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><span class="hs-comment">{- | Create an Hspec 'Spec' for negative testing with a custom executor.

Negative testing sends intentionally malformed requests to verify that
the API correctly rejects invalid input. This helps ensure proper input
validation and error handling.

==== Parameters

* @openApi@ - The OpenAPI specification
* @config@ - Test configuration (negative testing is enabled automatically)
* @execute@ - Function to execute API requests
* @ops@ - List of resolved operations to test

==== What is tested

* Missing required parameters (path, query, header)
* Invalid parameter values (wrong types)
* Invalid request bodies
* Wrong content types
-}</span></span><span>
</span><span id="line-272"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForExecutorNegative"><span class="hs-identifier hs-type">specForExecutorNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-278"></span><span id="specForExecutorNegative"><span class="annot"><span class="annottext">specForExecutorNegative :: OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutorNegative"><span class="hs-identifier hs-var hs-var">specForExecutorNegative</span></a></span></span><span> </span><span id="local-6989586621679244921"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244921"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244922"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244922"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244923"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244923"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244924"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244924"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244925"><span class="annot"><span class="annottext">config' :: TestConfig
</span><a href="#local-6989586621679244925"><span class="hs-identifier hs-var hs-var">config'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244922"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcNegativeTesting"><span class="hs-identifier hs-var">tcNegativeTesting</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">}</span><span>
</span><span id="line-280"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutorWithConfig"><span class="hs-identifier hs-var">specForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244921"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244925"><span class="hs-identifier hs-var">config'</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244923"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244924"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">{- | Create an Hspec 'Spec' for negative testing of a WAI 'Application'.

Convenience wrapper around 'specForExecutorNegative' for WAI applications.

__Note:__ Streaming operations (SSE, NDJSON) are automatically filtered
out because WAI testing is synchronous and cannot handle streaming
responses. Use 'specForAppNegativeIO' if you need to know which operations
were skipped.

==== Parameters

* @config@ - Test configuration
* @openApi@ - The OpenAPI specification
* @app@ - The WAI application to test

==== Example

@
-- Test that invalid requests are properly rejected
negativeSpec :: Spec
negativeSpec = specForAppNegative defaultConfig openApiSpec myApp
@
-}</span></span><span>
</span><span id="line-305"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForAppNegative"><span class="hs-identifier hs-type">specForAppNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-310"></span><span id="specForAppNegative"><span class="annot"><span class="annottext">specForAppNegative :: TestConfig -&gt; OpenApi -&gt; Application -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForAppNegative"><span class="hs-identifier hs-var hs-var">specForAppNegative</span></a></span></span><span> </span><span id="local-6989586621679244927"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244927"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244928"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244928"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244929"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244929"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244930"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679244930"><span class="hs-identifier hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244928"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679244931"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244931"><span class="hs-identifier hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244932"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244932"><span class="hs-identifier hs-var">_skipped</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Hspec.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244930"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-313"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutorNegative"><span class="hs-identifier hs-var">specForExecutorNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244928"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244927"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244929"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244931"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><span class="hs-comment">{- | Create an Hspec 'Spec' for negative testing of a remote HTTP server.

Convenience wrapper around 'specForExecutorNegative' for HTTP testing.

==== Parameters

* @config@ - Test configuration
* @openApi@ - The OpenAPI specification
* @manager@ - HTTP client manager for making requests
* @baseUrl@ - Base URL of the server to test

==== Example

@
-- Test that the remote server rejects invalid requests
negativeSpec :: Spec
negativeSpec = do
   manager &lt;- runIO $ newManager defaultManagerSettings
   specForUrlNegative defaultConfig openApiSpec manager &quot;http://localhost:8080&quot;
@
-}</span></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForUrlNegative"><span class="hs-identifier hs-type">specForUrlNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-342"></span><span id="specForUrlNegative"><span class="annot"><span class="annottext">specForUrlNegative :: TestConfig -&gt; OpenApi -&gt; Manager -&gt; BaseUrl -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForUrlNegative"><span class="hs-identifier hs-var hs-var">specForUrlNegative</span></a></span></span><span> </span><span id="local-6989586621679244933"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244933"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244934"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244934"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244935"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679244935"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679244936"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679244936"><span class="hs-identifier hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutorNegative"><span class="hs-identifier hs-var">specForExecutorNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244934"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244933"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679244936"><span class="hs-identifier hs-type">baseUrl</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; BaseUrl -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Http.html#executeHttpWithTimeout"><span class="hs-identifier hs-var">executeHttpWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679244935"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679244936"><span class="hs-identifier hs-var">baseUrl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244934"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForOperation"><span class="hs-identifier hs-type">specForOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-351"></span><span id="specForOperation"><span class="annot"><span class="annottext">specForOperation :: Maybe BaseUrl
-&gt; [Check] -&gt; ExecutorWithTimeout -&gt; ResolvedOperation -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForOperation"><span class="hs-identifier hs-var hs-var">specForOperation</span></a></span></span><span> </span><span id="local-6989586621679244937"><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679244937"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679244938"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244938"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679244939"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244939"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244940"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244940"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; IO () -&gt; SpecWith (Arg (IO ()))
forall a.
(HasCallStack, Example a) =&gt;
[Char] -&gt; a -&gt; SpecWith (Arg a)
</span><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.html#it"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseUrl -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; BaseUrl
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244940"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; SpecWith (Arg (IO ())))
-&gt; IO () -&gt; SpecWith (Arg (IO ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><span class="annottext">Property -&gt; IO Bool
forall (m :: * -&gt; *). MonadIO m =&gt; Property -&gt; m Bool
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Runner.html#check"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe BaseUrl
-&gt; [Check] -&gt; ExecutorWithTimeout -&gt; ResolvedOperation -&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier hs-var">propertyForOperation</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621679244937"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679244938"><span class="hs-identifier hs-var">checks</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244939"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244940"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; (Bool -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; IO ()
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/1nmdwaznq5zz7pf0m9bzlzalx84lw4b5-hspec-expectations-0.8.4-doc/share/doc/hspec-expectations-0.8.4/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForOperationWithConfig"><span class="hs-identifier hs-type">specForOperationWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ExecutorWithTimeout"><span class="hs-identifier hs-type">ExecutorWithTimeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-361"></span><span id="specForOperationWithConfig"><span class="annot"><span class="annottext">specForOperationWithConfig :: OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; ResolvedOperation -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForOperationWithConfig"><span class="hs-identifier hs-var hs-var">specForOperationWithConfig</span></a></span></span><span> </span><span id="local-6989586621679244942"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244942"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244943"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244943"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244944"><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244944"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679244945"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244945"><span class="hs-identifier hs-var">op</span></a></span></span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcOperationFilter"><span class="hs-identifier hs-var">tcOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244943"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244945"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Spec
forall a. a -&gt; SpecM () a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; IO () -&gt; SpecWith (Arg (IO ()))
forall a.
(HasCallStack, Example a) =&gt;
[Char] -&gt; a -&gt; SpecWith (Arg a)
</span><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.html#it"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseUrl -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; BaseUrl
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244945"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; SpecWith (Arg (IO ())))
-&gt; IO () -&gt; SpecWith (Arg (IO ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-365"></span><span>            </span><span class="annot"><span class="annottext">Property -&gt; IO Bool
forall (m :: * -&gt; *). MonadIO m =&gt; Property -&gt; m Bool
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Runner.html#check"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; ExecutorWithTimeout
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier hs-var">propertyForOperationWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244942"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244943"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorWithTimeout
</span><a href="#local-6989586621679244944"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679244945"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; (Bool -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; IO ()
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/1nmdwaznq5zz7pf0m9bzlzalx84lw4b5-hspec-expectations-0.8.4-doc/share/doc/hspec-expectations-0.8.4/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- WAI IO variants (with streaming operation info)</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><span class="hs-comment">{- | Create an Hspec 'Spec' from a WAI 'Application', returning skipped operations.

Like 'specForAppWithConfig', but returns the list of operations that were
skipped due to being streaming endpoints. Also prints a warning to stderr
if any operations are skipped.

Streaming operations (SSE, NDJSON) cannot be tested with WAI because WAI
testing is synchronous and in-memory. For streaming endpoints, use
'specForUrl' with a running HTTP server.

==== Parameters

* @config@ - Test configuration
* @openApi@ - The OpenAPI specification
* @app@ - The WAI application to test

==== Return Value

Returns a tuple of:

* The Hspec 'Spec' for non-streaming operations
* List of operation labels that were skipped (streaming operations)

==== Example

@
main :: IO ()
main = do
    (spec, skipped) &lt;- specForAppIO defaultConfig openApiSpec myApp
    unless (null skipped) $
        putStrLn $ &quot;Note: &quot; ++ show (length skipped) ++ &quot; streaming ops skipped&quot;
    hspec spec
@
-}</span></span><span>
</span><span id="line-405"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForAppIO"><span class="hs-identifier hs-type">specForAppIO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-409"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span id="specForAppIO"><span class="annot"><span class="annottext">specForAppIO :: TestConfig -&gt; OpenApi -&gt; Application -&gt; IO (Spec, [BaseUrl])
</span><a href="Haskemathesis.Integration.Hspec.html#specForAppIO"><span class="hs-identifier hs-var hs-var">specForAppIO</span></a></span></span><span> </span><span id="local-6989586621679244948"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244948"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244949"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244949"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244950"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244950"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244951"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679244951"><span class="hs-identifier hs-var hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244949"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-412"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679244952"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244952"><span class="hs-identifier hs-var hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244953"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244953"><span class="hs-identifier hs-var hs-var">streaming</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Hspec.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244951"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-413"></span><span>        </span><span id="local-6989586621679244954"><span class="annot"><span class="annottext">skippedLabels :: [BaseUrl]
</span><a href="#local-6989586621679244954"><span class="hs-identifier hs-var hs-var hs-var">skippedLabels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; BaseUrl) -&gt; [ResolvedOperation] -&gt; [BaseUrl]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; BaseUrl
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244953"><span class="hs-identifier hs-var">streaming</span></a></span><span>
</span><span id="line-414"></span><span>        </span><span id="local-6989586621679244955"><span class="annot"><span class="annottext">spec :: Spec
</span><a href="#local-6989586621679244955"><span class="hs-identifier hs-var hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutorWithConfig"><span class="hs-identifier hs-var">specForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244949"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244948"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244950"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244952"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><span class="annottext">[BaseUrl] -&gt; IO ()
</span><a href="Haskemathesis.Integration.Hspec.html#warnSkippedStreaming"><span class="hs-identifier hs-var">warnSkippedStreaming</span></a></span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679244954"><span class="hs-identifier hs-var">skippedLabels</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><span class="annottext">(Spec, [BaseUrl]) -&gt; IO (Spec, [BaseUrl])
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec
</span><a href="#local-6989586621679244955"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679244954"><span class="hs-identifier hs-var">skippedLabels</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="annot"><span class="hs-comment">{- | Create a negative testing 'Spec' from a WAI 'Application', returning skipped operations.

Like 'specForAppNegative', but returns the list of operations that were
skipped due to being streaming endpoints. Also prints a warning to stderr
if any operations are skipped.

==== Parameters

* @config@ - Test configuration
* @openApi@ - The OpenAPI specification
* @app@ - The WAI application to test

==== Return Value

Returns a tuple of:

* The Hspec 'Spec' for non-streaming operations (negative tests)
* List of operation labels that were skipped (streaming operations)
-}</span></span><span>
</span><span id="line-437"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#specForAppNegativeIO"><span class="hs-identifier hs-type">specForAppNegativeIO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-438"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-441"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/f98mchpydblqajbgb2szi2ff2a54j5f3-hspec-core-2.11.16-doc/share/doc/hspec-core-2.11.16/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span id="specForAppNegativeIO"><span class="annot"><span class="annottext">specForAppNegativeIO :: TestConfig -&gt; OpenApi -&gt; Application -&gt; IO (Spec, [BaseUrl])
</span><a href="Haskemathesis.Integration.Hspec.html#specForAppNegativeIO"><span class="hs-identifier hs-var hs-var">specForAppNegativeIO</span></a></span></span><span> </span><span id="local-6989586621679244957"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244957"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679244958"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244958"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679244959"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244959"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244960"><span class="annot"><span class="annottext">allOps :: [ResolvedOperation]
</span><a href="#local-6989586621679244960"><span class="hs-identifier hs-var hs-var hs-var">allOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244958"><span class="hs-identifier hs-var">openApi</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679244961"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244961"><span class="hs-identifier hs-var hs-var">nonStreaming</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244962"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244962"><span class="hs-identifier hs-var hs-var">streaming</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Hspec.html#partitionStreamingOps"><span class="hs-identifier hs-var">partitionStreamingOps</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244960"><span class="hs-identifier hs-var">allOps</span></a></span><span>
</span><span id="line-445"></span><span>        </span><span id="local-6989586621679244963"><span class="annot"><span class="annottext">skippedLabels :: [BaseUrl]
</span><a href="#local-6989586621679244963"><span class="hs-identifier hs-var hs-var hs-var">skippedLabels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; BaseUrl) -&gt; [ResolvedOperation] -&gt; [BaseUrl]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; BaseUrl
</span><a href="Haskemathesis.Check.Standard.Helpers.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244962"><span class="hs-identifier hs-var">streaming</span></a></span><span>
</span><span id="line-446"></span><span>        </span><span id="local-6989586621679244964"><span class="annot"><span class="annottext">spec :: Spec
</span><a href="#local-6989586621679244964"><span class="hs-identifier hs-var hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig -&gt; ExecutorWithTimeout -&gt; [ResolvedOperation] -&gt; Spec
</span><a href="Haskemathesis.Integration.Hspec.html#specForExecutorNegative"><span class="hs-identifier hs-var">specForExecutorNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679244958"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679244957"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ExecutorWithTimeout
</span><a href="Haskemathesis.Execute.Wai.html#executeWaiWithTimeout"><span class="hs-identifier hs-var">executeWaiWithTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679244959"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679244961"><span class="hs-identifier hs-var">nonStreaming</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><span class="annottext">[BaseUrl] -&gt; IO ()
</span><a href="Haskemathesis.Integration.Hspec.html#warnSkippedStreaming"><span class="hs-identifier hs-var">warnSkippedStreaming</span></a></span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679244963"><span class="hs-identifier hs-var">skippedLabels</span></a></span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><span class="annottext">(Spec, [BaseUrl]) -&gt; IO (Spec, [BaseUrl])
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec
</span><a href="#local-6989586621679244964"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679244963"><span class="hs-identifier hs-var">skippedLabels</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- Helpers</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><span class="hs-comment">-- | Partition operations into (non-streaming, streaming).</span></span><span>
</span><span id="line-455"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#partitionStreamingOps"><span class="hs-identifier hs-type">partitionStreamingOps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span id="partitionStreamingOps"><span class="annot"><span class="annottext">partitionStreamingOps :: [ResolvedOperation] -&gt; ([ResolvedOperation], [ResolvedOperation])
</span><a href="Haskemathesis.Integration.Hspec.html#partitionStreamingOps"><span class="hs-identifier hs-var hs-var">partitionStreamingOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResolvedOperation -&gt; Bool)
-&gt; [ResolvedOperation]
-&gt; ([ResolvedOperation], [ResolvedOperation])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (ResolvedOperation -&gt; Bool) -&gt; ResolvedOperation -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.OpenApi.Types.html#roIsStreaming"><span class="hs-identifier hs-var">roIsStreaming</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="annot"><span class="hs-comment">-- | Print a warning to stderr if any streaming operations were skipped.</span></span><span>
</span><span id="line-459"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#warnSkippedStreaming"><span class="hs-identifier hs-type">warnSkippedStreaming</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span id="warnSkippedStreaming"><span class="annot"><span class="annottext">warnSkippedStreaming :: [BaseUrl] -&gt; IO ()
</span><a href="Haskemathesis.Integration.Hspec.html#warnSkippedStreaming"><span class="hs-identifier hs-var hs-var">warnSkippedStreaming</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span class="annot"><a href="Haskemathesis.Integration.Hspec.html#warnSkippedStreaming"><span class="hs-identifier hs-var">warnSkippedStreaming</span></a></span><span> </span><span id="local-6989586621679244967"><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679244967"><span class="hs-identifier hs-var">skipped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679244972"><span class="annot"><span class="annottext">count :: Int
</span><a href="#local-6989586621679244972"><span class="hs-identifier hs-var hs-var hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; BaseUrl -&gt; Int) -&gt; Int -&gt; [BaseUrl] -&gt; Int
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679244974"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244974"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244974"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679244967"><span class="hs-identifier hs-var">skipped</span></a></span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; [Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-464"></span><span>        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;[haskemathesis] Skipping &quot;</span></span><span>
</span><span id="line-465"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679244972"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-466"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; streaming operation(s) (WAI executor cannot handle streaming):&quot;</span></span><span>
</span><span id="line-467"></span><span>    </span><span class="annot"><span class="annottext">(BaseUrl -&gt; IO ()) -&gt; [BaseUrl] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; [Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; (BaseUrl -&gt; [Char]) -&gt; BaseUrl -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  - &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (BaseUrl -&gt; [Char]) -&gt; BaseUrl -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BaseUrl -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BaseUrl]
</span><a href="#local-6989586621679244967"><span class="hs-identifier hs-var">skipped</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; [Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  Use specForUrl with a live HTTP server to test streaming endpoints.&quot;</span></span><span>
</span><span id="line-469"></span></pre></body></html>