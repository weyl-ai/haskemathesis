<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | Validation utilities for JSON values against schemas.

This module provides functions for validating JSON 'Value's against
'Schema' definitions. It's used internally by generators to ensure
generated values conform to schemas, and by checks to validate
API responses.

=== Basic Validation

Check if a value satisfies a schema:

@
import Haskemathesis.Validate (validateValue)
import Haskemathesis.Schema (emptySchema, schemaType, SString)
import Data.Aeson (String)

schema :: Schema
schema = emptySchema { schemaType = Just SString }

-- Returns True
isValid = validateValue schema (String &quot;hello&quot;)
@

=== Getting Detailed Errors

For debugging or reporting, get specific validation errors:

@
import Haskemathesis.Validate (validateErrors)

errors = validateErrors schema value
-- Returns a list of error messages like:
-- [&quot;string shorter than minLength&quot;, &quot;number below minimum&quot;]
@

=== Supported Validations

The validator supports all common JSON Schema constraints:

* Type validation ('SString', 'SInteger', 'SNumber', 'SBoolean', 'SArray', 'SObject', 'SNull')
* Enum and const constraints
* String: min/max length, pattern matching
* Numbers: minimum, maximum, exclusive bounds
* Arrays: min/max items, unique items, item schema validation
* Objects: required properties, property schemas, additional properties
* Combinators: allOf, anyOf, oneOf
* Nullable types
-}</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Validate.html"><span class="hs-identifier">Haskemathesis.Validate</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Validation Functions</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="Haskemathesis.Validate.html#validateValue"><span class="hs-identifier">validateValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier">validateErrors</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#Key"><span class="hs-identifier">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#fromText"><span class="hs-identifier">fromText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#toText"><span class="hs-identifier">toText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html"><span class="hs-identifier">Data.Aeson.KeyMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KeyMap</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html"><span class="hs-identifier">Data.Scientific</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html#isInteger"><span class="hs-identifier">isInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html#toRealFloat"><span class="hs-identifier">toRealFloat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeUtf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vector</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html"><span class="hs-identifier">Haskemathesis.Schema</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.html"><span class="hs-identifier">Text.Regex.TDFA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.html#%3D~"><span class="hs-operator">(=~)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">{- | Validate a JSON value against a schema.

Returns 'True' if the value conforms to the schema, 'False' otherwise.
This is a convenience function equivalent to checking if 'validateErrors'
returns an empty list.

=== Example

@
schema :: Schema
schema = emptySchema { schemaType = Just SString }

isValid = validateValue schema (String &quot;hello&quot;)  -- True
isInvalid = validateValue schema (Number 42)     -- False
@
-}</span></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateValue"><span class="hs-identifier hs-type">validateValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-90"></span><span id="validateValue"><span class="annot"><span class="annottext">validateValue :: Schema -&gt; Value -&gt; Bool
</span><a href="Haskemathesis.Validate.html#validateValue"><span class="hs-identifier hs-var hs-var">validateValue</span></a></span></span><span> </span><span id="local-6989586621679201653"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201653"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201654"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201654"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier hs-var">validateErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201653"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201654"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><span class="hs-comment">{- | Validate a JSON value and return detailed error messages.

Returns a list of error messages describing why the value does not
conform to the schema. If the list is empty, the value is valid.

=== Example

@
schema :: Schema
schema = emptySchema
    { schemaType = Just SString
    , schemaMinLength = Just 5
    }

errors = validateErrors schema (String &quot;hi&quot;)
-- Returns: [&quot;string shorter than minLength&quot;]
@
-}</span></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier hs-type">validateErrors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span id="validateErrors"><span class="annot"><span class="annottext">validateErrors :: Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier hs-var hs-var">validateErrors</span></a></span></span><span> </span><span id="local-6989586621679201656"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201656"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201657"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201657"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-113"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateType"><span class="hs-identifier hs-var">validateType</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201656"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201657"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateEnum"><span class="hs-identifier hs-var">validateEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201656"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201657"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateConst"><span class="hs-identifier hs-var">validateConst</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201656"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201657"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateString"><span class="hs-identifier hs-var">validateString</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201656"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201657"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateNumber"><span class="hs-identifier hs-var">validateNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201656"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201657"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateArray"><span class="hs-identifier hs-var">validateArray</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201656"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201657"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateObject"><span class="hs-identifier hs-var">validateObject</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201656"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201657"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateCombinators"><span class="hs-identifier hs-var">validateCombinators</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201656"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201657"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><span class="hs-comment">-- | Validate the type of a value.</span></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateType"><span class="hs-identifier hs-type">validateType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span id="validateType"><span class="annot"><span class="annottext">validateType :: Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateType"><span class="hs-identifier hs-var hs-var">validateType</span></a></span></span><span> </span><span id="local-6989586621679201667"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201667"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201668"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201668"><span class="hs-identifier hs-var">value</span></a></span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201668"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">Null</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Bool
</span><a href="Haskemathesis.Schema.html#schemaNullable"><span class="hs-identifier hs-var">schemaNullable</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201667"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe SchemaType
</span><a href="Haskemathesis.Schema.html#schemaType"><span class="hs-identifier hs-var">schemaType</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201667"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>            </span><span class="annot"><span class="annottext">Maybe SchemaType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SString"><span class="hs-identifier hs-var">SString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201668"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-132"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>                    </span><span id="local-6989586621679201674"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201674"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;expected string&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SInteger"><span class="hs-identifier hs-var">SInteger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201668"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-136"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span id="local-6989586621679201676"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679201676"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Bool
</span><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html#isInteger"><span class="hs-identifier hs-var">isInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679201676"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-137"></span><span>                    </span><span id="local-6989586621679201677"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201677"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;expected integer&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SNumber"><span class="hs-identifier hs-var">SNumber</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201668"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-140"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span>                    </span><span id="local-6989586621679201678"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201678"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;expected number&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SBoolean"><span class="hs-identifier hs-var">SBoolean</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201668"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>                    </span><span id="local-6989586621679201680"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201680"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;expected boolean&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SArray"><span class="hs-identifier hs-var">SArray</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201668"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-148"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><span class="annottext">Array
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>                    </span><span id="local-6989586621679201682"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201682"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;expected array&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SObject"><span class="hs-identifier hs-var">SObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201668"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>                    </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>                    </span><span id="local-6989586621679201684"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201684"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;expected object&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SchemaType
</span><a href="Haskemathesis.Schema.html#SNull"><span class="hs-identifier hs-var">SNull</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201668"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-156"></span><span>                    </span><span class="annot"><span class="annottext">Value
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">Null</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span>                    </span><span id="local-6989586621679201685"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201685"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;expected null&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><span class="hs-comment">-- | Validate enum constraints.</span></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateEnum"><span class="hs-identifier hs-type">validateEnum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span id="validateEnum"><span class="annot"><span class="annottext">validateEnum :: Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateEnum"><span class="hs-identifier hs-var hs-var">validateEnum</span></a></span></span><span> </span><span id="local-6989586621679201686"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201686"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201687"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201687"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe [Value]
</span><a href="Haskemathesis.Schema.html#schemaEnum"><span class="hs-identifier hs-var">schemaEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201686"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">Maybe [Value]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201689"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679201689"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;value not in enum&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201687"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; [Value] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679201689"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><span class="hs-comment">-- | Validate const constraints.</span></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateConst"><span class="hs-identifier hs-type">validateConst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span id="validateConst"><span class="annot"><span class="annottext">validateConst :: Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateConst"><span class="hs-identifier hs-var hs-var">validateConst</span></a></span></span><span> </span><span id="local-6989586621679201691"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201691"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201692"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201692"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Value
</span><a href="Haskemathesis.Schema.html#schemaConst"><span class="hs-identifier hs-var">schemaConst</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201691"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">Maybe Value
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201694"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201694"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;value not equal to const&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201692"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201694"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><span class="hs-comment">-- | Validate string constraints (length, pattern).</span></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateString"><span class="hs-identifier hs-type">validateString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span id="validateString"><span class="annot"><span class="annottext">validateString :: Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateString"><span class="hs-identifier hs-var hs-var">validateString</span></a></span></span><span> </span><span id="local-6989586621679201696"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201696"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201697"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201697"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201697"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621679201698"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201698"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-180"></span><span>            </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-181"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Int
</span><a href="Haskemathesis.Schema.html#schemaMinLength"><span class="hs-identifier hs-var">schemaMinLength</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201696"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-182"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201700"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201700"><span class="hs-identifier hs-var">minL</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>                        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;string shorter than minLength&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><a href="Haskemathesis.Validate.html#textLength"><span class="hs-identifier hs-var">textLength</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201698"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201700"><span class="hs-identifier hs-var">minL</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Int
</span><a href="Haskemathesis.Schema.html#schemaMaxLength"><span class="hs-identifier hs-var">schemaMaxLength</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201696"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201704"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201704"><span class="hs-identifier hs-var">maxL</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>                        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;string longer than maxLength&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><a href="Haskemathesis.Validate.html#textLength"><span class="hs-identifier hs-var">textLength</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201698"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201704"><span class="hs-identifier hs-var">maxL</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Text
</span><a href="Haskemathesis.Schema.html#schemaPattern"><span class="hs-identifier hs-var">schemaPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201696"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201707"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201707"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>                        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;string does not match pattern&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201698"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall source source1 target.
(RegexMaker Regex CompOption ExecOption source,
 RegexContext Regex source1 target) =&gt;
source1 -&gt; source -&gt; target
</span><a href="file:///nix/store/v07gkhnhzrn709r6wcybz5khw75mz421-regex-tdfa-1.3.2.5-doc/share/doc/regex-tdfa-1.3.2.5/html/src/Text.Regex.TDFA.html#%3D~"><span class="hs-operator hs-var">=~</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201707"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-194"></span><span>        </span><span id="local-6989586621679201710"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201710"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><span class="hs-comment">-- | Validate number constraints (range, bounds).</span></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateNumber"><span class="hs-identifier hs-type">validateNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-198"></span><span id="validateNumber"><span class="annot"><span class="annottext">validateNumber :: Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateNumber"><span class="hs-identifier hs-var hs-var">validateNumber</span></a></span></span><span> </span><span id="local-6989586621679201711"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201711"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201712"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201712"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201712"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span id="local-6989586621679201713"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679201713"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679201716"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679201716"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Double
forall a. RealFloat a =&gt; Scientific -&gt; a
</span><a href="file:///nix/store/hwr0895a4mk8gp1c52mqxqwygppa2imi-scientific-0.3.8.0-doc/share/doc/scientific-0.3.8.0/html/src/Data.Scientific.html#toRealFloat"><span class="hs-identifier hs-var">toRealFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679201713"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-202"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-203"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Double
</span><a href="Haskemathesis.Schema.html#schemaMinimum"><span class="hs-identifier hs-var">schemaMinimum</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201711"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-204"></span><span>                        </span><span class="annot"><span class="annottext">Maybe Double
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201718"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201718"><span class="hs-identifier hs-var">minV</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>                            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;number below minimum&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201716"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201718"><span class="hs-identifier hs-var">minV</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Double
</span><a href="Haskemathesis.Schema.html#schemaMaximum"><span class="hs-identifier hs-var">schemaMaximum</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201711"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-208"></span><span>                        </span><span class="annot"><span class="annottext">Maybe Double
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201720"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201720"><span class="hs-identifier hs-var">maxV</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>                            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;number above maximum&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201716"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201720"><span class="hs-identifier hs-var">maxV</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Double
</span><a href="Haskemathesis.Schema.html#schemaExclusiveMinimum"><span class="hs-identifier hs-var">schemaExclusiveMinimum</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201711"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-212"></span><span>                        </span><span class="annot"><span class="annottext">Maybe Double
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201722"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201722"><span class="hs-identifier hs-var">minV</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>                            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;number below or equal exclusiveMinimum&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201716"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201722"><span class="hs-identifier hs-var">minV</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Double
</span><a href="Haskemathesis.Schema.html#schemaExclusiveMaximum"><span class="hs-identifier hs-var">schemaExclusiveMaximum</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201711"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-216"></span><span>                        </span><span class="annot"><span class="annottext">Maybe Double
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201725"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201725"><span class="hs-identifier hs-var">maxV</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>                            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;number above or equal exclusiveMaximum&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201716"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679201725"><span class="hs-identifier hs-var">maxV</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-219"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>        </span><span id="local-6989586621679201726"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201726"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><span class="hs-comment">-- | Validate array constraints (length, uniqueness, item schema).</span></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateArray"><span class="hs-identifier hs-type">validateArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-224"></span><span id="validateArray"><span class="annot"><span class="annottext">validateArray :: Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateArray"><span class="hs-identifier hs-var hs-var">validateArray</span></a></span></span><span> </span><span id="local-6989586621679201727"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201727"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201728"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201728"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201728"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span id="local-6989586621679201729"><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679201729"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679201730"><span class="annot"><span class="annottext">items :: [Value]
</span><a href="#local-6989586621679201730"><span class="hs-identifier hs-var hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array -&gt; [Value]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">Vector.toList</span></span><span> </span><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679201729"><span class="hs-identifier hs-var">vec</span></a></span><span>
</span><span id="line-228"></span><span>                </span><span id="local-6989586621679201732"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679201732"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">Vector.length</span></span><span> </span><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679201729"><span class="hs-identifier hs-var">vec</span></a></span><span>
</span><span id="line-229"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-230"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Int
</span><a href="Haskemathesis.Schema.html#schemaMinItems"><span class="hs-identifier hs-var">schemaMinItems</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201727"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-231"></span><span>                        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201735"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201735"><span class="hs-identifier hs-var">minI</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>                            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;array shorter than minItems&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201732"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201735"><span class="hs-identifier hs-var">minI</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Int
</span><a href="Haskemathesis.Schema.html#schemaMaxItems"><span class="hs-identifier hs-var">schemaMaxItems</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201727"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-235"></span><span>                        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201737"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201737"><span class="hs-identifier hs-var">maxI</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>                            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;array longer than maxItems&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201732"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201737"><span class="hs-identifier hs-var">maxI</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-238"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;array has duplicate items&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Bool
</span><a href="Haskemathesis.Schema.html#schemaUniqueItems"><span class="hs-identifier hs-var">schemaUniqueItems</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201727"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Array -&gt; Bool
</span><a href="Haskemathesis.Validate.html#hasDuplicateValues"><span class="hs-identifier hs-var">hasDuplicateValues</span></a></span><span> </span><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679201729"><span class="hs-identifier hs-var">vec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe Schema
</span><a href="Haskemathesis.Schema.html#schemaItems"><span class="hs-identifier hs-var">schemaItems</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201727"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-240"></span><span>                        </span><span class="annot"><span class="annottext">Maybe Schema
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-241"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201741"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201741"><span class="hs-identifier hs-var">itemSchema</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>                            </span><span class="annot"><span class="annottext">(Value -&gt; [Text]) -&gt; [Value] -&gt; [Text]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier hs-var">validateErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201741"><span class="hs-identifier hs-var">itemSchema</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679201730"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-243"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-244"></span><span>        </span><span id="local-6989586621679201743"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201743"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><span class="hs-comment">-- | Validate object constraints (required properties, property schemas, additional properties).</span></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateObject"><span class="hs-identifier hs-type">validateObject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span id="validateObject"><span class="annot"><span class="annottext">validateObject :: Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateObject"><span class="hs-identifier hs-var hs-var">validateObject</span></a></span></span><span> </span><span id="local-6989586621679201744"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201744"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201745"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201745"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201745"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679201746"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679201746"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-251"></span><span>            </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-252"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Text]
forall {a}. KeyMap a -&gt; [Text]
</span><a href="#local-6989586621679201747"><span class="hs-identifier hs-var">validateRequired</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679201746"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-253"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Text]
</span><a href="#local-6989586621679201748"><span class="hs-identifier hs-var">validateProperties</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679201746"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-254"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Text]
</span><a href="#local-6989586621679201749"><span class="hs-identifier hs-var">validateAdditional</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679201746"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-255"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-256"></span><span>        </span><span id="local-6989586621679201750"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201750"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679201747"><span class="annot"><span class="annottext">validateRequired :: KeyMap a -&gt; [Text]
</span><a href="#local-6989586621679201747"><span class="hs-identifier hs-var hs-var">validateRequired</span></a></span></span><span> </span><span id="local-6989586621679201754"><span class="annot"><span class="annottext">KeyMap a
</span><a href="#local-6989586621679201754"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;missing required property: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201755"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679201755"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201755"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Text]
</span><a href="Haskemathesis.Schema.html#schemaRequired"><span class="hs-identifier hs-var">schemaRequired</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201744"><span class="hs-identifier hs-var">schema</span></a></span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; KeyMap a -&gt; Maybe a
forall v. Key -&gt; KeyMap v -&gt; Maybe v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#lookup"><span class="hs-identifier hs-var">KeyMap.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Key
</span><a href="Haskemathesis.Validate.html#toKey"><span class="hs-identifier hs-var">toKey</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201755"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMap a
</span><a href="#local-6989586621679201754"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679201748"><span class="annot"><span class="annottext">validateProperties :: Object -&gt; [Text]
</span><a href="#local-6989586621679201748"><span class="hs-identifier hs-var hs-var">validateProperties</span></a></span></span><span> </span><span id="local-6989586621679201760"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679201760"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Object -&gt; Maybe Value
forall v. Key -&gt; KeyMap v -&gt; Maybe v
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#lookup"><span class="hs-identifier hs-var">KeyMap.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Key
</span><a href="Haskemathesis.Validate.html#toKey"><span class="hs-identifier hs-var">toKey</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201761"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679201760"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-267"></span><span>                </span><span class="annot"><span class="annottext">Maybe Value
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679201762"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201762"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier hs-var">validateErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201763"><span class="hs-identifier hs-var">propSchema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201762"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-269"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679201761"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679201761"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679201763"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201763"><span class="hs-identifier hs-var">propSchema</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Text Schema -&gt; [(Text, Schema)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Map Text Schema
</span><a href="Haskemathesis.Schema.html#schemaProperties"><span class="hs-identifier hs-var">schemaProperties</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201744"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679201749"><span class="annot"><span class="annottext">validateAdditional :: Object -&gt; [Text]
</span><a href="#local-6989586621679201749"><span class="hs-identifier hs-var hs-var">validateAdditional</span></a></span></span><span> </span><span id="local-6989586621679201769"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679201769"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe AdditionalProperties
</span><a href="Haskemathesis.Schema.html#schemaAdditionalProperties"><span class="hs-identifier hs-var">schemaAdditionalProperties</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201744"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-274"></span><span>            </span><span class="annot"><span class="annottext">Maybe AdditionalProperties
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">AdditionalProperties
</span><a href="Haskemathesis.Schema.html#AdditionalPropertiesAny"><span class="hs-identifier hs-var">AdditionalPropertiesAny</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-276"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">AdditionalProperties
</span><a href="Haskemathesis.Schema.html#AdditionalPropertiesNone"><span class="hs-identifier hs-var">AdditionalPropertiesNone</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679201773"><span class="annot"><span class="annottext">allowed :: Set Text
</span><a href="#local-6989586621679201773"><span class="hs-identifier hs-var hs-var">allowed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Text Schema -&gt; Set Text
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Map Text Schema
</span><a href="Haskemathesis.Schema.html#schemaProperties"><span class="hs-identifier hs-var">schemaProperties</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201744"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>                    </span><span id="local-6989586621679201777"><span class="annot"><span class="annottext">extras :: [Text]
</span><a href="#local-6989586621679201777"><span class="hs-identifier hs-var hs-var">extras</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#toText"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679201778"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-280"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679201778"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679201778"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Key]
forall v. KeyMap v -&gt; [Key]
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#keys"><span class="hs-identifier hs-var">KeyMap.keys</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679201769"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-281"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; Text
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#toText"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679201778"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Set Text -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set Text
</span><a href="#local-6989586621679201773"><span class="hs-identifier hs-var">allowed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>                        </span><span class="hs-special">]</span><span>
</span><span id="line-283"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;additional properties not allowed&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679201777"><span class="hs-identifier hs-var">extras</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-284"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Schema.html#AdditionalPropertiesSchema"><span class="hs-identifier hs-type">AdditionalPropertiesSchema</span></a></span><span> </span><span id="local-6989586621679201782"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201782"><span class="hs-identifier hs-var">extraSchema</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679201783"><span class="annot"><span class="annottext">allowed :: Set Text
</span><a href="#local-6989586621679201783"><span class="hs-identifier hs-var hs-var">allowed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Text Schema -&gt; Set Text
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Map Text Schema
</span><a href="Haskemathesis.Schema.html#schemaProperties"><span class="hs-identifier hs-var">schemaProperties</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201744"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>                    </span><span id="local-6989586621679201785"><span class="annot"><span class="annottext">extras :: [Value]
</span><a href="#local-6989586621679201785"><span class="hs-identifier hs-var hs-var">extras</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-287"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201786"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-288"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679201787"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679201787"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679201786"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201786"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [(Key, Value)]
forall v. KeyMap v -&gt; [(Key, v)]
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html#toList"><span class="hs-identifier hs-var">KeyMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679201769"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-289"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; Text
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#toText"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679201787"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Set Text -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set Text
</span><a href="#local-6989586621679201783"><span class="hs-identifier hs-var">allowed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>                        </span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; [Text]) -&gt; [Value] -&gt; [Text]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier hs-var">validateErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201782"><span class="hs-identifier hs-var">extraSchema</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679201785"><span class="hs-identifier hs-var">extras</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><span class="hs-comment">-- | Validate schema combinators (allOf, anyOf, oneOf).</span></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Haskemathesis.Validate.html#validateCombinators"><span class="hs-identifier hs-type">validateCombinators</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span id="validateCombinators"><span class="annot"><span class="annottext">validateCombinators :: Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateCombinators"><span class="hs-identifier hs-var hs-var">validateCombinators</span></a></span></span><span> </span><span id="local-6989586621679201789"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201789"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span id="local-6989586621679201790"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201790"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-297"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Schema] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; [Schema]
</span><a href="Haskemathesis.Schema.html#schemaAllOf"><span class="hs-identifier hs-var">schemaAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201789"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; [Text]) -&gt; [Schema] -&gt; [Text]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-operator hs-var">`validateErrors`</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201790"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; [Schema]
</span><a href="Haskemathesis.Schema.html#schemaAllOf"><span class="hs-identifier hs-var">schemaAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201789"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;value does not satisfy anyOf&quot;</span></span><span>
</span><span id="line-301"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span>
</span><span id="line-302"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Schema] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; [Schema]
</span><a href="Haskemathesis.Schema.html#schemaAnyOf"><span class="hs-identifier hs-var">schemaAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201789"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Bool) -&gt; [Schema] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Bool) -&gt; (Schema -&gt; [Text]) -&gt; Schema -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-operator hs-var">`validateErrors`</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201790"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; [Schema]
</span><a href="Haskemathesis.Schema.html#schemaAnyOf"><span class="hs-identifier hs-var">schemaAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201789"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Schema] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; [Schema]
</span><a href="Haskemathesis.Schema.html#schemaOneOf"><span class="hs-identifier hs-var">schemaOneOf</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201789"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-308"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-309"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679201797"><span class="annot"><span class="annottext">matches :: Int
</span><a href="#local-6989586621679201797"><span class="hs-identifier hs-var hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; [Schema] -&gt; Int
</span><a href="Haskemathesis.Validate.html#countMatches"><span class="hs-identifier hs-var">countMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201790"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; [Schema]
</span><a href="Haskemathesis.Schema.html#schemaOneOf"><span class="hs-identifier hs-var">schemaOneOf</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201789"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;value does not satisfy oneOf&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679201797"><span class="hs-identifier hs-var">matches</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><span class="hs-comment">-- | Convert Text to a Key for object property lookup.</span></span><span>
</span><span id="line-314"></span><span class="annot"><a href="Haskemathesis.Validate.html#toKey"><span class="hs-identifier hs-type">toKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-315"></span><span id="toKey"><span class="annot"><span class="annottext">toKey :: Text -&gt; Key
</span><a href="Haskemathesis.Validate.html#toKey"><span class="hs-identifier hs-var hs-var">toKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Key
</span><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html#fromText"><span class="hs-identifier hs-var">fromText</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><span class="hs-comment">-- | Calculate the byte length of a Text value.</span></span><span>
</span><span id="line-318"></span><span class="annot"><a href="Haskemathesis.Validate.html#textLength"><span class="hs-identifier hs-type">textLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-319"></span><span id="textLength"><span class="annot"><span class="annottext">textLength :: Text -&gt; Int
</span><a href="Haskemathesis.Validate.html#textLength"><span class="hs-identifier hs-var hs-var">textLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Int) -&gt; (Text -&gt; ByteString) -&gt; Text -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><span class="hs-comment">-- | Check if a vector contains duplicate values.</span></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Haskemathesis.Validate.html#hasDuplicateValues"><span class="hs-identifier hs-type">hasDuplicateValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector.Vector</span></span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-323"></span><span id="hasDuplicateValues"><span class="annot"><span class="annottext">hasDuplicateValues :: Array -&gt; Bool
</span><a href="Haskemathesis.Validate.html#hasDuplicateValues"><span class="hs-identifier hs-var hs-var">hasDuplicateValues</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Value, Bool) -&gt; Bool
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Set Value, Bool) -&gt; Bool)
-&gt; (Array -&gt; (Set Value, Bool)) -&gt; Array -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Set Value, Bool) -&gt; Value -&gt; (Set Value, Bool))
-&gt; (Set Value, Bool) -&gt; Array -&gt; (Set Value, Bool)
forall a b. (a -&gt; b -&gt; a) -&gt; a -&gt; Vector b -&gt; a
</span><span class="hs-identifier hs-var">Vector.foldl'</span></span><span> </span><span class="annot"><span class="annottext">(Set Value, Bool) -&gt; Value -&gt; (Set Value, Bool)
forall {a}. Ord a =&gt; (Set a, Bool) -&gt; a -&gt; (Set a, Bool)
</span><a href="#local-6989586621679201802"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Value
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679201802"><span class="annot"><span class="annottext">step :: (Set a, Bool) -&gt; a -&gt; (Set a, Bool)
</span><a href="#local-6989586621679201802"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679201810"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679201810"><span class="hs-identifier hs-var">seen</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679201811"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679201811"><span class="hs-identifier hs-var">_item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679201810"><span class="hs-identifier hs-var">seen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="#local-6989586621679201802"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679201812"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679201812"><span class="hs-identifier hs-var">seen</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679201813"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679201813"><span class="hs-identifier hs-var">item</span></a></span></span><span>
</span><span id="line-327"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679201813"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679201812"><span class="hs-identifier hs-var">seen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679201812"><span class="hs-identifier hs-var">seen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679201813"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679201812"><span class="hs-identifier hs-var">seen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><span class="hs-comment">-- | Count how many schemas in a list validate successfully against a value.</span></span><span>
</span><span id="line-331"></span><span class="annot"><a href="Haskemathesis.Validate.html#countMatches"><span class="hs-identifier hs-type">countMatches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/bjx03k98335ijsml9dq303bj5ddk8a5f-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Schema.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-332"></span><span id="countMatches"><span class="annot"><span class="annottext">countMatches :: Value -&gt; [Schema] -&gt; Int
</span><a href="Haskemathesis.Validate.html#countMatches"><span class="hs-identifier hs-var hs-var">countMatches</span></a></span></span><span> </span><span id="local-6989586621679201815"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201815"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Schema -&gt; Int) -&gt; Int -&gt; [Schema] -&gt; Int
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Schema -&gt; Int
forall {a}. Num a =&gt; a -&gt; Schema -&gt; a
</span><a href="#local-6989586621679201817"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621679201817"><span class="annot"><span class="annottext">step :: a -&gt; Schema -&gt; a
</span><a href="#local-6989586621679201817"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679201822"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679201822"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679201823"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201823"><span class="hs-identifier hs-var">schema</span></a></span></span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Value -&gt; [Text]
</span><a href="Haskemathesis.Validate.html#validateErrors"><span class="hs-identifier hs-var">validateErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679201823"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679201815"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679201822"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679201822"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-337"></span></pre></body></html>