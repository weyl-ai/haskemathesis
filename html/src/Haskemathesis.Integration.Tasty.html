<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | Tasty integration helpers for generated properties.

This module provides convenient functions for integrating Haskemathesis
properties with the Tasty test framework. It handles the conversion
of generated properties into Tasty 'TestTree' values.

=== Basic Usage

Create a Tasty test suite from an OpenAPI spec:

@
import Test.Tasty (defaultMain)
import Haskemathesis.Integration.Tasty (testTreeForApp)
import Haskemathesis.Check.Standard (defaultChecks)
import Data.OpenApi (OpenApi)

main :: IO ()
main = do
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let app = myWaiApplication
        tests = testTreeForApp Nothing defaultChecks spec app
    defaultMain tests
@

=== With Custom Configuration

For more control, use the configuration-based functions:

@
import Haskemathesis.Config

myConfig :: TestConfig
myConfig = defaultTestConfig
    { tcPropertyCount = 200
    , tcNegativeTesting = True
    }

tests = testTreeForAppWithConfig myConfig spec app
@

=== Testing Remote APIs

Test a running HTTP server:

@
import Network.HTTP.Client (newManager, defaultManagerSettings)

main :: IO ()
main = do
    manager &lt;- newManager defaultManagerSettings
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let tests = testTreeForUrl defaultTestConfig spec manager &quot;http://localhost:8080&quot;
    defaultMain tests
@
-}</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html"><span class="hs-identifier">Haskemathesis.Integration.Tasty</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Basic Test Trees</span></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutor"><span class="hs-identifier">testTreeForExecutor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForApp"><span class="hs-identifier">testTreeForApp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Configuration-Based Test Trees</span></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier">testTreeForExecutorWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppWithConfig"><span class="hs-identifier">testTreeForAppWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrl"><span class="hs-identifier">testTreeForUrl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Negative Testing</span></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier">testTreeForExecutorNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppNegative"><span class="hs-identifier">testTreeForAppNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrlNegative"><span class="hs-identifier">testTreeForUrlNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.html"><span class="hs-identifier">Data.OpenApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier">OpenApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Check.Types.html"><span class="hs-identifier">Haskemathesis.Check.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier">Check</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Config.html"><span class="hs-identifier">Haskemathesis.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier">TestConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Http.html"><span class="hs-identifier">Haskemathesis.Execute.Http</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Http.html#executeHttp"><span class="hs-identifier">executeHttp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html"><span class="hs-identifier">Haskemathesis.Execute.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier">ApiRequest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier">ApiResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier">BaseUrl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Wai.html"><span class="hs-identifier">Haskemathesis.Execute.Wai</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Wai.html#executeWai"><span class="hs-identifier">executeWai</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Resolve.html"><span class="hs-identifier">Haskemathesis.OpenApi.Resolve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier">resolveOperations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html"><span class="hs-identifier">Haskemathesis.OpenApi.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier">ResolvedOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html"><span class="hs-identifier">Haskemathesis.Property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier">propertyForOperation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier">propertyForOperationWithConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html"><span class="hs-identifier">Hedgehog.Internal.Property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyName"><span class="hs-identifier">PropertyName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.html"><span class="hs-identifier">Network.HTTP.Client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier">Manager</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html"><span class="hs-identifier">Network.Wai</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier">Application</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.html"><span class="hs-identifier">Test.Tasty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier">TestTree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#testGroup"><span class="hs-identifier">testGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/lvny4gcc5n9wz81pxl3la2n2lhjd119x-tasty-hedgehog-1.4.0.2-doc/share/doc/tasty-hedgehog-1.4.0.2/html/src/Test.Tasty.Hedgehog.html"><span class="hs-identifier">Test.Tasty.Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/lvny4gcc5n9wz81pxl3la2n2lhjd119x-tasty-hedgehog-1.4.0.2-doc/share/doc/tasty-hedgehog-1.4.0.2/html/src/Test.Tasty.Hedgehog.html#testPropertyNamed"><span class="hs-identifier">testPropertyNamed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' from a custom executor.

This is the most flexible way to create tests, allowing you to
provide any function that can execute 'ApiRequest' values.

=== Parameters

* @mBase@ - Optional base URL for failure reports
* @checks@ - List of 'Check' functions to validate responses
* @execute@ - Your custom executor function
* @ops@ - List of operations to test (from 'resolveOperations')

=== Example

@
myExecutor :: ApiRequest -&gt; IO ApiResponse
myExecutor req = ... -- your custom logic

tests = testTreeForExecutor Nothing defaultChecks myExecutor ops
@
-}</span></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutor"><span class="hs-identifier hs-type">testTreeForExecutor</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-119"></span><span id="testTreeForExecutor"><span class="annot"><span class="annottext">testTreeForExecutor :: Maybe Text
-&gt; [Check]
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutor"><span class="hs-identifier hs-var hs-var">testTreeForExecutor</span></a></span></span><span> </span><span id="local-6989586621679203006"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679203006"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679203007"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679203007"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679203008"><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679203008"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679203009"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679203009"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">TestName -&gt; [TestTree] -&gt; TestTree
</span><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#testGroup"><span class="hs-identifier hs-var">testGroup</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;OpenAPI Conformance&quot;</span></span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; PropertyName -&gt; Property -&gt; TestTree
</span><a href="file:///nix/store/lvny4gcc5n9wz81pxl3la2n2lhjd119x-tasty-hedgehog-1.4.0.2-doc/share/doc/tasty-hedgehog-1.4.0.2/html/src/Test.Tasty.Hedgehog.html#testPropertyNamed"><span class="hs-identifier hs-var">testPropertyNamed</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679203010"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; PropertyName
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyName"><span class="hs-identifier hs-var">PropertyName</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679203010"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text
-&gt; [Check]
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperation"><span class="hs-identifier hs-var">propertyForOperation</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679203006"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679203007"><span class="hs-identifier hs-var">checks</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679203008"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203012"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679203012"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203012"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679203009"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679203010"><span class="annot"><span class="annottext">name :: TestName
</span><a href="#local-6989586621679203010"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TestName
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Integration.Tasty.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203012"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' from a WAI 'Application'.

This is a convenient way to test a WAI application (e.g., Servant,
Yesod, or any other WAI-based framework) without starting a
real HTTP server.

=== Parameters

* @mBase@ - Optional base URL for failure reports
* @checks@ - List of 'Check' functions to validate responses
* @openApi@ - The OpenAPI specification
* @app@ - Your WAI 'Application'

=== Example

@
import Network.Wai (Application)

myApp :: Application
myApp = ... -- your WAI application

main :: IO ()
main = do
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let tests = testTreeForApp Nothing defaultChecks spec myApp
    defaultMain tests
@
-}</span></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForApp"><span class="hs-identifier hs-type">testTreeForApp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-161"></span><span id="testTreeForApp"><span class="annot"><span class="annottext">testTreeForApp :: Maybe Text -&gt; [Check] -&gt; OpenApi -&gt; Application -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForApp"><span class="hs-identifier hs-var hs-var">testTreeForApp</span></a></span></span><span> </span><span id="local-6989586621679203015"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679203015"><span class="hs-identifier hs-var">mBase</span></a></span></span><span> </span><span id="local-6989586621679203016"><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679203016"><span class="hs-identifier hs-var">checks</span></a></span></span><span> </span><span id="local-6989586621679203017"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203017"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679203018"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679203018"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text
-&gt; [Check]
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutor"><span class="hs-identifier hs-var">testTreeForExecutor</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679203015"><span class="hs-identifier hs-var">mBase</span></a></span><span> </span><span class="annot"><span class="annottext">[Check]
</span><a href="#local-6989586621679203016"><span class="hs-identifier hs-var">checks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ApiRequest -&gt; IO ApiResponse
</span><a href="Haskemathesis.Execute.Wai.html#executeWai"><span class="hs-identifier hs-var">executeWai</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679203018"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203017"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' with full configuration support.

This function provides the most flexibility for creating test trees.
It accepts a 'TestConfig' for authentication, filtering, and
other advanced options.

=== Parameters

* @openApi@ - The OpenAPI specification
* @config@ - The 'TestConfig' controlling test generation
* @execute@ - Function to execute requests
* @ops@ - List of operations to test

=== Example

@
config = defaultTestConfig
    { tcPropertyCount = 200
    , tcAuthConfig = Just myAuthConfig
    }

tests = testTreeForExecutorWithConfig spec config executor ops
@
-}</span></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-type">testTreeForExecutorWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-194"></span><span id="testTreeForExecutorWithConfig"><span class="annot"><span class="annottext">testTreeForExecutorWithConfig :: OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-var hs-var">testTreeForExecutorWithConfig</span></a></span></span><span> </span><span id="local-6989586621679203020"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203020"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679203021"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203021"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679203022"><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679203022"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679203023"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679203023"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">TestName -&gt; [TestTree] -&gt; TestTree
</span><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#testGroup"><span class="hs-identifier hs-var">testGroup</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;OpenAPI Conformance&quot;</span></span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; PropertyName -&gt; Property -&gt; TestTree
</span><a href="file:///nix/store/lvny4gcc5n9wz81pxl3la2n2lhjd119x-tasty-hedgehog-1.4.0.2-doc/share/doc/tasty-hedgehog-1.4.0.2/html/src/Test.Tasty.Hedgehog.html#testPropertyNamed"><span class="hs-identifier hs-var">testPropertyNamed</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679203024"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; PropertyName
</span><a href="file:///nix/store/4n4z2liv1a3rcrl66a6rrlxnr1azv1dp-hedgehog-1.5-doc/share/doc/hedgehog-1.5/html/src/Hedgehog.Internal.Property.html#PropertyName"><span class="hs-identifier hs-var">PropertyName</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679203024"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; ResolvedOperation
-&gt; Property
</span><a href="Haskemathesis.Property.html#propertyForOperationWithConfig"><span class="hs-identifier hs-var">propertyForOperationWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203020"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203021"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679203022"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203025"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679203025"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203025"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679203023"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestConfig -&gt; ResolvedOperation -&gt; Bool
</span><a href="Haskemathesis.Config.html#tcOperationFilter"><span class="hs-identifier hs-var">tcOperationFilter</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203021"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203025"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679203024"><span class="annot"><span class="annottext">name :: TestName
</span><a href="#local-6989586621679203024"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TestName
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Integration.Tasty.html#operationLabel"><span class="hs-identifier hs-var">operationLabel</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203025"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' from a WAI 'Application' with configuration.

Combines 'testTreeForExecutorWithConfig' with 'executeWai' for
convenient testing of WAI applications.

=== Parameters

* @config@ - The 'TestConfig' controlling test generation
* @openApi@ - The OpenAPI specification
* @app@ - Your WAI 'Application'

=== Example

@
config = defaultTestConfig { tcPropertyCount = 200 }
tests = testTreeForAppWithConfig config spec myApp
@
-}</span></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppWithConfig"><span class="hs-identifier hs-type">testTreeForAppWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-226"></span><span id="testTreeForAppWithConfig"><span class="annot"><span class="annottext">testTreeForAppWithConfig :: TestConfig -&gt; OpenApi -&gt; Application -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppWithConfig"><span class="hs-identifier hs-var hs-var">testTreeForAppWithConfig</span></a></span></span><span> </span><span id="local-6989586621679203027"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203027"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679203028"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203028"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679203029"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679203029"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-var">testTreeForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203028"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203027"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ApiRequest -&gt; IO ApiResponse
</span><a href="Haskemathesis.Execute.Wai.html#executeWai"><span class="hs-identifier hs-var">executeWai</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679203029"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203028"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' for testing a running HTTP server.

This function creates tests that execute against a live HTTP server
at the specified base URL.

=== Parameters

* @config@ - The 'TestConfig' controlling test generation
* @openApi@ - The OpenAPI specification
* @manager@ - HTTP connection manager
* @baseUrl@ - Base URL of the running server (e.g., &quot;http://localhost:8080&quot;)

=== Example

@
import Network.HTTP.Client (newManager, defaultManagerSettings)

main :: IO ()
main = do
    manager &lt;- newManager defaultManagerSettings
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let tests = testTreeForUrl defaultTestConfig spec manager &quot;http://localhost:8080&quot;
    defaultMain tests
@
-}</span></span><span>
</span><span id="line-254"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrl"><span class="hs-identifier hs-type">testTreeForUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-260"></span><span id="testTreeForUrl"><span class="annot"><span class="annottext">testTreeForUrl :: TestConfig -&gt; OpenApi -&gt; Manager -&gt; Text -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrl"><span class="hs-identifier hs-var hs-var">testTreeForUrl</span></a></span></span><span> </span><span id="local-6989586621679203030"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203030"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679203031"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203031"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679203032"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679203032"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679203033"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679203033"><span class="hs-identifier hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679203034"><span class="annot"><span class="annottext">config' :: TestConfig
</span><a href="#local-6989586621679203034"><span class="hs-identifier hs-var hs-var">config'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203030"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679203033"><span class="hs-identifier hs-type">baseUrl</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-262"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-var">testTreeForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203031"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203034"><span class="hs-identifier hs-var">config'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; Text -&gt; ApiRequest -&gt; IO ApiResponse
</span><a href="Haskemathesis.Execute.Http.html#executeHttp"><span class="hs-identifier hs-var">executeHttp</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679203032"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679203033"><span class="hs-identifier hs-var">baseUrl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203031"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' for negative testing with a custom executor.

Negative testing generates invalid requests to verify that the API
properly rejects them with appropriate error responses.

=== Parameters

* @openApi@ - The OpenAPI specification
* @config@ - The 'TestConfig' (negative testing flag is ignored, always enabled)
* @execute@ - Function to execute requests
* @ops@ - List of operations to test

=== Example

@
-- Test that invalid requests are properly rejected
negTests = testTreeForExecutorNegative spec config executor ops
@
-}</span></span><span>
</span><span id="line-283"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier hs-type">testTreeForExecutorNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiRequest"><span class="hs-identifier hs-type">ApiRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#ApiResponse"><span class="hs-identifier hs-type">ApiResponse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-289"></span><span id="testTreeForExecutorNegative"><span class="annot"><span class="annottext">testTreeForExecutorNegative :: OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier hs-var hs-var">testTreeForExecutorNegative</span></a></span></span><span> </span><span id="local-6989586621679203036"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203036"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679203037"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203037"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679203038"><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679203038"><span class="hs-identifier hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679203039"><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679203039"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679203040"><span class="annot"><span class="annottext">config' :: TestConfig
</span><a href="#local-6989586621679203040"><span class="hs-identifier hs-var hs-var">config'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203037"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcNegativeTesting"><span class="hs-identifier hs-var">tcNegativeTesting</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">}</span><span>
</span><span id="line-291"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorWithConfig"><span class="hs-identifier hs-var">testTreeForExecutorWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203036"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203040"><span class="hs-identifier hs-var">config'</span></a></span><span> </span><span class="annot"><span class="annottext">ApiRequest -&gt; IO ApiResponse
</span><a href="#local-6989586621679203038"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedOperation]
</span><a href="#local-6989586621679203039"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' for negative testing with a WAI application.

Convenience function that combines 'testTreeForExecutorNegative' with
'executeWai' for testing WAI applications.

=== Parameters

* @config@ - The 'TestConfig'
* @openApi@ - The OpenAPI specification
* @app@ - Your WAI 'Application'

=== Example

@
negTests = testTreeForAppNegative defaultTestConfig spec myApp
@
-}</span></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppNegative"><span class="hs-identifier hs-type">testTreeForAppNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="file:///nix/store/lwc9snjq2izyxa0840h8rp6r9f5za4cc-wai-3.2.4-doc/share/doc/wai-3.2.4/html/src/Network.Wai.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-315"></span><span id="testTreeForAppNegative"><span class="annot"><span class="annottext">testTreeForAppNegative :: TestConfig -&gt; OpenApi -&gt; Application -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForAppNegative"><span class="hs-identifier hs-var hs-var">testTreeForAppNegative</span></a></span></span><span> </span><span id="local-6989586621679203042"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203042"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679203043"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203043"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679203044"><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679203044"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier hs-var">testTreeForExecutorNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203043"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203042"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Application -&gt; ApiRequest -&gt; IO ApiResponse
</span><a href="Haskemathesis.Execute.Wai.html#executeWai"><span class="hs-identifier hs-var">executeWai</span></a></span><span> </span><span class="annot"><span class="annottext">Application
</span><a href="#local-6989586621679203044"><span class="hs-identifier hs-var">app</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203043"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><span class="hs-comment">{- | Create a Tasty 'TestTree' for negative testing against a live server.

Convenience function for running negative tests against a running
HTTP server at the specified base URL.

=== Parameters

* @config@ - The 'TestConfig'
* @openApi@ - The OpenAPI specification
* @manager@ - HTTP connection manager
* @baseUrl@ - Base URL of the running server

=== Example

@
import Network.HTTP.Client (newManager, defaultManagerSettings)

main :: IO ()
main = do
    manager &lt;- newManager defaultManagerSettings
    spec &lt;- loadOpenApiFile &quot;api.yaml&quot;
    let negTests = testTreeForUrlNegative defaultTestConfig spec manager &quot;http://localhost:8080&quot;
    defaultMain negTests
@
-}</span></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrlNegative"><span class="hs-identifier hs-type">testTreeForUrlNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><a href="Haskemathesis.Config.html#TestConfig"><span class="hs-identifier hs-type">TestConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><a href="file:///nix/store/n9bq8nyqbcrs9rhllk8bh2xqlhba601s-openapi3-3.2.4-doc/share/doc/openapi3-3.2.4/html/src/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><a href="file:///nix/store/bnr86jl784iw2vjhcpn7dxsaycwawf4d-http-client-0.7.19-doc/share/doc/http-client-0.7.19/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="Haskemathesis.Execute.Types.html#BaseUrl"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="file:///nix/store/qahl5ay6qsq5m45cbaj95c5jx7861423-tasty-1.5.3-doc/share/doc/tasty-1.5.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-349"></span><span id="testTreeForUrlNegative"><span class="annot"><span class="annottext">testTreeForUrlNegative :: TestConfig -&gt; OpenApi -&gt; Manager -&gt; Text -&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForUrlNegative"><span class="hs-identifier hs-var hs-var">testTreeForUrlNegative</span></a></span></span><span> </span><span id="local-6989586621679203045"><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203045"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679203046"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203046"><span class="hs-identifier hs-var">openApi</span></a></span></span><span> </span><span id="local-6989586621679203047"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679203047"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679203048"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679203048"><span class="hs-identifier hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><span class="annottext">OpenApi
-&gt; TestConfig
-&gt; (ApiRequest -&gt; IO ApiResponse)
-&gt; [ResolvedOperation]
-&gt; TestTree
</span><a href="Haskemathesis.Integration.Tasty.html#testTreeForExecutorNegative"><span class="hs-identifier hs-var">testTreeForExecutorNegative</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203046"><span class="hs-identifier hs-var">openApi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestConfig
</span><a href="#local-6989586621679203045"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Haskemathesis.Config.html#tcBaseUrl"><span class="hs-identifier hs-var">tcBaseUrl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679203048"><span class="hs-identifier hs-type">baseUrl</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; Text -&gt; ApiRequest -&gt; IO ApiResponse
</span><a href="Haskemathesis.Execute.Http.html#executeHttp"><span class="hs-identifier hs-var">executeHttp</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679203047"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679203048"><span class="hs-identifier hs-var">baseUrl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi -&gt; [ResolvedOperation]
</span><a href="Haskemathesis.OpenApi.Resolve.html#resolveOperations"><span class="hs-identifier hs-var">resolveOperations</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679203046"><span class="hs-identifier hs-var">openApi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="annot"><span class="hs-comment">-- | Internal helper to create a human-readable label for an operation.</span></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Haskemathesis.Integration.Tasty.html#operationLabel"><span class="hs-identifier hs-type">operationLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Haskemathesis.OpenApi.Types.html#ResolvedOperation"><span class="hs-identifier hs-type">ResolvedOperation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-354"></span><span id="operationLabel"><span class="annot"><span class="annottext">operationLabel :: ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.Integration.Tasty.html#operationLabel"><span class="hs-identifier hs-var hs-var">operationLabel</span></a></span></span><span> </span><span id="local-6989586621679203049"><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203049"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Maybe Text
</span><a href="Haskemathesis.OpenApi.Types.html#roOperationId"><span class="hs-identifier hs-var">roOperationId</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203049"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679203051"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679203051"><span class="hs-identifier hs-var">opId</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679203051"><span class="hs-identifier hs-var">opId</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roMethod"><span class="hs-identifier hs-var">roMethod</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203049"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation -&gt; Text
</span><a href="Haskemathesis.OpenApi.Types.html#roPath"><span class="hs-identifier hs-var">roPath</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedOperation
</span><a href="#local-6989586621679203049"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-358"></span></pre></body></html>